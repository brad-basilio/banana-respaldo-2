import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as c}from"./index-BH53Isel.js";import{N as g}from"./Number2Currency-e57Tgsuk.js";import{B as ee,a as Re,D as ss,A as ts,O as as,C as rs}from"./OptionCard-B_4dOZ-t.js";import{P as $e}from"./package-BqGEawLR.js";import{T as Me}from"./trash-2-DK1wnsDn.js";import{M as qe}from"./CartItemRow-CLVGv7Ee.js";import{P as Fe}from"./plus-Bot15Khs.js";import{m as $}from"./main-6DCdASTx.js";import{t as Y}from"./index-BZYhE2TF.js";import{I as T}from"./InputForm-ZnsQvLid.js";import"./server.browser-Bf4gQIc7.js";import{l as ns}from"./ShippingStep-C2YEwCQ_.js";import{R as ce}from"./PaymentModal-BB1JXzaZ.js";import{G as z}from"./General-BmbBKdsB.js";import{U as os,a as ls}from"./ShippingStepSF-BB8aNaYX.js";import{i as Oe}from"./tippy-react.esm-BWiGTO87.js";import{H as Ie}from"./HtmlContent-FTivcJrM.js";import{C as J}from"./circle-x-p-TkKhsF.js";import{X as ze}from"./x-DBMwyD6F.js";import{G as ie}from"./Global-D6eBBAMK.js";import"./ProductNavigation-BvCahFZS.js";import"./ProductCard-CRhBSmWZ.js";/* empty css              */import"./BlogCarousel-BcMdR14t.js";/* empty css               */import"./BlogCarrusel-B3SD0Iql.js";import"./index-yBjzXJbu.js";import"./loader-circle-CrvBvIt1.js";import"./createLucideIcon-Cy5Ya80P.js";import"./useStateManager-7e1e8489.esm-CqlJ4XxI.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./floating-ui.dom-BPWAutIm.js";import"./proxy-F8AlgMSF.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-Chjiymov.js";import"./VoucherUpload-Rnyqcewr.js";import"./filepond-plugin-image-preview-B-c8xYdh.js";import"./SalesRest-BddGx03q.js";import"./BasicRest-C4m6wu80.js";import"./chevron-up-D78jyEhP.js";import"./chevron-down-DS-mdh9v.js";import"./ItemsRest-BSMuMwsF.js";import"./HeaderSearch-BZ6sxqwg.js";import"./index-CmxRu895.js";import"./eye-CKCH9ORv.js";const Le=({setCart:d,...o})=>{const y=()=>{d(N=>N.filter(m=>m.id!==o.id))},b=()=>{d(N=>N.map(m=>m.id===o.id?{...m,quantity:(m.quantity||1)+1}:m))},r=()=>{d(N=>N.map(m=>{if(m.id===o.id){const x=(m.quantity||1)-1;return x<=0?(y(o.id),null):{...m,quantity:x}}return m}).filter(Boolean))},h=o.price>o.final_price?Math.round((o.price-o.final_price)/o.price*100):0;return console.log(o),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"hidden md:table-row border-b hover:bg-gray-50 transition-colors duration-200 font-font-general",children:[e.jsx("td",{className:"px-6 py-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:`/storage/images/item/${o.image}`,alt:o.name,className:"w-20 h-20 object-cover rounded-xl shadow-md group-hover:shadow-lg transition-shadow duration-200"}),h>0&&e.jsxs("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow",children:["-",h,"%"]})]}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-sm 2xl:text-base font-bold customtext-neutral-dark leading-tight",children:o.name}),e.jsx("div",{className:"text-xs 2xl:text-sm customtext-neutral-dark mt-1 space-y-1",children:e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx($e,{size:12}),e.jsxs("span",{children:["SKU: ",o.sku||o.id]})]})}),e.jsxs("button",{onClick:y,className:"mt-2 inline-flex items-center gap-1 text-red-500 hover:text-red-700 transition-colors duration-200 text-xs font-medium","aria-label":"Remove item",children:[e.jsx(Me,{size:14}),"Eliminar"]})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex items-center bg-white border-2 border-gray-200 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-200",children:[e.jsx("button",{type:"button",onClick:r,className:"p-2 text-gray-600 hover:bg-gray-50 hover:text-gray-800 transition-colors duration-200","aria-label":"Decrease quantity",children:e.jsx(qe,{size:16})}),e.jsx("div",{className:"w-10 h-10 flex justify-center items-center bg-gray-50 border-x border-gray-200",children:e.jsx("span",{className:"font-bold text-base",children:o.quantity||1})}),e.jsx("button",{type:"button",onClick:b,className:"p-2 text-gray-600 hover:bg-gray-50 hover:text-gray-800 transition-colors duration-200","aria-label":"Increase quantity",children:e.jsx(Fe,{size:16})})]})})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("div",{className:"space-y-1",children:[h>0&&e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",g(o.price)]}),e.jsxs("div",{className:"font-bold text-base text-gray-900",children:["S/ ",g(o.final_price)]}),h>0&&e.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Ahorras S/ ",g(o.price-o.final_price)]})]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsxs("div",{className:"font-bold text-lg text-gray-900",children:["S/ ",g(o.final_price*o.quantity)]})})]},o.id),e.jsx("div",{className:"md:hidden bg-white border border-gray-200 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 p-4 mb-4 w-full font-font-general",children:e.jsxs("div",{className:"flex items-start gap-3 relative",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:`/storage/images/item/${o.image}`,alt:o.name,className:"w-20 h-20 object-cover rounded-xl shadow-md group-hover:shadow-lg transition-shadow duration-200"}),h>0&&e.jsxs("div",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow",children:["-",h,"%"]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-base mb-2 leading-tight customtext-neutral-dark",children:o.name}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-gray-300 bg-gray-100"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["Color: ",o.color||"Personalizado"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx($e,{size:12}),e.jsxs("span",{className:"text-xs",children:["SKU: ",o.sku||o.id]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center bg-white border-2 border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[e.jsx("button",{onClick:r,className:"p-2 text-gray-600 hover:bg-gray-50 hover:text-gray-800 transition-colors duration-200",children:e.jsx(qe,{size:14})}),e.jsx("div",{className:"w-8 h-8 flex justify-center items-center bg-gray-50 border-x border-gray-200",children:e.jsx("span",{className:"font-bold text-sm",children:o.quantity||1})}),e.jsx("button",{onClick:b,className:"p-2 text-gray-600 hover:bg-gray-50 hover:text-gray-800 transition-colors duration-200",children:e.jsx(Fe,{size:14})})]}),e.jsxs("div",{className:"text-right",children:[h>0&&e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",g(o.price)]}),e.jsxs("div",{className:"font-bold text-base text-gray-900",children:["S/ ",g(o.final_price)]}),h>0&&e.jsxs("div",{className:"text-xs text-green-600 font-medium",children:["Ahorras S/ ",g(o.price-o.final_price)]})]})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:["S/ ",g(o.final_price*o.quantity)]})]})})]}),e.jsx("button",{onClick:y,className:"absolute -top-2 -right-2 bg-red-500 text-white p-1.5 rounded-full shadow-lg hover:bg-red-600 transition-colors duration-200","aria-label":"Remove item",children:e.jsx(Me,{size:14})})]})})]})};function is({cart:d,setCart:o,onContinue:y,subTotal:b,envio:r,igv:h,totalFinal:N,openModal:m}){return!d||d.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:e.jsxs("div",{className:"max-w-md w-full text-center",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"mx-auto w-32 h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-16 h-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m0 0h7M17 13v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6"})})})}),e.jsx("h2",{className:"text-3xl font-bold customtext-neutral-dark mb-4",children:"Tu carrito está vacío"}),e.jsx("p",{className:"text-base text-gray-600 mb-8 leading-relaxed",children:"¡Descubre nuestros increíbles productos y comienza a llenar tu carrito con tus favoritos!"}),e.jsx("div",{className:"space-y-3",children:e.jsxs(ee,{className:"rounded-2xl xl:rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300 w-full",href:"/",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"Explorar productos"]})})]})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-y-8 md:gap-8",children:[e.jsxs("div",{className:"lg:col-span-3 flex flex-row w-full",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto rounded-2xl shadow-lg border border-gray-200 w-full",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 bg-white",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{className:"!font-font-general",children:[e.jsx("th",{scope:"col",className:"px-6 py-4 text-left text-sm 2xl:text-base font-bold customtext-neutral-dark",children:"Producto"}),e.jsx("th",{scope:"col",className:"px-6 py-4 text-center text-sm 2xl:text-base font-bold customtext-neutral-dark",children:"Cantidad"}),e.jsx("th",{scope:"col",className:"px-6 py-4 text-center text-sm 2xl:text-base font-bold customtext-neutral-dark",children:"Precio"}),e.jsx("th",{scope:"col",className:"px-6 py-4 text-center text-sm 2xl:text-base font-bold customtext-neutral-dark",children:"Subtotal"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:d.map((x,w)=>e.jsx(Le,{...x,setCart:o},w))})]})}),e.jsx("div",{className:"md:hidden space-y-4 w-full",children:d.map((x,w)=>e.jsx(Le,{...x,setCart:o},w))})]}),e.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-xl border border-gray-200 p-8 col-span-2 h-max font-font-general",children:[e.jsxs("h3",{className:"text-2xl 2xl:text-3xl font-bold pb-6 customtext-neutral-dark flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),"Resumen de compra"]}),e.jsxs("div",{className:"space-y-3 py-2",children:[e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsxs("span",{className:"customtext-neutral-dark text-base 2xl:text-base",children:["Subtotal (",d.length," ",d.length===1?"producto":"productos",")"]}),e.jsxs("span",{className:"font-bold text-base 2xl:text-xl",children:["S/ ",g(b)]})]}),e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsx("span",{className:"customtext-neutral-dark text-base 2xl:text-base",children:"IGV (18%)"}),e.jsxs("span",{className:"font-bold text-base 2xl:text-xl",children:["S/ ",g(h)]})]}),e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"customtext-neutral-dark text-base 2xl:text-base",children:"Envío"})}),e.jsxs("span",{className:"font-bold text-base 2xl:text-xl",children:["S/ ",g(r)]})]})]}),e.jsx("div",{className:"py-4 border-y-2 border-primary/20 bg-gradient-to-r from-primary/5 to-primary/10 rounded-lg ",children:e.jsxs("div",{className:"flex justify-between font-bold text-2xl 2xl:text-2xl items-center",children:[e.jsx("span",{className:"customtext-primary",children:"Total"}),e.jsxs("span",{className:"customtext-primary",children:["S/ ",g(N)]})]})}),e.jsxs("div",{className:"space-y-3 pt-6",children:[e.jsx(ee,{className:"rounded-2xl py-4 xl:rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300",onClick:y,children:"Continuar compra"}),e.jsx(Re,{className:"rounded-2xl py-4 xl:rounded-3xl",href:"/",children:"Seguir comprando"})]}),e.jsx("div",{className:"pt-4",children:e.jsx("div",{className:"  rounded-xl ",children:e.jsx("div",{className:"flex items-start gap-3",children:e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark leading-relaxed",children:["Al realizar tu pedido, aceptas los"," ",e.jsx("button",{onClick:()=>m&&m(1),className:"customtext-primary font-bold hover:underline cursor-pointer",children:"Términos y Condiciones"}),", y que nosotros usaremos tus datos personales de acuerdo con nuestra"," ",e.jsx("button",{onClick:()=>m&&m(0),className:"customtext-primary font-bold hover:underline cursor-pointer",children:"Política de Privacidad"}),"."]})})})})})]})]})}const cs=d=>new Promise(async(o,y)=>{try{console.log("Datos para MercadoPago:",d);const{status:b,result:r}=await $.Fetch("./api/mercadopago/preference",{method:"POST",body:JSON.stringify(d)});if(!b||!r.preference_id){$.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:(r==null?void 0:r.message)||"Error al crear la preferencia de pago",type:"danger"}),y((r==null?void 0:r.message)||"Error al crear la preferencia de pago");return}console.log("✅ Preferencia creada:",r);const h=new window.MercadoPago(r.public_key,{locale:"es-PE"});setTimeout(()=>{window.location.href=r.redirect_url},500),o(r)}catch(b){console.error("Error en processMercadoPagoPayment:",b),$.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:b.message||"Error en la integración con MercadoPago",type:"danger"}),y(b.message||"Error en la integración con MercadoPago")}});function ds({isOpen:d,onClose:o,onPaymentComplete:y,contacts:b}){const[r,h]=c.useState(null),[N,m]=c.useState(!1);c.useEffect(()=>{d||(m(!1),h(null))},[d]);const x=()=>{r&&(m(!0),y(r))},w=N||!r,a=b.find(S=>S.correlative==="checkout_mercadopago");return e.jsx(ce,{isOpen:d,onRequestClose:o,className:"absolute left-1/2 -translate-x-1/2 bg-white rounded-2xl shadow-lg w-[95%] max-w-4xl top-1/2 -translate-y-1/2 overflow-hidden",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",ariaHideApp:!1,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[e.jsx("div",{className:"hidden md:block bg-[#f8f5f2] h-full",children:e.jsx("img",{src:"/assets/bananalab_app/portadapagos.png",alt:"Métodos de pago",className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"p-6 max-h-[90vh] md:max-h-[100vh] flex flex-col justify-center ",children:[e.jsxs("div",{className:"mb-0 md:mb-4",children:[e.jsx("h2",{className:"text-xl md:text-2xl 2xl:text-3xl font-bold customtext-primary",children:"¿Cómo deseas pagar tu pedido?"}),e.jsx("p",{className:"mt-2 text-sm 2xl:text-base",children:"Elige una de las opciones disponibles para completar tu pago de forma segura."})]}),(a==null?void 0:a.description)!=="true"&&z.get("checkout_dwallet")!=="true"&&z.get("checkout_transfer")!=="true"?e.jsx("div",{className:"text-gray-500 text-center py-4",children:"Sin opciones de pago"}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-3 space-y-3",children:[(a==null?void 0:a.description)=="true"&&e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-colors ${r==="tarjeta"?"border-primary bg-[#f8f5f2]":"border-gray-200 hover:border-2 hover:border-primary"}`,onClick:()=>h("tarjeta"),children:e.jsxs("div",{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-start justify-center space-x-2",children:[e.jsx("input",{type:"radio",id:"tarjeta",name:"paymentMethod",checked:r==="tarjeta",onChange:()=>h("tarjeta"),className:"h-5 w-5 customtext-primary focus:ring-primary hidden"}),e.jsx("label",{htmlFor:"tarjeta",className:"font-medium text-base 2xl:text-lg",children:"Pago con Tarjeta"}),e.jsx("p",{className:"customtext-primary text-sm 2xl:text-base ml-7 mt-1",children:"Renueva tus espacios con estilo: Fundas exclusivas para cada temporada."})]}),e.jsx("div",{className:"min-w-5 flex items-center justify-center",children:e.jsx("div",{className:`h-5 w-5 rounded-full flex items-center justify-center ${r==="tarjeta"?"bg-primary":"border-2 border-[#d0ccca]"}`,children:e.jsx("div",{className:`h-2 w-2 rounded-full ${r==="tarjeta"?"bg-white":""}`})})})]})}),z.get("checkout_dwallet")=="true"&&e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-colors ${r==="yape"?"border-primary bg-[#f8f5f2]":"border-gray-200 hover:border-2 hover:border-primary"}`,onClick:()=>h("yape"),children:e.jsxs("div",{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-start justify-center space-x-2",children:[e.jsx("input",{type:"radio",id:"yape",name:"paymentMethod",checked:r==="yape",onChange:()=>h("yape"),className:"h-5 w-5 customtext-primary focus:ring-primary hidden"}),e.jsx("label",{htmlFor:"yape",className:"font-medium text-base 2xl:text-lg",children:"Yape / Plin"}),e.jsx("p",{className:"customtext-primary text-sm 2xl:text-base ml-7 mt-1",children:"Realiza el pago desde tu celular sin comisiones."})]}),e.jsx("div",{className:"min-w-5 flex items-center justify-center",children:e.jsx("div",{className:`h-5 w-5 rounded-full flex items-center justify-center ${r==="yape"?"bg-primary":"border-2 border-[#d0ccca]"}`,children:e.jsx("div",{className:`h-2 w-2 rounded-full ${r==="yape"?"bg-white":""}`})})})]})}),z.get("checkout_transfer")=="true"&&e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-colors ${r==="transferencia"?"border-primary bg-[#f8f5f2]":"border-gray-200 hover:border-2 hover:border-primary"}`,onClick:()=>h("transferencia"),children:e.jsxs("div",{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-start justify-center space-x-2",children:[e.jsx("input",{type:"radio",id:"transferencia",name:"paymentMethod",checked:r==="transferencia",onChange:()=>h("transferencia"),className:"h-5 w-5 customtext-primary focus:ring-primary hidden"}),e.jsx("label",{htmlFor:"transferencia",className:"font-medium text-base 2xl:text-lg",children:"Pago por Transferencia"}),e.jsx("p",{className:"customtext-primary text-sm 2xl:text-base ml-7 mt-1",children:"Haz una transferencia bancaria desde tu app o banca por internet."})]}),e.jsx("div",{className:"min-w-5 flex items-center justify-center",children:e.jsx("div",{className:`h-5 w-5 rounded-full flex items-center justify-center ${r==="transferencia"?"bg-primary":"border-2 border-[#d0ccca]"}`,children:e.jsx("div",{className:`h-2 w-2 rounded-full ${r==="transferencia"?"bg-white":""}`})})})]})})]})}),e.jsxs("div",{className:"mt-4 space-y-3",children:[((a==null?void 0:a.description)==="true"||z.get("checkout_dwallet")==="true"||z.get("checkout_transfer")==="true")&&e.jsx("button",{className:`w-full bg-primary hover:bg-primary hover:scale-105 transition-all duration-300 text-white py-3 rounded-3xl text-base 2xl:text-lg leading-normal font-medium 
                            ${w?"opacity-70 cursor-not-allowed":""}`,onClick:x,disabled:N,children:N?"Procesando...":"Confirmar pago"}),e.jsx("button",{className:"w-full border border-primary text-primary hover:bg-[#f8f5f2] py-3 text-base 2xl:text-lg leading-normal rounded-3xl font-medium transition-colors",onClick:o,disabled:N,children:"Volver"})]})]})]})})}const ms=new rs;function xs({cart:d,setSale:o,setCode:y,setDelivery:b,setCart:r,onContinue:h,noContinue:N,subTotal:m,igv:x,totalFinal:w,user:a,setEnvio:S,envio:k,prefixes:E,ubigeos:A=[],contacts:j,totalPrice:v,descuentofinal:C,setDescuentoFinal:q,openModal:de,generals:F}){var we,Ce,ke;const R=c.useRef(null),[u,B]=c.useState(null),[U,V]=c.useState(null),[Q,X]=c.useState(null),[s,M]=c.useState({name:(a==null?void 0:a.name)||"",lastname:(a==null?void 0:a.lastname)||"",email:(a==null?void 0:a.email)||"",phone_prefix:(a==null?void 0:a.phone_prefix)||"51",phone:(a==null?void 0:a.phone)||"",department:(a==null?void 0:a.department)||"",province:(a==null?void 0:a.province)||"",district:(a==null?void 0:a.district)||"",address:(a==null?void 0:a.address)||"",number:(a==null?void 0:a.number)||"",comment:(a==null?void 0:a.comment)||"",shippingOption:"delivery",ubigeo:(a==null?void 0:a.ubigeo)||null,invoiceType:(a==null?void 0:a.invoiceType)||"boleta",documentType:(a==null?void 0:a.documentType)||"dni",document:(a==null?void 0:a.dni)||"",businessName:(a==null?void 0:a.businessName)||""});c.useEffect(()=>{if(a!=null&&a.ubigeo&&(a!=null&&a.district)&&(a!=null&&a.province)&&(a!=null&&a.department)){const t={value:a.ubigeo,label:`${a.district}, ${a.province}, ${a.department}`,data:{reniec:a.ubigeo,departamento:a.department,provincia:a.province,distrito:a.district}};X(t),V(t),re(t)}},[a]);const P=t=>{var n;return((n=j.find(i=>i.correlative===t))==null?void 0:n.description)||""},f=t=>{const{name:n,value:i}=t.target;M(l=>({...l,[n]:i})),n==="invoiceType"&&M(l=>({...l,documentType:i==="factura"?"ruc":"dni",document:"",businessName:i==="factura"?l.businessName:""}))},[H,me]=c.useState(0),[I,Z]=c.useState(!1),[G,xe]=c.useState([]),[W,se]=c.useState(null),[hs,gs]=c.useState(null),[_,te]=c.useState({}),[D,ae]=c.useState(!1),Ae=typeof m=="number"?m:parseFloat(m)||0,Be=typeof x=="number"?x:parseFloat(x)||0,K=parseFloat(P("shipping_free")),pe=Ae+Be-C,re=async t=>{var i;if(!t)return;te(l=>({...l,ubigeo:""}));const{data:n}=t;console.log("data",n),M(l=>({...l,department:n.departamento,province:n.provincia,district:n.distrito,ubigeo:n.reniec||n.inei})),Z(!0);try{const l=await ss.getShippingCost({ubigeo:n.reniec||n.inei}),p=[],O=pe>=K;if(O?p.push({type:"free",price:0,description:`Compra mayor a S/ ${K}`,deliveryType:"Envío gratuito"}):l.data.is_free?p.push({type:"free",price:0,description:l.data.standard.description,deliveryType:l.data.standard.type,characteristics:l.data.standard.characteristics}):l.data.is_agency?p.push({type:"agency",price:0,description:l.data.agency.description,deliveryType:l.data.agency.type,characteristics:l.data.agency.characteristics}):p.push({type:"standard",price:l.data.standard.price,description:l.data.standard.description,deliveryType:l.data.standard.type,characteristics:l.data.standard.characteristics}),((i=l.data.express)==null?void 0:i.price)>0&&l.data.is_free&&!O&&p.push({type:"express",price:l.data.express.price,description:l.data.express.description,deliveryType:l.data.express.type,characteristics:l.data.express.characteristics}),p.length===0)throw new Error("No hay opciones de envío disponibles");xe(p),se(p[0].type),S(p[0].price)}catch(l){console.error("Error al obtener precios de envío:",l),Y.success("Sin cobertura",{description:"No realizamos envíos a esta ubicación",icon:e.jsx(J,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"}),xe([]),se(null),S(0)}Z(!1)};c.useEffect(()=>{U&&re(U)},[d,m,C]);const Ue=c.useCallback(ns.debounce((t,n)=>{if(t.length<3){n([]);return}fetch(`/api/ubigeo/search?q=${encodeURIComponent(t)}`).then(i=>{if(!i.ok)throw new Error("Error en la respuesta");return i.json()}).then(i=>{const l=i.map(p=>({value:p.reniec,label:`${p.distrito}, ${p.provincia}, ${p.departamento}`,data:{inei:p.inei,reniec:p.reniec,departamento:p.departamento,provincia:p.provincia,distrito:p.distrito}}));n(l)}).catch(i=>{console.error("Error:",i),n([])})},300),[]),[Ve,ne]=c.useState(!1),[He,ue]=c.useState(!1),[Ge,he]=c.useState(!1),[ge,We]=c.useState(null),[be,fe]=c.useState(null),[Ke,ye]=c.useState(null),je={privacy_policy:"Políticas de privacidad",terms_conditions:"Términos y condiciones",saleback_policy:"Políticas de devolución y cambio"},ve=t=>ye(t),oe=()=>ye(null),Ye=t=>{if(t.preventDefault(),t&&t.preventDefault&&t.preventDefault(),!!Je()){if(!W){Y.success("Seleccione envío",{description:"Debe elegir un método de envío",icon:e.jsx(J,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"});return}ne(!0)}},Je=()=>{const t={};s.name||(t.name="Nombre es requerido"),s.lastname||(t.lastname="Apellido es requerido"),s.email||(t.email="Email es requerido"),s.phone||(t.phone="Teléfono es requerido"),s.ubigeo||(t.ubigeo="Ubigeo es requerido"),s.address||(t.address="Dirección es requerida"),s.document||(t.document="Documento es requerido"),s.number||(t.number="Numero es requerido"),te(t);const n=(i,l=800)=>{const p=i.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/2+i.offsetHeight/2,O=window.pageYOffset;let le=null;const Se=Pe=>{le===null&&(le=Pe);const _e=Pe-le,De=((L,Ee,Te,es)=>(L/=es/2,L<1?Te/2*L*L+Ee:(L--,-Te/2*(L*(L-2)-1)+Ee)))(_e,O,p-O,l);window.scrollTo(0,De),_e<l?requestAnimationFrame(Se):["INPUT","SELECT","TEXTAREA"].includes(i.tagName)&&i.focus()};requestAnimationFrame(Se)};if(Object.keys(t).length>0){const i=Object.keys(t)[0];setTimeout(()=>{var p;let l=null;i==="ubigeo"?l=document.getElementById("ubigeo-select-container"):i==="phone_prefix"?l=(p=document.querySelector(".select2-prefix-selector"))==null?void 0:p.parentElement:l=document.querySelector(`[name="${i}"]`),l&&(l.classList.add("highlight-error"),setTimeout(()=>l.classList.remove("highlight-error"),2e3),n(l,600))},100)}return Object.keys(t).length===0},Qe=async t=>{try{if(ne(!1),We(t),t==="tarjeta"){if(!window.MercadoPago){console.error("❌ MercadoPago aún no se ha cargado.");return}const n={user_id:(a==null?void 0:a.id)||"",name:(s==null?void 0:s.name)||"",lastname:(s==null?void 0:s.lastname)||"",fullname:`${s==null?void 0:s.name} ${s==null?void 0:s.lastname}`,phone_prefix:(s==null?void 0:s.phone_prefix)||"51",email:(s==null?void 0:s.email)||"",phone:`${s.phone_prefix}${s.phone}`,country:"Perú",department:(s==null?void 0:s.department)||"",province:(s==null?void 0:s.province)||"",district:(s==null?void 0:s.district)||"",ubigeo:(s==null?void 0:s.ubigeo)||"",address:(s==null?void 0:s.address)||"",number:(s==null?void 0:s.number)||"",comment:(s==null?void 0:s.comment)||"",amount:v||0,delivery:k,cart:d,invoiceType:s.invoiceType||"",documentType:s.documentType||"",document:s.document||"",businessName:s.businessName||"",payment_method:t||null,coupon_id:u?u.id:null,coupon_discount:C||0,total_amount:w||0};console.log(n);try{const l=await cs(n);l.status?(o(l.sale),b(l.delivery),y(l.code)):Y.success("Error en el Pago",{description:"El pago ha sido rechazado",icon:e.jsx(J,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}catch(i){console.log(i),Y.success("Error en el Pago",{description:"No se llegó a procesar el pago",icon:e.jsx(J,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}}else if(t==="yape"){const n={user_id:(a==null?void 0:a.id)||"",name:(s==null?void 0:s.name)||"",lastname:(s==null?void 0:s.lastname)||"",fullname:`${s==null?void 0:s.name} ${s==null?void 0:s.lastname}`,phone_prefix:(s==null?void 0:s.phone_prefix)||"51",email:(s==null?void 0:s.email)||"",phone:`${s.phone_prefix}${s.phone}`,country:"Perú",department:(s==null?void 0:s.department)||"",province:(s==null?void 0:s.province)||"",district:(s==null?void 0:s.district)||"",ubigeo:(s==null?void 0:s.ubigeo)||"",address:(s==null?void 0:s.address)||"",number:(s==null?void 0:s.number)||"",comment:(s==null?void 0:s.comment)||"",amount:v||0,delivery:k,cart:d,invoiceType:s.invoiceType||"",documentType:s.documentType||"",document:s.document||"",businessName:s.businessName||"",payment_method:t||null,payment_proof:null,coupon_id:u?u.id:null,coupon_discount:C||0,total_amount:w||0};fe(n),ue(!0)}else if(t==="transferencia"){const n={user_id:(a==null?void 0:a.id)||"",name:(s==null?void 0:s.name)||"",lastname:(s==null?void 0:s.lastname)||"",fullname:`${s==null?void 0:s.name} ${s==null?void 0:s.lastname}`,phone_prefix:(s==null?void 0:s.phone_prefix)||"51",email:(s==null?void 0:s.email)||"",phone:`${s.phone_prefix}${s.phone}`,country:"Perú",department:(s==null?void 0:s.department)||"",province:(s==null?void 0:s.province)||"",district:(s==null?void 0:s.district)||"",ubigeo:(s==null?void 0:s.ubigeo)||"",address:(s==null?void 0:s.address)||"",number:(s==null?void 0:s.number)||"",comment:(s==null?void 0:s.comment)||"",amount:v||0,delivery:k,cart:d,invoiceType:s.invoiceType||"",documentType:s.documentType||"",document:s.document||"",businessName:s.businessName||"",payment_method:t||null,payment_proof:null,coupon_id:u?u.id:null,coupon_discount:C||0,total_amount:w||0};fe(n),he(!0)}}catch(n){console.error("Error en el pago:",n),Y.success("Error en el Pago",{description:"No se llegó a procesar el pago",icon:e.jsx(J,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}};c.useEffect(()=>{te(t=>{const n={...t};return Object.keys(s).forEach(i=>{s[i]&&delete n[i]}),n})},[s]),c.useEffect(()=>{const t=n=>{D&&!n.target.closest(".prefix-dropdown-container")&&ae(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[D]);const Xe=t=>({control:n=>({...n,border:`1px solid ${t?"#ef4444":"#e5e7eb"}`,boxShadow:"none",minHeight:"50px","&:hover":{borderColor:t?"#ef4444":"#6b7280"},borderRadius:"0.75rem",padding:"2px 8px"}),menu:n=>({...n,zIndex:9999,marginTop:"4px",borderRadius:"8px"}),option:n=>({...n,color:"#1f2937",backgroundColor:"white","&:hover":{backgroundColor:"#f3f4f6"},padding:"12px 16px"})});c.useEffect(()=>{if(u){let t=0;u.type==="percentage"?t=v*(u.amount/100):t=u.amount,q(t)}else q(0)},[v,u]);const Ne=t=>{t.preventDefault();const n=(R.current.value||"").trim().toUpperCase();n&&ms.save({coupon:n,amount:v,email:"basiliohinostroza2003bradneve@gmail.com"}).then(i=>{i&&i.id?B(i):(B(null),q(0))})},Ze=t=>{t.key=="Enter"&&Ne(t)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-y-8 lg:gap-8 ",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("form",{className:"space-y-6 bg-[#f9f9f9] py-6 px-4 sm:px-6 rounded-2xl font-font-general",onSubmit:t=>t.preventDefault(),children:[e.jsxs("div",{className:"sectionInformation space-y-3.5",children:[e.jsx("h3",{className:"block text-xl 2xl:text-2xl font-bold mb-4 customtext-neutral-dark ",children:"Información del contacto"}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsx(T,{type:"text",label:"Nombres",name:"name",value:s.name,error:_.name,onChange:f,placeholder:"Nombres",required:!0}),e.jsx(T,{label:"Apellidos",type:"text",name:"lastname",value:s.lastname,error:_.lastname,onChange:f,placeholder:"Apellidos",required:!0})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4 ",children:[e.jsx(T,{label:"Correo electrónico",type:"email",name:"email",value:s.email,error:_.email,onChange:f,placeholder:"Ej. hola@gmail.com",required:!0}),e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm 2xl:text-base mb-1 customtext-neutral-dark",children:["Celular ",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsxs("div",{className:"relative min-w-[130px] prefix-dropdown-container",children:[e.jsxs("button",{type:"button",className:"appearance-none bg-white border border-gray-300 rounded-xl px-4 py-3 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent w-full h-[50px] customtext-neutral-dark flex items-center justify-between",onClick:()=>ae(!D),children:[e.jsx("span",{className:"flex items-center gap-2",children:s.phone_prefix?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-base",children:((we=E.find(t=>t.realCode===s.phone_prefix))==null?void 0:we.flag)||"🌍"}),e.jsxs("span",{children:["+",s.phone_prefix]})]}):e.jsx("span",{className:"customtext-neutral-light",children:"País"})}),e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),D&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-xl shadow-lg z-50 max-h-60 overflow-y-auto",children:E.sort((t,n)=>t.country.localeCompare(n.country)).map((t,n)=>e.jsxs("button",{type:"button",className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center gap-3 text-sm customtext-neutral-dark transition-colors duration-150",onClick:()=>{M(i=>({...i,phone_prefix:t.realCode})),ae(!1)},children:[e.jsx("span",{className:"text-base flex-shrink-0",children:t.flag}),e.jsx("span",{className:"flex-1",children:t.country}),e.jsxs("span",{className:"text-gray-500",children:["+",t.realCode]})]},n))})]}),e.jsx("div",{className:"flex-1",children:e.jsx(T,{type:"tel",id:"phone",name:"phone",value:s.phone,error:_.phone,onChange:t=>{const n=t.target.value.replace(/\D/g,"");M(i=>({...i,phone:n}))},placeholder:"987 654 321",maxLength:"9",required:!0})})]}),_.phone&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:_.phone})]})]})]}),e.jsx("div",{className:"bg-[#66483966] py-[0.6px]"}),e.jsxs("div",{className:"sectionDelivery space-y-3.5",children:[e.jsx("h3",{className:"block text-xl 2xl:text-2xl font-bold mb-4 customtext-neutral-dark",children:"Dirección de envío"}),e.jsxs("div",{id:"ubigeo-select-container",className:"form-group",children:[e.jsx("label",{className:"block text-sm 2xl:text-base mb-1 customtext-neutral-dark ",children:"Ubicación de entrega (Distrito)"}),e.jsx(ts,{name:"ubigeo",cacheOptions:!0,value:U,loadOptions:Ue,onChange:t=>{V(t),re(t)},placeholder:"Buscar por distrito | provincia | departamento ...",loadingMessage:()=>"Buscando ubicaciones...",noOptionsMessage:({inputValue:t})=>t.length<3?"Ingrese al menos 3 caracteres...":"No se encontraron resultados",isLoading:I,styles:Xe(!!_.ubigeo),formatOptionLabel:({data:t})=>e.jsxs("div",{className:"text-sm py-1",children:[e.jsx("div",{className:"font-medium",children:t.distrito}),e.jsxs("div",{className:"text-gray-500",children:[t.provincia,", ",t.departamento]})]}),className:"w-full rounded-xl transition-all duration-300",menuPortalTarget:document.body,isClearable:!0,components:{ClearIndicator:t=>e.jsx("div",{...t.innerProps,className:"p-1 cursor-pointer",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-400 hover:text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}}),_.ubigeo&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:_.ubigeo})]}),e.jsx(T,{label:"Avenida / Calle / Jirón",type:"text",name:"address",value:s.address,error:_.address,onChange:f,placeholder:"Ingresa el nombre de la calle",required:!0}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsx(T,{label:"Número",type:"text",name:"number",value:s.number,error:_.number,onChange:f,placeholder:"Ingresa el número de la calle",required:!0}),e.jsx(T,{label:"Dpto./ Interior/ Piso/ Lote/ Bloque",type:"text",name:"comment",value:s.comment,onChange:f,placeholder:"Ej. Casa 3, Dpto 101"})]}),G.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"block text-xl 2xl:text-2xl font-bold mb-4 customtext-neutral-dark",children:"Método de envío"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:G.map(t=>e.jsx(as,{title:(t.type==="free"||t.type==="express"||t.type==="agency",t.deliveryType),price:t.price,description:t.description,selected:W===t.type,onSelect:()=>{se(t.type),S(t.price)}},t.type))}),console.log(G.find(t=>t.type===W)),W&&G.length>0&&e.jsx("div",{className:"space-y-4 mt-4",children:(ke=(Ce=G.find(t=>t.type===W))==null?void 0:Ce.characteristics)==null?void 0:ke.map((t,n)=>e.jsxs("div",{className:"flex items-start gap-4 bg-[#F7F9FB] p-4 rounded-xl",children:[e.jsx("div",{className:"w-5 flex-shrink-0",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-info customtext-primary",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4"}),e.jsx("path",{d:"M12 8h.01"})]})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium customtext-neutral-dark",children:t})})]},`char-${n}`))})]})]}),e.jsx("div",{className:"bg-[#66483966] py-[0.6px]"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"block text-sm 2xl:text-base font-medium customtext-neutral-dark",children:["Tipo de comprobante ",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",className:"sr-only",name:"invoiceType",value:"boleta",checked:s.invoiceType==="boleta",onChange:f}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 transition-all duration-200 ${s.invoiceType==="boleta"?"border-primary bg-primary":"border-gray-300 bg-white group-hover:border-primary"}`,children:s.invoiceType==="boleta"&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})})]}),e.jsx("span",{className:`ml-3 text-sm 2xl:text-base transition-colors duration-200 ${s.invoiceType==="boleta"?"customtext-primary font-medium":"customtext-neutral-dark group-hover:customtext-primary"}`,children:"Boleta"})]}),e.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"radio",className:"sr-only",name:"invoiceType",value:"factura",checked:s.invoiceType==="factura",onChange:f}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 transition-all duration-200 ${s.invoiceType==="factura"?"border-primary bg-primary":"border-gray-300 bg-white group-hover:border-primary"}`,children:s.invoiceType==="factura"&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})})]}),e.jsx("span",{className:`ml-3 text-sm 2xl:text-base transition-colors duration-200 ${s.invoiceType==="factura"?"customtext-primary font-medium":"customtext-neutral-dark group-hover:customtext-primary"}`,children:"Factura"})]})]})]}),e.jsx(T,{label:s.documentType==="dni"?"DNI":"RUC",type:"text",name:"document",value:s.document,error:_.document,onChange:f,placeholder:`Ingrese su ${s.documentType==="dni"?"DNI":"RUC"}`,maxLength:s.documentType==="dni"?"8":"11",required:!0}),s.invoiceType==="factura"&&e.jsx(T,{label:"Razón Social",type:"text",name:"businessName",value:s.businessName,onChange:f,placeholder:"Ingrese la razón social"})]})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max font-font-general",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6 customtext-neutral-dark",children:"Resumen de compra"}),e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:d.map((t,n)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white p-0 rounded-xl",children:e.jsx("img",{src:`/storage/images/item/${t.image}`,alt:t.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold customtext-neutral-dark text-base 2xl:text-lg mb-2",children:t.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Color:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:t.color})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad:"," ",e.jsxs("span",{className:"customtext-neutral-dark",children:[t.quantity," "]})]})]})]})},t.id))}),!u&&e.jsxs("div",{className:"mt-6 flex",children:[e.jsx("input",{ref:R,type:"text",placeholder:"Código de cupón",className:"w-full rounded-l-md border border-gray-300 p-2 px-4 text-sm outline-none uppercase focus:border-[#C5B8D4]",value:u==null?void 0:u.name,onKeyDown:Ze,disabled:I}),e.jsx("button",{className:"rounded-r-md bg-primary px-4 py-3 text-sm text-white",type:"button",onClick:Ne,disabled:I,children:"Aplicar"})]}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(m)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(x)]})]}),u&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado"," ",e.jsx(Oe,{content:"Eliminar",children:e.jsx("i",{className:"mdi mdi-close text-red-500 cursor-pointer",onClick:()=>{B(null),R.current.value=""}})}),e.jsxs("small",{className:"block text-xs font-light",children:[u.name," ",e.jsx(Oe,{content:u.description,children:e.jsx("i",{className:"mdi mdi-information-outline ms-1"})})," ","(",u.type==="percentage"?`-${Math.round(u.amount*100)/100}%`:`S/ -${g(u.amount)}`,")"]})]}),e.jsxs("span",{children:["S/ -",g(C)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsx("span",{className:"font-semibold",children:K!=null&&pe>=K?e.jsxs("span",{className:"customtext-neutral-dark",children:["Gratis (Compra mayor a S/",K,")"]}):`S/ ${g(k)}`})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(w)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsxs(ee,{className:"payment-button py-4 rounded-2xl xl:rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300",onClick:Ye,children:[" ","Continuar"]}),e.jsx("div",{id:"mercadopago-button-container"}),e.jsxs(Re,{onClick:N,className:"py-4 rounded-2xl xl:rounded-3xl shadow-lg hover:shadow-xl transition-all duration-300  ",children:[" ","Cancelar"]})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los"," ",e.jsx("button",{type:"button",onClick:()=>ve(1),className:"customtext-primary font-bold hover:underline focus:outline-none",children:"Términos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra"," ",e.jsx("button",{type:"button",onClick:()=>ve(0),className:"customtext-primary font-bold hover:underline focus:outline-none",children:"Política de Privacidad"}),"."]})})]})]})]}),e.jsx(ds,{isOpen:Ve,contacts:j,onClose:()=>ne(!1),onPaymentComplete:Qe}),e.jsx(os,{isOpen:He,cart:d,subTotal:m,igv:x,totalFinal:w,envio:k,request:be,onClose:()=>ue(!1),paymentMethod:ge,coupon:u,descuentofinal:C}),e.jsx(ls,{isOpen:Ge,cart:d,subTotal:m,igv:x,totalFinal:w,envio:k,contacts:j,request:be,onClose:()=>he(!1),paymentMethod:ge,coupon:u,descuentofinal:C}),Object.keys(je).map((t,n)=>{var p;const i=je[t],l=((p=F==null?void 0:F.find(O=>O.correlative==t))==null?void 0:p.description)??"";return e.jsx(ce,{isOpen:Ke===n,onRequestClose:oe,contentLabel:i,className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[999]",ariaHideApp:!1,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 pr-4",children:i}),e.jsx("button",{onClick:oe,className:"flex-shrink-0 text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 hover:bg-gray-100 rounded-full","aria-label":"Cerrar modal",children:e.jsx(ze,{size:24,strokeWidth:2})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"prose prose-gray max-w-none",children:e.jsx(Ie,{html:l})})}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:e.jsx("button",{onClick:oe,className:"px-6 py-2 bg-primary text-white rounded-lg transition-colors duration-200 font-medium",children:"Cerrar"})})]})},n)})]})}const ps=({code:d})=>new Promise(async(o,y)=>{try{console.log("Codigo de venta:",d);const{status:b,result:r}=await $.Fetch("./api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:d})});if(!b||!r.order){$.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:(r==null?void 0:r.message)||"Error no se pudo cargar la orden",type:"danger"}),y((r==null?void 0:r.message)||"Error no se pudo cargar la orde");return}o(r)}catch(b){console.error("Error en processMercadoPagoPayment:",b),$.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:b.message||"Error en la integración con MercadoPago",type:"danger"}),y(b.message||"Error en la integración con MercadoPago")}});function us({setCart:d,cart:o,code:y,delivery:b}){var A;const[r,h]=c.useState(null),[N,m]=c.useState(!0),[x,w]=c.useState(null);if(c.useEffect(()=>{y&&((async()=>{try{const v=await ps({code:y});h(v.order)}catch(v){w(v.message)}finally{m(!1)}})(),$.Local.delete(`${ie.APP_CORRELATIVE}_cart`),$.Local.set(`${ie.APP_CORRELATIVE}_cart`,[]))},[y]),N)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center",children:e.jsx("p",{children:"Cargando detalles de la orden..."})})});if(x)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center text-red-500",children:e.jsxs("p",{children:["Error al cargar la orden: ",x]})})});if(!r)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center",children:e.jsx("p",{children:"No se encontraron datos de la orden"})})});const S=((((A=r==null?void 0:r.items)==null?void 0:A.reduce((j,v)=>{const C=v.price||0,q=v.quantity||0;return j+C*q},0))||0)/1.18).toFixed(2),k=(S*.18).toFixed(2),E=parseFloat(S)+parseFloat(k)+parseFloat(r.delivery)-parseFloat(r.coupon_discount||0);return console.log(r.delivery,"order.coupon_discount"),e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-base xl:text-xl customtext-neutral-light",children:"Gracias por tu compra 🎉"}),e.jsx("p",{className:"customtext-neutral-dark text-2xl xl:text-5xl font-semibold",children:"Tu orden ha sido recibida"}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:" customtext-neutral-light",children:"Código de pedido"}),e.jsxs("div",{className:"customtext-neutral-dark text-lg font-semibold",children:["#",r.code]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg bg-[#F7F9FB] mx-auto p-8 rounded-xl",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:r.items.map((j,v)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl w-max",children:e.jsx("img",{src:j.image?`/storage/images/item/${j.image}`:"/assets/img/noimage/no_img.jpg",alt:j.name,className:"w-20 h-20 object-cover rounded",onError:C=>C.target.src="/assets/img/noimage/no_img.jpg"})}),e.jsxs("div",{className:"text-start",children:[e.jsx("h3",{className:"font-medium text-lg",children:j.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Color: ",e.jsx("span",{className:"customtext-neutral-dark",children:j.color})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsx("span",{className:"customtext-neutral-dark",children:parseInt(j.quantity)})," - Precio: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[" S/ ",g(j.price)]})]})]})]})},v))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(S)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(k)]})]}),r.coupon_id&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado"," "]}),e.jsxs("span",{children:["S/ -",g(r.coupon_discount)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(r.delivery)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(E)]})]})})]}),e.jsx("div",{className:"pt-3",children:e.jsx(ee,{href:"/catalogo",children:"  Seguir Comprando"})})]})]})})})}function ut({cart:d,setCart:o,user:y,prefixes:b,ubigeos:r,items:h,contacts:N,generals:m=[]}){const[x,w]=c.useState(1),[a,S]=c.useState(null),k=d.reduce((P,f)=>{const H=f.final_price;return P+H*f.quantity},0),[E,A]=c.useState(0),j=k/1.18,v=(j*.18).toFixed(2),C=(parseFloat(j)+parseFloat(v)+parseFloat(E)-a).toFixed(2),[q,de]=c.useState([]),[F,R]=c.useState([]),[u,B]=c.useState([]),[U,V]=c.useState(null),Q=P=>{w(P),window.scrollTo({top:0,behavior:"smooth"})},X=P=>V(P),s=()=>V(null),M={privacy_policy:"Políticas de privacidad",terms_conditions:"Términos y condiciones",saleback_policy:"Políticas de devolución y cambio"};return c.useEffect(()=>{const f=new URLSearchParams(window.location.search).get("code");f&&(R(f),w(3))},[window.location.search]),c.useEffect(()=>{F&&$.Local.delete(`${ie.APP_CORRELATIVE}_cart`)},[F]),c.useEffect(()=>{(()=>{const f=document.createElement("script");f.src="https://sdk.mercadopago.com/js/v2",f.async=!0,document.body.appendChild(f)})()},[]),e.jsxs("div",{className:"min-h-screen bg-[#F7F9FB] py-4 md:py-12 px-2 sm:px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-white p-3 md:p-8 rounded-lg md:rounded-xl shadow-sm",children:[e.jsx("div",{className:"mb-4 md:mb-8",children:e.jsxs("div",{className:"flex items-center justify-between gap-1 md:gap-4 max-w-3xl mx-auto",children:[e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 ${x===1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:[e.jsx("span",{className:"bg-primary text-white w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm",children:"1"}),e.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"Carrito"})]}),e.jsx("div",{className:"mb-4 lg:mb-0 flex-1 h-[2px] bg-gray-200 relative",children:e.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:x>1?"100%":"0%"}})}),e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 ${x>1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:[e.jsx("span",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm ${x>1?"bg-primary text-white":"bg-white customtext-primary"}`,children:"2"}),e.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"Envío"})]}),e.jsx("div",{className:"mb-4 lg:mb-0 flex-1 h-[2px] bg-gray-200 relative",children:e.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:x>2?"100%":"0%"}})}),e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 ${x===3?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:[e.jsx("span",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm ${x===3?"bg-primary text-white":"bg-white customtext-primary"}`,children:"3"}),e.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"Confirmación"})]})]})}),x===1&&e.jsx(is,{cart:d,setCart:o,onContinue:()=>Q(2),subTotal:j,totalPrice:k,envio:E,igv:v,totalFinal:C,openModal:X}),x===2&&e.jsx(xs,{setCode:R,setDelivery:B,cart:d,setSale:de,setCart:o,onContinue:()=>Q(3),noContinue:()=>Q(1),subTotal:j,totalPrice:k,envio:E,setEnvio:A,igv:v,totalFinal:C,user:y,prefixes:b,contacts:N,ubigeos:r,items:h,descuentofinal:a,setDescuentoFinal:S,openModal:X,generals:m}),x===3&&e.jsx(us,{code:F,setCart:o,delivery:u,cart:q,subTotal:j,totalPrice:k,envio:E,igv:v,totalFinal:C,descuentofinal:a,setDescuentoFinal:S})]}),Object.keys(M).map((P,f)=>{var I;const H=M[P],me=((I=m.find(Z=>Z.correlative==P))==null?void 0:I.description)??"";return e.jsx(ce,{isOpen:U===f,onRequestClose:s,contentLabel:H,className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[999]",ariaHideApp:!1,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 pr-4",children:H}),e.jsx("button",{onClick:s,className:"flex-shrink-0 text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 hover:bg-gray-100 rounded-full","aria-label":"Cerrar modal",children:e.jsx(ze,{size:24,strokeWidth:2})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"prose prose-gray max-w-none",children:e.jsx(Ie,{html:me})})}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:e.jsx("button",{onClick:s,className:"px-6 py-2 bg-primary text-white rounded-lg transition-colors duration-200 font-medium",children:"Cerrar"})})]})},f)})]})}export{ut as default};

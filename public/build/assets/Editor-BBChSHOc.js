import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{R as p,r as l}from"./index-BH53Isel.js";import"./thumbnailGenerator-B4goYG9Y.js";import"./EditorLayout-CkCvwqGw.js";import"./jspdf.es.min-D3plwuQr.js";import"./index-BZYhE2TF.js";import"./main-6DCdASTx.js";import"./TextElement-_pvTHO57.js";import"./V1Edit-D1jA5H9V.js";import{B as v}from"./dom-to-image-more.min-Cey65QPP.js";import{I as h}from"./image-BEA0kkBS.js";import{P as w}from"./plus-Bot15Khs.js";import{u as I}from"./useDrag-BaORhKlM.js";import"./index-yBjzXJbu.js";import"./preload-helper-BfFHrpNk.js";import"./typeof-QjJsDpFa.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./PaymentModal-BB1JXzaZ.js";import"./index-Chjiymov.js";import"./Global-ErywZRdd.js";import"./x-DBMwyD6F.js";import"./createLucideIcon-Cy5Ya80P.js";import"./chevron-left-B2s3ZsB7.js";import"./chevron-right-Ckt5D2ka.js";import"./download-Dh5rRDOT.js";import"./index-BSWw-p5k.js";p.memo(({pageId:t,thumbnail:r,altText:m,type:n})=>{const[a,s]=l.useState(!1),[d,c]=l.useState(!1);if(r&&!d)return e.jsxs("div",{className:"relative w-full h-full",children:[!a&&e.jsx("div",{className:"absolute inset-0 bg-gray-100 animate-pulse flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded"})}),e.jsx("img",{src:r,alt:m,className:`w-full h-full object-contain transition-opacity duration-200 ${a?"opacity-100":"opacity-0"}`,onLoad:()=>s(!0),onError:()=>c(!0),loading:"lazy",decoding:"async",style:{imageRendering:"optimizeQuality"}})]});const u=n==="cover"||n==="final"?v:()=>e.jsx("div",{className:"grid grid-cols-2 gap-0.5 w-8 h-8",children:Array.from({length:4}).map((g,i)=>e.jsx("div",{className:"bg-gray-300 rounded-sm"},i))});return e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx(u,{className:"w-8 h-8 mx-auto mb-1"}),e.jsx("span",{className:"text-xs",children:"Generando..."})]})})},(t,r)=>t.pageId===r.pageId&&t.thumbnail===r.thumbnail&&t.altText===r.altText&&t.type===r.type);p.memo(({images:t,onImageSelect:r,isLoading:m})=>{const n=p.memo(({image:a})=>{const[s,d]=l.useState(!1),[c,u]=l.useState(!1),[g,i]=l.useState(!1),[{isDragging:x},f]=I(()=>({type:"PROJECT_IMAGE",item:{type:"PROJECT_IMAGE",imageUrl:a.url},collect:o=>({isDragging:!!o.isDragging()}),end:()=>{setTimeout(()=>i(!1),100)}})),y=a.thumbnail_url||a.url,j=a.url,b=o=>{i(!0),setTimeout(()=>i(!1),500)},N=o=>{if(g||x)return o.preventDefault(),o.stopPropagation(),!1;r(j)};return e.jsxs("div",{ref:f,className:`relative group cursor-pointer bg-gray-50 rounded-lg overflow-hidden border-2 border-transparent hover:border-[#af5cb8] transition-all duration-200 ${x?"opacity-50 scale-95":""}`,onMouseDown:b,onClick:N,children:[e.jsxs("div",{className:"aspect-square relative",children:[!s&&!c&&e.jsx("div",{className:"absolute inset-0 bg-gray-100 animate-pulse flex items-center justify-center",children:e.jsx("div",{className:"w-6 h-6 border-2 border-[#af5cb8] border-t-transparent rounded-full animate-spin"})}),c?e.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(h,{className:"h-6 w-6 mx-auto mb-1"}),e.jsx("p",{className:"text-xs",children:"Error al cargar"})]})}):e.jsx("img",{src:y,alt:a.filename||"Project image",className:`w-full h-full object-cover transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,loading:"lazy",onLoad:()=>d(!0),onError:()=>u(!0)})]}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-200 flex items-center justify-center",children:e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:e.jsx("div",{className:"bg-white rounded-full p-2 shadow-md",children:e.jsx(w,{className:"h-4 w-4 text-[#af5cb8]"})})})}),e.jsx("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:a.has_thumbnail?"Optimizada":"Arrastra o haz clic"}),a.has_thumbnail&&e.jsx("div",{className:"absolute top-2 left-2 bg-green-500 rounded-full w-2 h-2"})]})});return m?e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:6}).map((a,s)=>e.jsx("div",{className:"aspect-square bg-gray-100 rounded-lg animate-pulse"},s))}):t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(h,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"No hay imágenes en este proyecto"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Sube una imagen para empezar"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map((a,s)=>e.jsx(n,{image:a},`${a.id||a.url}-${s}`))}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-xs text-gray-500",children:[t.filter(a=>a.has_thumbnail).length," de ",t.length," imágenes optimizadas"]})})]})});

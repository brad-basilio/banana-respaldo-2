import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as m}from"./index-BH53Isel.js";import{c as K}from"./createLucideIcon-Cy5Ya80P.js";import{S as L}from"./settings-BSPs3Zt8.js";import{I as M,C as W}from"./image-cwhXnF8c.js";import{P as Q}from"./plus-Bot15Khs.js";import{m as N}from"./proxy-BTYtmp9V.js";import{E}from"./eye-CKCH9ORv.js";import{T as B}from"./trash-2-DK1wnsDn.js";import{A as ee}from"./arrow-left-DT1uGo8v.js";import{D as te}from"./download-Dh5rRDOT.js";import{S as se,F as ae}from"./save-BfW-kI1U.js";import{B as re}from"./brush-CV0tCVRD.js";import{A as le}from"./index-CFtDjG4d.js";import"./index-yBjzXJbu.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=K("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);function oe({activePanel:t,setActivePanel:r,elementTypes:f,onAddElement:b,onImageUpload:h,fileInputRef:x}){const a=[{id:"elements",icon:ie,label:"Elementos",description:"Agregar textos, formas e imágenes"},{id:"properties",icon:L,label:"Propiedades",description:"Configurar elemento seleccionado"}];return e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Herramientas"}),e.jsx("div",{className:"space-y-2",children:a.map(c=>e.jsxs("button",{onClick:()=>r(c.id),className:`w-full flex items-center space-x-3 p-3 rounded-lg transition-all duration-200 ${t===c.id?"bg-blue-100 text-blue-700 border border-blue-200":"hover:bg-gray-50 text-gray-600"}`,children:[e.jsx(c.icon,{className:"w-5 h-5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium",children:c.label}),e.jsx("div",{className:"text-xs text-gray-500",children:c.description})]})]},c.id))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Acciones Rápidas"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>{var c;return(c=x.current)==null?void 0:c.click()},className:"flex flex-col items-center p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx(M,{className:"w-6 h-6 text-gray-600 mb-1"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Subir Imagen"})]}),e.jsxs("button",{onClick:()=>b("text"),className:"flex flex-col items-center p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx("span",{className:"text-lg font-bold text-gray-600 mb-1",children:"T"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Texto"})]})]})]})]})}function ne({pages:t,currentPage:r,onPageSelect:f,onAddPage:b,onDeletePage:h,onDuplicatePage:x,canvasSettings:a}){const c=i=>`data:image/svg+xml,${encodeURIComponent(`
            <svg width="120" height="80" xmlns="http://www.w3.org/2000/svg">
                <rect width="120" height="80" fill="${i.background||"#ffffff"}" stroke="#e5e7eb" stroke-width="1"/>
                <text x="60" y="40" text-anchor="middle" font-family="Arial" font-size="10" fill="#6b7280">
                    Página ${t.indexOf(i)+1}
                </text>
                <text x="60" y="55" text-anchor="middle" font-family="Arial" font-size="8" fill="#9ca3af">
                    ${i.elements.length} elementos
                </text>
            </svg>
        `)}`;return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Páginas"}),e.jsxs("button",{onClick:b,className:"flex items-center space-x-1 px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Nueva"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.length," página",t.length!==1?"s":"",a.width&&a.height&&e.jsxs("span",{children:[" • ",a.width,"×",a.height,"px"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-3",children:t.map((i,n)=>e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.1},className:`relative group cursor-pointer rounded-lg border-2 transition-all duration-200 ${r===n?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 bg-white"}`,onClick:()=>f(n),children:[e.jsxs("div",{className:"aspect-[3/2] rounded-t-lg overflow-hidden bg-gray-50",children:[e.jsx("img",{src:i.thumbnail||c(i),alt:`Página ${n+1}`,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black bg-opacity-20",children:e.jsx(E,{className:"w-6 h-6 text-white"})})]}),e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:["Página ",n+1]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[i.elements.length," elemento",i.elements.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:u=>{u.stopPropagation(),x(n)},className:"p-1 rounded hover:bg-gray-100 transition-colors",title:"Duplicar página",children:e.jsx(W,{className:"w-4 h-4 text-gray-600"})}),t.length>1&&e.jsx("button",{onClick:u=>{u.stopPropagation(),h(n)},className:"p-1 rounded hover:bg-red-100 transition-colors",title:"Eliminar página",children:e.jsx(B,{className:"w-4 h-4 text-red-600"})})]})]})}),r===n&&e.jsx("div",{className:"absolute -left-1 top-1/2 transform -translate-y-1/2 w-1 h-8 bg-blue-500 rounded-r"})]},i.id))})}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tamaño:"}),e.jsxs("span",{children:[a.width," × ",a.height,"px"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"DPI:"}),e.jsx("span",{children:a.dpi})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Zoom:"}),e.jsx("span",{children:"Ajustar al canvas"})]})]})})]})}function de({elementTypes:t,onAddElement:r,onImageUpload:f,fileInputRef:b}){const h={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},x={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0}};return e.jsxs(N.div,{className:"p-4",variants:h,initial:"hidden",animate:"visible",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Agregar Elementos"}),e.jsxs(N.div,{variants:x,className:"mb-6",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Texto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>r("text"),className:"w-full flex items-center space-x-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 hover:border-blue-300 transition-all duration-200 group",children:[e.jsx(t.text.icon,{className:"w-5 h-5 text-gray-600 group-hover:text-blue-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Texto"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Agregar texto personalizable"})]})]}),e.jsxs("div",{className:"ml-8 space-y-1",children:[e.jsx("button",{onClick:()=>{({...t.text.default},r("text"))},className:"w-full text-left px-3 py-2 text-xs text-gray-600 hover:bg-gray-50 rounded",children:"Título Principal"}),e.jsx("button",{onClick:()=>{({...t.text.default},r("text"))},className:"w-full text-left px-3 py-2 text-xs text-gray-600 hover:bg-gray-50 rounded",children:"Subtítulo"}),e.jsx("button",{onClick:()=>{({...t.text.default},r("text"))},className:"w-full text-left px-3 py-2 text-xs text-gray-600 hover:bg-gray-50 rounded",children:"Texto del cuerpo"})]})]})]}),e.jsxs(N.div,{variants:x,className:"mb-6",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Imágenes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>{var a;return(a=b.current)==null?void 0:a.click()},className:"w-full flex items-center space-x-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 hover:border-blue-300 transition-all duration-200 group",children:[e.jsx(t.image.icon,{className:"w-5 h-5 text-gray-600 group-hover:text-blue-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Subir Imagen"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Desde tu dispositivo"})]})]}),e.jsxs("button",{onClick:()=>r("image"),className:"w-full flex items-center space-x-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 hover:border-blue-300 transition-all duration-200 group",children:[e.jsx(t.image.icon,{className:"w-5 h-5 text-gray-600 group-hover:text-blue-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Placeholder"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Imagen de marcador"})]})]})]})]}),e.jsxs(N.div,{variants:x,className:"mb-6",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Formas"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>r("shape"),className:"w-full flex items-center space-x-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 hover:border-blue-300 transition-all duration-200 group",children:[e.jsx(t.shape.icon,{className:"w-5 h-5 text-gray-600 group-hover:text-blue-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Rectángulo"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Forma rectangular"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 ml-8",children:[e.jsx("button",{onClick:()=>{({...t.shape.default},r("shape"))},className:"aspect-square bg-gray-100 rounded-full hover:bg-blue-100 transition-colors flex items-center justify-center",title:"Círculo",children:e.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full"})}),e.jsx("button",{onClick:()=>{({...t.shape.default},r("shape"))},className:"aspect-square bg-gray-100 rounded hover:bg-blue-100 transition-colors flex items-center justify-center",title:"Rectángulo",children:e.jsx("div",{className:"w-8 h-6 bg-blue-500 rounded"})}),e.jsx("button",{onClick:()=>{({...t.shape.default},r("shape"))},className:"aspect-square bg-gray-100 rounded hover:bg-blue-100 transition-colors flex items-center justify-center",title:"Cuadrado",children:e.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded"})})]})]})]}),e.jsxs(N.div,{variants:x,className:"mb-6",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Plantillas"}),e.jsx("div",{className:"text-xs text-gray-400 text-center py-4 border border-dashed border-gray-200 rounded-lg",children:"Próximamente: Plantillas prediseñadas"})]})]})}function ce({selectedElement:t,onUpdateElement:r,onDeleteElement:f,onDuplicateElement:b}){const[h,x]=m.useState(!1);if(!t)return e.jsx(N.div,{className:"p-4 text-center",initial:{opacity:0},animate:{opacity:1},children:e.jsxs("div",{className:"text-gray-400 mb-4",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.122 2.122"})}),e.jsx("p",{className:"text-sm",children:"Selecciona un elemento para editarlo"})]})});const a=(s,g)=>{r(t.id,{[s]:g})},c=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contenido"}),e.jsx("textarea",{value:t.content||"",onChange:s=>a("content",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm resize-none",rows:"3",placeholder:"Ingresa tu texto..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tamaño de fuente"}),e.jsx("input",{type:"range",min:"8",max:"72",value:t.fontSize||16,onChange:s=>a("fontSize",parseInt(s.target.value)),className:"w-full"}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[t.fontSize||16,"px"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Fuente"}),e.jsxs("select",{value:t.fontFamily||"Arial",onChange:s=>a("fontFamily",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Georgia",children:"Georgia"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Courier New",children:"Courier New"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Peso de fuente"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["normal","500","bold"].map(s=>e.jsx("button",{onClick:()=>a("fontWeight",s),className:`px-3 py-2 text-xs rounded border transition-colors ${t.fontWeight===s?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-300 hover:bg-gray-50"}`,children:s==="normal"?"Normal":s==="500"?"Medio":"Negrita"},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Alineación"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["left","center","right"].map(s=>e.jsx("button",{onClick:()=>a("textAlign",s),className:`px-3 py-2 text-xs rounded border transition-colors ${t.textAlign===s?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-300 hover:bg-gray-50"}`,children:s==="left"?"Izq":s==="center"?"Centro":"Der"},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Color"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",value:t.color||"#000000",onChange:s=>a("color",s.target.value),className:"w-8 h-8 rounded border border-gray-300"}),e.jsx("input",{type:"text",value:t.color||"#000000",onChange:s=>a("color",s.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm",placeholder:"#000000"})]})]})]}),i=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Opacidad"}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:t.opacity||1,onChange:s=>a("opacity",parseFloat(s.target.value)),className:"w-full"}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[Math.round((t.opacity||1)*100),"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Rotación"}),e.jsx("input",{type:"range",min:"0",max:"360",value:t.rotation||0,onChange:s=>a("rotation",parseInt(s.target.value)),className:"w-full"}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[t.rotation||0,"°"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Reemplazar imagen"}),e.jsx("button",{className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50 transition-colors",children:"Seleccionar nueva imagen"})]})]}),n=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Color de relleno"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",value:t.fill||"#3B82F6",onChange:s=>a("fill",s.target.value),className:"w-8 h-8 rounded border border-gray-300"}),e.jsx("input",{type:"text",value:t.fill||"#3B82F6",onChange:s=>a("fill",s.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm",placeholder:"#3B82F6"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Color del borde"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",value:t.stroke||"#000000",onChange:s=>a("stroke",s.target.value),className:"w-8 h-8 rounded border border-gray-300"}),e.jsx("input",{type:"text",value:t.stroke||"#000000",onChange:s=>a("stroke",s.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm",placeholder:"#000000"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Grosor del borde"}),e.jsx("input",{type:"range",min:"0",max:"10",value:t.strokeWidth||1,onChange:s=>a("strokeWidth",parseInt(s.target.value)),className:"w-full"}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[t.strokeWidth||1,"px"]})]})]}),u=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"X"}),e.jsx("input",{type:"number",value:Math.round(t.x||0),onChange:s=>a("x",parseInt(s.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Y"}),e.jsx("input",{type:"number",value:Math.round(t.y||0),onChange:s=>a("y",parseInt(s.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Ancho"}),e.jsx("input",{type:"number",value:Math.round(t.width||0),onChange:s=>a("width",parseInt(s.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Alto"}),e.jsx("input",{type:"number",value:Math.round(t.height||0),onChange:s=>a("height",parseInt(s.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm"})]})]})]});return e.jsxs(N.div,{className:"p-4",initial:{opacity:0},animate:{opacity:1},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Elemento seleccionado"}),e.jsxs("div",{className:"text-xs text-gray-500 bg-gray-50 rounded p-2",children:["Tipo: ",t.type,t.type==="text"&&t.content&&e.jsxs("div",{className:"mt-1 truncate",children:['"',t.content,'"']})]})]}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsxs("button",{onClick:()=>b(t.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Duplicar"})]}),e.jsxs("button",{onClick:()=>f(t.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:"Eliminar"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Propiedades"}),t.type==="text"&&c(),t.type==="image"&&i(),t.type==="shape"&&n()]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>x(!h),className:"w-full text-left text-xs font-medium text-gray-500 uppercase tracking-wide mb-3 hover:text-gray-700 transition-colors",children:["Posición y tamaño ",h?"▼":"▶"]}),h&&u()]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Capas"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{className:"px-3 py-2 text-xs border border-gray-300 rounded hover:bg-gray-50 transition-colors",children:"Al frente"}),e.jsx("button",{className:"px-3 py-2 text-xs border border-gray-300 rounded hover:bg-gray-50 transition-colors",children:"Atrás"})]})]})]})}function Ae({item:t,canvasPreset:r,onSave:f,onExit:b,user:h,initialProject:x=null}){var T,z;const[a,c]=m.useState(0),[i,n]=m.useState([]),[u,s]=m.useState(null),[g,U]=m.useState({width:(r==null?void 0:r.width)||800,height:(r==null?void 0:r.height)||600,dpi:(r==null?void 0:r.dpi)||300,backgroundColor:(r==null?void 0:r.background_color)||"#ffffff"}),[y,k]=m.useState("elements"),[j,A]=m.useState(1),[D,$]=m.useState(!1),[C,G]=m.useState(!0),[me,he]=m.useState(!0),P=m.useRef(null),S=m.useRef(null);m.useEffect(()=>{V()},[r]);const V=()=>{const l=(r==null?void 0:r.pages)||(t==null?void 0:t.pages)||1,o=[];for(let d=0;d<l;d++)o.push({id:`page-${d}`,elements:[],background:g.backgroundColor,thumbnail:null});n(o)},v={text:{icon:ae,label:"Texto",default:{type:"text",content:"Texto de ejemplo",x:100,y:100,width:200,height:50,fontSize:16,fontFamily:"Arial",color:"#000000",fontWeight:"normal",textAlign:"left"}},image:{icon:M,label:"Imagen",default:{type:"image",src:"",x:100,y:100,width:200,height:200,opacity:1,rotation:0}},shape:{icon:re,label:"Forma",default:{type:"shape",shape:"rectangle",x:100,y:100,width:100,height:100,fill:"#3B82F6",stroke:"#000000",strokeWidth:1}}},R=l=>{const o={...v[l].default,id:`element-${Date.now()}-${Math.random().toString(36).substr(2,9)}`},d=[...i];d[a].elements.push(o),n(d),s(o.id)},F=(l,o)=>{const d=[...i],p=d[a].elements.findIndex(w=>w.id===l);p!==-1&&(d[a].elements[p]={...d[a].elements[p],...o},n(d))},q=l=>{const o=[...i];o[a].elements=o[a].elements.filter(d=>d.id!==l),n(o),u===l&&s(null)},_=l=>{const o=i[a].elements.find(d=>d.id===l);if(o){const d={...o,id:`element-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,x:o.x+20,y:o.y+20},p=[...i];p[a].elements.push(d),n(p),s(d.id)}},O=()=>{const l={id:`page-${i.length}`,elements:[],background:g.backgroundColor,thumbnail:null};n([...i,l])},X=l=>{if(i.length>1){const o=i.filter((d,p)=>p!==l);n(o),a>=o.length&&c(o.length-1)}},Y=l=>{const o=i[l],d={...o,id:`page-${i.length}`,elements:o.elements.map(p=>({...p,id:`element-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}))};n([...i,d])},I=l=>{if(l&&l.type.startsWith("image/")){const o=new FileReader;o.onload=d=>{const p={...v.image.default,id:`element-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,src:d.target.result},w=[...i];w[a].elements.push(p),n(w),s(p.id)},o.readAsDataURL(l)}},H=async()=>{$(!0);try{const l={item_id:t.id,canvas_preset_id:r==null?void 0:r.id,pages:i,settings:g,type:(r==null?void 0:r.type)||"other"};f&&await f(l)}catch(l){console.error("Error saving project:",l)}finally{$(!1)}},Z=()=>{console.log("Exporting project...",{pages:i,settings:g})},J=()=>{var l;return u?(l=i[a])==null?void 0:l.elements.find(o=>o.id===u):null};return e.jsxs("div",{className:"h-screen bg-gray-100 flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:b,className:"flex items-center space-x-2 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsx("span",{children:"Volver"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-lg font-semibold",children:t==null?void 0:t.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[r==null?void 0:r.name," - ",r==null?void 0:r.type]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>A(Math.max(.25,j-.25)),className:"px-2 py-1 text-sm hover:bg-white rounded",children:"-"}),e.jsxs("span",{className:"px-2 py-1 text-sm min-w-[60px] text-center",children:[Math.round(j*100),"%"]}),e.jsx("button",{onClick:()=>A(Math.min(3,j+.25)),className:"px-2 py-1 text-sm hover:bg-white rounded",children:"+"})]}),e.jsx("button",{onClick:()=>G(!C),className:`p-2 rounded-lg transition-colors ${C?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,title:"Mostrar/Ocultar Cuadrícula",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:Z,className:"flex items-center space-x-2 px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"Exportar"})]}),e.jsxs("button",{onClick:H,disabled:D,className:"flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:D?"Guardando...":"Guardar"})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[e.jsx(oe,{activePanel:y,setActivePanel:k,elementTypes:v,onAddElement:R,onImageUpload:I,fileInputRef:S}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs(le,{mode:"wait",children:[y==="elements"&&e.jsx(de,{elementTypes:v,onAddElement:R,onImageUpload:I,fileInputRef:S},"elements"),y==="properties"&&e.jsx(ce,{selectedElement:J(),onUpdateElement:F,onDeleteElement:q,onDuplicateElement:_},"properties")]})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-gray-50 overflow-hidden",children:e.jsx("div",{className:"flex-1 flex items-center justify-center p-4 overflow-auto",children:e.jsxs("div",{className:"bg-white shadow-lg relative",style:{width:g.width*j,height:g.height*j,transform:`scale(${j})`,transformOrigin:"center"},children:[C&&e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`
                                            linear-gradient(to right, #000 1px, transparent 1px),
                                            linear-gradient(to bottom, #000 1px, transparent 1px)
                                        `,backgroundSize:"20px 20px"}}),e.jsx("div",{ref:P,className:"w-full h-full relative cursor-crosshair",style:{backgroundColor:(T=i[a])==null?void 0:T.background},onClick:()=>s(null),children:(z=i[a])==null?void 0:z.elements.map(l=>e.jsx(xe,{element:l,isSelected:u===l.id,onSelect:()=>s(l.id),onUpdate:o=>F(l.id,o),zoom:j},l.id))})]})})}),e.jsx("div",{className:"w-80 bg-white border-l border-gray-200",children:e.jsx(ne,{pages:i,currentPage:a,onPageSelect:c,onAddPage:O,onDeletePage:X,onDuplicatePage:Y,canvasSettings:g})})]}),e.jsx("input",{ref:S,type:"file",accept:"image/*",className:"hidden",onChange:l=>{var o;(o=l.target.files)!=null&&o[0]&&I(l.target.files[0])}})]})}function xe({element:t,isSelected:r,onSelect:f,onUpdate:b,zoom:h}){const[x,a]=m.useState(!1),[c,i]=m.useState({x:0,y:0}),n=y=>{y.stopPropagation(),f(),a(!0),i({x:y.clientX-t.x*h,y:y.clientY-t.y*h})},u=y=>{if(!x)return;const k=(y.clientX-c.x)/h,j=(y.clientY-c.y)/h;b({x:k,y:j})},s=()=>{a(!1)};m.useEffect(()=>{if(x)return document.addEventListener("mousemove",u),document.addEventListener("mouseup",s),()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",s)}},[x,c,h]);const g={position:"absolute",left:t.x,top:t.y,width:t.width,height:t.height,cursor:x?"grabbing":"grab",border:r?"2px solid #3B82F6":"2px solid transparent",borderRadius:"2px"};return(()=>{switch(t.type){case"text":return e.jsx("div",{style:{...g,fontSize:t.fontSize,fontFamily:t.fontFamily,color:t.color,fontWeight:t.fontWeight,textAlign:t.textAlign,display:"flex",alignItems:"center",padding:"4px"},onMouseDown:n,children:t.content});case"image":return e.jsx("div",{style:g,onMouseDown:n,children:t.src?e.jsx("img",{src:t.src,alt:"",className:"w-full h-full object-cover",style:{opacity:t.opacity,transform:`rotate(${t.rotation||0}deg)`},draggable:!1}):e.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:e.jsx(M,{className:"w-8 h-8 text-gray-400"})})});case"shape":return e.jsx("div",{style:{...g,backgroundColor:t.fill,border:`${t.strokeWidth}px solid ${t.stroke}`,borderRadius:t.shape==="circle"?"50%":"0"},onMouseDown:n});default:return null}})()}export{Ae as default};

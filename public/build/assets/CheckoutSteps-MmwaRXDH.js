import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as d}from"./index-BH53Isel.js";import{N as E}from"./Number2Currency-e57Tgsuk.js";import{B as Ne,a as Oe,D as He,A as Xe,O as Ke,C as Qe}from"./OptionCard-CUXQgNVR.js";import{S as le}from"./sparkles-DeLUn6av.js";import{c as we}from"./createLucideIcon-Cy5Ya80P.js";import{M as We}from"./CartItemRow-4VUVjpPz.js";import{P as Ye}from"./plus-Bot15Khs.js";import{T as Je}from"./trash-2-DK1wnsDn.js";import{a as Ze}from"./index-xsH4HHeE.js";import{X as ze}from"./x-DBMwyD6F.js";import{m as et}from"./main-BvVILmTO.js";import{G as ie}from"./Global-ErywZRdd.js";import{t as D}from"./index-CMHsc23u.js";import{I as Z}from"./InputForm-ZnsQvLid.js";import{S as tt}from"./SelectForm-CWPk0TXJ.js";import{l as st}from"./ShippingStep-j3_tvQyk.js";import{C as he}from"./circle-x-p-TkKhsF.js";import{m as ae}from"./proxy-BTYtmp9V.js";import"./ProductNavigation-Bom5Fzkx.js";import"./ProductCard-Ap6bpF1Q.js";/* empty css              */import"./BlogCarousel-CCgb3gK1.js";/* empty css               */import"./InfiniteCategory-BtlY-czj.js";import{R as at}from"./PaymentModal-BB1JXzaZ.js";import{H as rt}from"./HtmlContent-FTivcJrM.js";import"./index-yBjzXJbu.js";import"./useStateManager-7e1e8489.esm-VPSU_3UO.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./floating-ui.dom-8M2NmvqY.js";import"./tippy-react.esm-BWiGTO87.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./chevron-down-DS-mdh9v.js";import"./search-TwiiKGP5.js";import"./check-DQ7QoS0v.js";import"./ItemsRest-DGjwRLrz.js";import"./BasicRest-B3rfI5GY.js";import"./HeaderSearch-DXZLURpX.js";import"./index-CFtDjG4d.js";import"./eye-CKCH9ORv.js";import"./index-Chjiymov.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=we("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=we("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=we("OctagonX",[["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M2.586 16.726A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2h6.624a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586z",key:"2d38gg"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=we("UserRoundX",[["path",{d:"M2 21a8 8 0 0 1 11.873-7",key:"74fkxq"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m17 17 5 5",key:"p7ous7"}],["path",{d:"m22 17-5 5",key:"gqnmv0"}]]);function it({onClick:o,className:x=""}){return e.jsxs("div",{className:`relative ${x}`,children:[e.jsx(le,{size:12,className:"absolute -top-1 -left-1 text-yellow-400 animate-ping",style:{animationDelay:"0s"}}),e.jsx(le,{size:10,className:"absolute -top-2 -right-1 text-pink-400 animate-ping",style:{animationDelay:"0.5s"}}),e.jsx(le,{size:8,className:"absolute -bottom-1 -left-2 text-blue-400 animate-ping",style:{animationDelay:"1s"}}),e.jsx(le,{size:14,className:"absolute -bottom-2 -right-2 text-purple-400 animate-ping",style:{animationDelay:"1.5s"}}),e.jsxs("button",{onClick:o,className:"relative group bg-primary p-2 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 animate-bounce cursor-pointer",style:{animationDuration:"2s",animationIterationCount:"infinite"},children:[e.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl opacity-0 group-hover:opacity-50 transition-opacity duration-300 blur-lg"}),e.jsx(ve,{size:24,className:"text-white relative z-10 drop-shadow-sm"}),e.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl animate-pulse opacity-30"})]}),e.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-20",children:"Â¡PromociÃ³n disponible!"})]})}const lt=({setCart:o,hasPromotion:x,onPromotionClick:i,...m})=>{const q=()=>{o(b=>b.filter(l=>l.id!==m.id))},C=()=>{o(b=>b.map(l=>l.id===m.id?{...l,quantity:(l.quantity||1)+1}:l))},g=()=>{o(b=>b.map(l=>{if(l.id===m.id){const u=(l.quantity||1)-1;return u<=0?(q(m.id),null):{...l,quantity:u}}return l}).filter(Boolean))};return e.jsx("div",{className:"w-full bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center  justify-between gap-4 w-full",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/storage/images/item/${m.image}`,alt:m.name,className:"w-20 h-20 object-cover rounded flex-shrink-0",onError:b=>b.target.src="/api/cover/thumbnail/null"}),x&&e.jsx("div",{className:"absolute -top-2 -right-2",children:e.jsx(it,{onClick:()=>i(m),className:"group"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-lg mb-2 line-clamp-2",children:m.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark",children:m.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Disponibilidad: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[m.stock>=m.quantity?"En stock":"Agotado"," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:m.sku})]})]})]}),e.jsxs("div",{className:"flex flex-row justify-between md:flex-col items-end md:items-end gap-4 mt-4 md:mt-0 flex-shrink-0",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(m.price*m.quantity).toFixed(2)]}),e.jsxs("div",{className:"font-bold text-lg",children:["S/ ",Number(m.final_price*m.quantity).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[e.jsx("button",{type:"button",onClick:g,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Decrease quantity",children:e.jsx(We,{size:16})}),e.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:m.quantity||1})}),e.jsx("button",{type:"button",onClick:C,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Increase quantity",children:e.jsx(Ye,{size:16})})]}),e.jsx("button",{onClick:q,className:"p-2 text-gray-400 hover:text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx(Je,{size:18})})]})]})]})},m.id)},ct="/api";class Te{static async applyToCart(x,i,m=null){var q;try{if(console.log("ðŸ›’ Applying discount rules to cart:",{cartItems:x,totalAmount:i,customerEmail:m}),!Array.isArray(x)||x.length===0)return{success:!1,error:"Carrito vacÃ­o o invÃ¡lido",data:null};const C={cart_items:x.map(b=>{const l={item_id:String(b.item_id||b.id||""),quantity:parseInt(b.quantity)||1,price:parseFloat(b.price||b.final_price||0),name:String(b.name||b.description||"Producto sin nombre"),category_id:b.category_id?String(b.category_id):null};return console.log("ðŸ“¦ Processing cart item:",l),l}),total_amount:parseFloat(i)||0,customer_email:m||null};console.log("ðŸ“¤ Sending payload to API:",C);const g=await Ze.post(`${ct}/discount-rules/apply-to-cart`,C);return g.data.status===200?{success:!0,data:g.data.data,message:g.data.message}:{success:!1,error:g.data.message||"Error al aplicar descuentos",data:null}}catch(C){return console.error("Error applying discount rules:",C),(q=C.response)!=null&&q.data?{success:!1,error:C.response.data.message||"Error del servidor",data:C.response.data.data||null}:{success:!1,error:"Error de conexiÃ³n",data:null}}}static formatDiscounts(x){return!x||!Array.isArray(x)?[]:x.map(i=>({id:i.rule_id,name:i.rule_name||"Descuento automÃ¡tico",description:i.description||"",amount:parseFloat(i.discount_amount||0),type:i.discount_type||"fixed",promotion_type:i.promotion_type||null,free_items:i.free_items||[],formatted_amount:i.discount_type==="percentage"?`${i.discount_amount}%`:`S/ ${parseFloat(i.discount_amount||0).toFixed(2)}`}))}static getFreeItems(x){if(!x||!Array.isArray(x))return[];const i=[];return x.forEach(m=>{m.free_items&&Array.isArray(m.free_items)&&i.push(...m.free_items)}),i}static calculateTotalDiscount(x){return!x||!Array.isArray(x)?0:x.reduce((i,m)=>i+parseFloat(m.discount_amount||0),0)}}function dt({isOpen:o,onClose:x,suggestion:i,onAddToCart:m,productName:q}){const[C,g]=d.useState(!1);if(!o||!i)return null;const b=async()=>{g(!0);try{console.log("Modal - suggestion data:",i),await m(i),x()}catch(l){console.error("Error adding promotional item:",l)}finally{g(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:x}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-300 scale-100",children:[e.jsx("button",{onClick:x,className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors rounded-full hover:bg-gray-100",children:e.jsx(ze,{size:20})}),e.jsxs("div",{className:"text-center pt-8 pb-6 px-6",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"animate-bounce",children:e.jsx(ve,{size:48,className:"customtext-primary mx-auto"})}),e.jsx(le,{size:20,className:"absolute -top-2 -right-2 text-yellow-400 animate-pulse"}),e.jsx(le,{size:16,className:"absolute -bottom-1 -left-2 text-yellow-400 animate-pulse delay-300"})]}),e.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-2",children:"ðŸŽ‰ Â¡PromociÃ³n Especial!"}),e.jsx("p",{className:"text-gray-600",children:"Tienes un producto que califica para una promociÃ³n"})]}),e.jsxs("div",{className:"px-6 pb-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Al tener  ",e.jsxs("span",{className:"font-semibold customtext-primary",children:[i.current_quantity," ",q]})," en tu carrito"]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[e.jsx("p",{className:"font-bold text-lg customtext-primary mb-1",children:i.rule_name}),e.jsx("p",{className:"text-sm customtext-neutral-light",children:i.description||"ObtÃ©n un producto gratis"})]})]})}),e.jsx("div",{className:"border-2 border-dashed rounded-xl p-4 mb-6 bg-green-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 w-9/12",children:[e.jsx("div",{className:"w-12 h-12  rounded-full flex items-center justify-center",children:e.jsx(ve,{className:"customtext-primary",size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold customtext-neutral-dark",children:i.item_name}),e.jsxs("p",{className:"text-sm customtext-primary",children:["Cantidad: ",i.suggested_quantity]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold customtext-primary",children:"Â¡GRATIS!"}),e.jsxs("p",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(i.value||0).toFixed(2)]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:b,disabled:C,className:"w-full bg-primary text-white font-semibold py-3 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none shadow-lg",children:C?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Agregando..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(ve,{size:20}),e.jsx("span",{children:"Â¡Agregar Regalo!"})]})}),e.jsx("button",{onClick:x,className:"w-full bg-gray-100 customtext-neutral-light font-medium py-3 px-6 rounded-xl hover:bg-gray-200 transition-colors duration-200",children:"Tal vez despuÃ©s"})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"* PromociÃ³n vÃ¡lida mientras tengas los productos requeridos en tu carrito"})]})]})})]})}function mt({cart:o,setCart:x,onContinue:i,subTotal:m,envio:q,igv:C,totalFinal:g,openModal:b,automaticDiscounts:l,setAutomaticDiscounts:u,automaticDiscountTotal:a,setAutomaticDiscountTotal:y,totalWithoutDiscounts:f}){const[c,P]=d.useState(l||[]),[F,U]=d.useState(a||0),[V,re]=d.useState(!1),[ke,ee]=d.useState([]),[Q,H]=d.useState([]),[X,K]=d.useState(!1),[te,ce]=d.useState(null),[L,ne]=d.useState(null),G=o.length===0;d.useEffect(()=>{if(o.length>0&&m>0)se();else{const h=[];P(h),U(0),ee([]),H([]),u&&u(h),y&&y(0)}},[o,m]);const se=async()=>{re(!0);try{const h=o.reduce((_,T)=>_+(T.quantity||0),0);console.log("ðŸ›’ CartStep applying discounts:",{cart:o,subTotal:m,totalWithoutDiscounts:f,totalQuantity:h,cartLength:o.length,cartItems:o.map(_=>({id:_.id||_.item_id,name:_.name,quantity:_.quantity,price:_.price||_.final_price,category_id:_.category_id}))});const p=await Te.applyToCart(o,f);if(console.log("ðŸ“¥ Server response:",{success:p.success,data:p.data,error:p.error,fullResult:p}),p.success&&p.data){console.log("âœ… Discounts found:",p.data.applied_discounts);const _=Te.formatDiscounts(p.data.applied_discounts),T=p.data.total_discount||0,B=Te.getFreeItems(p.data.applied_discounts),W=[];p.data.applied_discounts.forEach(O=>{O.suggested_items&&Array.isArray(O.suggested_items)&&W.push(...O.suggested_items)}),P(_),U(T),ee(B),H(W),u&&u(_),y&&y(T)}else{console.error("âŒ Discount application failed:",{error:p.error,success:p.success,data:p.data,fullResult:p});const _=[],T=0;P(_),U(T),ee([]),H([]),u&&u(_),y&&y(T)}}catch(h){console.error("Error applying discount rules:",h);const p=[],_=0;P(p),U(_),ee([]),H([]),u&&u(p),y&&y(_)}finally{re(!1)}},de=h=>Q.some(p=>p.item_id===h||p.triggering_item_id===h),me=h=>Q.find(p=>p.item_id===h||p.triggering_item_id===h),j=h=>{const p=me(h.id);p&&(ce(p),ne(h),K(!0))},$=async h=>{try{console.log("CartStep - handleAddPromotionalItem received:",h),console.log("CartStep - current cart:",o),x(p=>{console.log("CartStep - old cart before update:",p);const _=p.findIndex(T=>(T.item_id||T.id)===h.item_id);if(console.log("CartStep - existingItemIndex:",_),_!==-1){const T=[...p],B=h.quantity||h.suggested_quantity||1;return console.log("CartStep - adding quantity:",B),T[_].quantity+=B,console.log("CartStep - updated cart:",T),T}else{console.log("CartStep - item not found, creating new product");const T={id:h.item_id,name:h.item_name,quantity:h.quantity||h.suggested_quantity||1,price:h.value||0,final_price:h.value||0,image:h.item_image||"default.jpg",brand:{name:h.item_brand||"N/A"},sku:h.item_sku||"PROMO",stock:999};return[...p,T]}}),setTimeout(()=>{se()},100)}catch(p){console.error("Error adding promotional item:",p)}};return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-4 md:gap-8",children:[e.jsx("div",{className:"lg:col-span-3 space-y-4 md:space-y-6",children:G?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center animate-fade-in",children:[e.jsx("svg",{className:"w-24 h-24 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"Tu carrito estÃ¡ vacÃ­o"}),e.jsx("p",{className:"text-gray-500",children:"Â¡Explora nuestros productos y encuentra algo especial!"})]}):o.map((h,p)=>e.jsx(lt,{...h,setCart:x,hasPromotion:de(h.id),onPromotionClick:j},p))}),e.jsxs("div",{className:"lg:col-span-2 bg-[#F7F9FB] rounded-xl shadow-lg p-4 md:p-6 h-max mt-4 md:mt-0",children:[e.jsx("h3",{className:"text-xl md:text-2xl font-bold pb-4 md:pb-6",children:"Resumen"}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",E(m)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",E(C)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"EnvÃ­o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",E(q)]})]}),V&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Verificando descuentos..."}),e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})]}),!V&&c.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xl md:text-2xl font-bold pb-4 md:pb-6  customtext-neutral-dark mb-2",children:"ðŸŽ‰ Descuentos aplicados:"}),c.map((h,p)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"customtext-neutral-dark",children:[h.name,h.description&&e.jsx("span",{className:"text-xs font-semibold block",children:h.description})]}),e.jsxs("span",{className:"customtext-neutral-dark font-semibold",children:["-S/ ",E(h.amount)]})]},p)),e.jsxs("div",{className:"flex justify-between text-sm font-semibold customtext-neutral-dark pt-1",children:[e.jsx("span",{children:"Total descuentos:"}),e.jsxs("span",{children:["-S/ ",E(F)]})]})]}),e.jsxs("div",{className:"py-3 border-y-2 mt-4 md:mt-6",children:[e.jsxs("div",{className:"flex justify-between font-bold text-lg md:text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",E(g)]})]}),F>0&&e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[e.jsxs("span",{className:"line-through",children:["S/ ",E(f||g+F)]}),e.jsxs("span",{className:"ml-2 customtext-neutral-dark font-semibold",children:["Ahorras S/ ",E(F)]})]})]}),e.jsxs("div",{className:"space-y-2 pt-3 md:pt-4",children:[e.jsx(Ne,{onClick:i,className:"w-full",disabled:G,children:G?"Carrito VacÃ­o":"Continuar Compra"}),e.jsx(Oe,{href:"/",className:"w-full",children:G?"Ir a Comprar":"Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-xs md:text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas losÂ ",e.jsx("a",{href:"#",onClick:()=>b(1),className:"customtext-primary font-bold",children:"TÃ©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestraÂ ",e.jsx("a",{href:"#",onClick:()=>b(0),className:"customtext-primary font-bold",children:"PolÃ­tica de Privacidad"}),"."]})})]})]}),e.jsx(dt,{isOpen:X,onClose:()=>K(!1),suggestion:te,onAddToCart:$,productName:(L==null?void 0:L.name)||""})]})}function ut(){let o="";for(let x=0;x<12;x++){const i=Math.floor(Math.random()*10);o+=i}return o}const pt=o=>new Promise((x,i)=>{var m;try{console.log(o);const q=ut(o.email);console.log(q);let C=!1;window.Culqi.publicKey=ie.CULQI_PUBLIC_KEY;const g=parseFloat(o.amount.toFixed(2)),b=Math.round(g*100);console.log("ðŸ’° Configurando Culqi:"),console.log("   - Monto original:",o.amount),console.log("   - Monto redondeado (soles):",g),console.log("   - Monto en cÃ©ntimos:",b),console.log("   - Email:",o.email),window.Culqi.settings({title:ie.APP_NAME,email:o.email,currency:"PEN",amount:b,order:`${q}`}),console.log(window.Culqi.settings),window.Culqi.options({lang:"es",installments:!1,paymentMethods:{tarjeta:!0,yape:!0,bancaMovil:!0,agente:!0,billetera:!0,cuotealo:!0},style:{logo:ie.APP_URL+"/assets/resources/logo.png",bannerColor:ie.APP_COLOR_PRIMARY,buttonBackground:ie.APP_COLOR_PRIMARY}});const l=(m=window.Culqi)==null?void 0:m.close;l&&(window.Culqi.close=function(){return!window.Culqi.token&&!C&&(console.log("ðŸš« Modal de Culqi cerrado sin completar el pago"),i("Pago cancelado por el usuario")),l.apply(this,arguments)}),window.Culqi.open(),window.culqi=async function(){try{if(!window.Culqi.token){i("No se obtuvo un token de Culqi");return}C=!0;const a=window.Culqi.token.id;console.log("âœ… Token generado:",a),o={...o,token:a,orderNumber:q},console.log("_request actualizado",o);const{status:y,result:f}=await et.Fetch("./api/pago",{method:"POST",body:JSON.stringify(o)});y||console.log((f==null?void 0:f.message)||"Error en el pago"),window.Culqi.close(),D.success("Â¡Pago exitoso!",{description:"Tu pago se procesÃ³ correctamente. Pronto recibirÃ¡s la confirmaciÃ³n de tu pedido.",duration:3e3,position:"top-right",richColors:!0}),x(f)}catch(a){D.error("Â¡Error en el Pago!",{description:a.message,duration:3e3,position:"top-right",richColors:!0}),i(a.message||"Error en el pago")}},window.addEventListener("message",function(a){a.data==="culqi_closed"&&i("Pago cancelado por el usuario")});const u=a=>{a.key==="Escape"&&!C&&(console.log("ðŸš« Modal de Culqi cerrado con Escape"),i("Pago cancelado por el usuario"))};document.addEventListener("keydown",u),setTimeout(()=>{document.removeEventListener("keydown",u)},3e5),document.addEventListener("culqi.error",function(a){var y,f;D.error("Â¡Error en Culqi!",{description:((y=a.detail)==null?void 0:y.message)||"Error desconocido",duration:3e3,position:"top-right",richColors:!0}),i(((f=a.detail)==null?void 0:f.message)||"Error desconocido")})}catch(q){D.error("Â¡Error en la integraciÃ³n con Culqi!",{description:q.message,duration:3e3,position:"top-right",richColors:!0}),i("Error en la integraciÃ³n con Culqi")}});function xt({cart:o,setSale:x,setCode:i,setDelivery:m,setCart:q,onContinue:C,noContinue:g,subTotal:b,igv:l,totalFinal:u,user:a,setEnvio:y,envio:f,ubigeos:c=[],openModal:P,setCouponDiscount:F,setCouponCode:U,automaticDiscounts:V=[],automaticDiscountTotal:re=0,totalWithoutDiscounts:ke,conversionScripts:ee,setConversionScripts:Q,onPurchaseComplete:H}){const[X,K]=d.useState(null),[te,ce]=d.useState(null),[L,ne]=d.useState([]),[G,se]=d.useState(0);L.reduce((s,t)=>t.free_items&&Array.isArray(t.free_items)?[...s,...t.free_items]:s,[]);const de=(s,t)=>{var k;let r=[],w=0;for(const n of t)switch(n.type){case"buy_x_get_y":{s.forEach(v=>{var N;if((N=n.product_ids)!=null&&N.includes(v.id)){const R=Math.floor(v.quantity/(n.buy+n.get));if(R>0&&n.get>0){const J=R*n.get,xe=J*v.final_price;r.push({name:n.name,amount:xe,description:n.description,free_items:[{...v,quantity:J}]}),w+=xe}}});break}case"quantity_discount":{s.forEach(v=>{var N;if((N=n.product_ids)!=null&&N.includes(v.id)){const R=Math.floor(v.quantity/n.buy);if(R>0&&n.pay<n.buy){const J=R*(n.buy-n.pay)*v.final_price;r.push({name:n.name,amount:J,description:n.description}),w+=J}}});break}case"tiered_discount":{s.forEach(v=>{var N;if((N=n.product_ids)!=null&&N.includes(v.id)){const R=Math.floor(v.quantity/n.tier);if(R>0&&n.free>0){const J=R*n.free,xe=J*v.final_price;r.push({name:n.name,amount:xe,description:n.description,free_items:[{...v,quantity:J}]}),w+=xe}}});break}case"category_discount":{s.forEach(v=>{var N;if((N=n.category_ids)!=null&&N.includes(v.category_id)){const R=v.final_price*v.quantity*(n.percent/100);R>0&&(r.push({name:n.name,amount:R,description:n.description}),w+=R)}});break}case"cart_discount":{const v=s.reduce((N,R)=>N+R.final_price*R.quantity,0);if(v>=(n.min_total||0)){const N=n.percent?v*(n.percent/100):n.amount||0;N>0&&(r.push({name:n.name,amount:N,description:n.description}),w+=N)}break}case"bundle_discount":{((k=n.product_ids)==null?void 0:k.every(N=>s.some(R=>R.id===N)))&&n.amount>0&&(r.push({name:n.name,amount:n.amount,description:n.description}),w+=n.amount);break}}return{discounts:r,totalDiscount:w}};d.useEffect(()=>{if(V&&Array.isArray(V)&&V.length>0){const{discounts:s,totalDiscount:t}=de(o,V);ne(s),se(t)}else ne([]),se(0)},[o,V]);const me=[{value:"dni",label:"DNI"},{value:"ruc",label:"RUC"},{value:"ce",label:"CE"},{value:"pasaporte",label:"Pasaporte"}],[j,$]=d.useState({name:(a==null?void 0:a.name)||"",lastname:(a==null?void 0:a.lastname)||"",email:(a==null?void 0:a.email)||"",phone:(a==null?void 0:a.phone)||"",documentType:(a==null?void 0:a.document_type)||"",document:(a==null?void 0:a.document_number)||"",department:(a==null?void 0:a.department)||"",province:(a==null?void 0:a.province)||"",district:(a==null?void 0:a.district)||"",address:(a==null?void 0:a.address)||"",number:(a==null?void 0:a.number)||"",comment:"",reference:(a==null?void 0:a.reference)||"",ubigeo:(a==null?void 0:a.ubigeo)||null});d.useEffect(()=>{if(a!=null&&a.ubigeo&&(a!=null&&a.district)&&(a!=null&&a.province)&&(a!=null&&a.department)){const s={value:a.ubigeo,label:`${a.district}, ${a.province}, ${a.department}`,data:{reniec:a.ubigeo,departamento:a.department,provincia:a.province,distrito:a.district}};ce(s),K(s),Re(s)}},[a]);const[h,p]=d.useState(!1),[_,T]=d.useState(!1),[B,W]=d.useState([]),[O,M]=d.useState(null),[Y,Ce]=d.useState(null),[S,z]=d.useState({}),[_e,fe]=d.useState(""),[ge,ye]=d.useState(!1),[oe,Ae]=d.useState(""),[A,Fe]=d.useState(null),[Se,qe]=d.useState(0),[be,Me]=d.useState(!1),[Ee,ue]=d.useState(""),Le=s=>{var r,w,k;const t=["name","lastname","documentType","document","email","phone","ubigeo","address","shipping"];for(const n of t)if(s[n]){let v=null,N=!1;if(n==="ubigeo"?v=((w=(r=document.querySelector('[name="ubigeo"]'))==null?void 0:r.parentElement)==null?void 0:w.parentElement)||document.querySelector(".css-1s2u09g-control")||document.querySelector('[class*="react-select"]'):n==="shipping"?v=((k=document.querySelector('input[name="shipping"]'))==null?void 0:k.closest(".space-y-4"))||document.querySelector(".space-y-4 h3")||document.querySelector("h3"):(v=document.querySelector(`[name="${n}"]`),N=!0),v){v.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),N&&setTimeout(()=>{try{v.focus(),v.tagName==="INPUT"&&v.type==="text"&&v.select()}catch(R){console.warn("No se pudo enfocar el elemento:",R)}},600),De(v);break}}},De=s=>{if(!s)return;const t=document.createElement("div");if(t.style.cssText=`
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border: 2px solid #ef4444;
            border-radius: 8px;
            pointer-events: none;
            z-index: 1000;
            animation: pulse 0.6s ease-in-out;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.2);
        `,!document.querySelector("#error-highlight-styles")){const w=document.createElement("style");w.id="error-highlight-styles",w.textContent=`
                @keyframes pulse {
                    0% { transform: scale(1); opacity: 1; }
                    50% { transform: scale(1.02); opacity: 0.8; }
                    100% { transform: scale(1); opacity: 1; }
                }
            `,document.head.appendChild(w)}const r=s.style.position;(!r||r==="static")&&(s.style.position="relative"),s.appendChild(t),setTimeout(()=>{t.parentNode&&(t.parentNode.removeChild(t),(!r||r==="static")&&(s.style.position=r))},1200)},Re=async s=>{if(!s)return;z(r=>({...r,ubigeo:""}));const{data:t}=s;$(r=>({...r,department:t.departamento,province:t.provincia,district:t.distrito,ubigeo:t.reniec})),p(!0);try{const r=await He.getShippingCost({ubigeo:t.reniec}),w=[];r.data.is_free?(w.push({type:"free",price:0,description:r.data.standard.description,deliveryType:r.data.standard.type,characteristics:r.data.standard.characteristics}),r.data.express.price>0&&w.push({type:"express",price:r.data.express.price,description:r.data.express.description,deliveryType:r.data.express.type,characteristics:r.data.express.characteristics})):r.data.is_agency?w.push({type:"agency",price:0,description:r.data.agency.description,deliveryType:r.data.agency.type,characteristics:r.data.agency.characteristics}):w.push({type:"standard",price:r.data.standard.price,description:r.data.standard.description,deliveryType:r.data.standard.type,characteristics:r.data.standard.characteristics}),W(w),M(w[0].type),y(w[0].price),ye(!1)}catch{D.error("Sin cobertura",{description:"No realizamos envÃ­os a esta ubicaciÃ³n.",icon:e.jsx(Pe,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"}),W([]),M(null),y(0),ye(!1)}p(!1)},Ie=async s=>{var k,n;if(s.preventDefault(),_)return;if(!a){D.error("Acceso requerido",{description:"Debe iniciar sesiÃ³n para continuar.",icon:e.jsx(ot,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"});return}const t={},r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,w=/^[0-9]{9}$/;if(j.name.trim()||(t.name="Nombre es requerido"),j.lastname.trim()||(t.lastname="Apellido es requerido"),j.documentType.trim()||(t.documentType="Tipo de documento es requerido"),j.document.trim()||(t.document="NÃºmero de documento es requerido"),j.email.trim()?r.test(j.email)||(t.email="Email invÃ¡lido"):t.email="Email es requerido",j.phone.trim()?w.test(j.phone.trim())||(t.phone="TelÃ©fono debe tener exactamente 9 dÃ­gitos"):t.phone="TelÃ©fono es requerido",j.ubigeo||(t.ubigeo="UbicaciÃ³n es requerida"),j.address||(t.address="DirecciÃ³n es requerida"),O||(t.shipping="Seleccione un mÃ©todo de envÃ­o"),Object.keys(t).length>0){z(t);const v=Object.keys(t)[0],N={name:"Por favor ingrese su nombre",lastname:"Por favor ingrese su apellido",documentType:"Por favor seleccione el tipo de documento",document:"Por favor ingrese su nÃºmero de documento",email:(k=t.email)!=null&&k.includes("invÃ¡lido")?"Por favor ingrese un correo electrÃ³nico vÃ¡lido":"Por favor ingrese su correo electrÃ³nico",phone:(n=t.phone)!=null&&n.includes("9 dÃ­gitos")?"El telÃ©fono debe tener exactamente 9 dÃ­gitos":"Por favor ingrese su nÃºmero de telÃ©fono",ubigeo:"Por favor seleccione su ubicaciÃ³n de entrega",address:"Por favor ingrese su direcciÃ³n de entrega",shipping:"Por favor seleccione un mÃ©todo de envÃ­o"};D.error("Complete el campo requerido",{description:N[v],icon:e.jsx(he,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),Le(t);return}T(!0);try{const v={user_id:a.id,...j,fullname:`${j.name} ${j.lastname}`,country:"PerÃº",document_type:j.documentType,amount:I(je),delivery:I(f),cart:o,coupon_id:(A==null?void 0:A.id)||null,coupon_code:(A==null?void 0:A.code)||null,coupon_discount:I(Se||0),applied_promotions:V||[],promotion_discount:I(re||0)};console.log("ðŸ“¦ Request completo a enviar:",v),console.log("ðŸ’° Monto final con cupÃ³n:",je),console.log("ðŸŽŸï¸ Descuento del cupÃ³n:",Se),console.log("ðŸšš Costo de envÃ­o:",f);const N=await pt(v);N.status?(x(N.sale),m(N.delivery),i(N.code),N.conversion_scripts&&(console.log("Scripts de conversiÃ³n recibidos:",N.conversion_scripts),Q(N.conversion_scripts),H&&H(N.sale_id,N.conversion_scripts)),q([]),C()):D.error("Error en el pago",{description:N.message||"Pago rechazado",icon:e.jsx(Pe,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}catch{D.error("Lo sentimos, no puede continuar con la compra",{description:"OcurriÃ³ un error al procesar el pedido.",icon:e.jsx(Pe,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}finally{T(!1)}},Ve=d.useCallback(st.debounce((s,t)=>{if(s.length<3){t([]);return}fetch(`/api/ubigeo/search?q=${encodeURIComponent(s)}`).then(r=>{if(!r.ok)throw new Error("Error en la respuesta");return r.json()}).then(r=>{const w=r.map(k=>({value:k.reniec,label:`${k.distrito}, ${k.provincia}, ${k.departamento}`,data:{inei:k.inei,reniec:k.reniec,departamento:k.departamento,provincia:k.provincia,distrito:k.distrito}}));t(w)}).catch(r=>{t([])})},300),[]);d.useEffect(()=>{z(s=>{const t={...s};return j.name.trim()&&delete t.name,j.lastname.trim()&&delete t.lastname,j.documentType.trim()&&delete t.documentType,j.document.trim()&&delete t.document,j.email.trim()&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(j.email)&&delete t.email,j.phone.trim()&&/^[0-9]{9}$/.test(j.phone.trim())&&delete t.phone,j.address.trim()&&delete t.address,j.ubigeo&&delete t.ubigeo,O&&delete t.shipping,t})},[j,O]);const Be=s=>({control:t=>({...t,border:`1px solid ${s?"#ef4444":"#e5e7eb"}`,boxShadow:"none",minHeight:"50px","&:hover":{borderColor:s?"#ef4444":"#6b7280"},borderRadius:"0.75rem",padding:"2px 8px"}),menu:t=>({...t,zIndex:9999,marginTop:"4px",borderRadius:"8px"}),option:t=>({...t,color:"#1f2937",backgroundColor:"white","&:hover":{backgroundColor:"#f3f4f6"},padding:"12px 16px"})}),Ue=async()=>{var s;if(!oe.trim()){ue("Ingrese un cÃ³digo de cupÃ³n");return}Me(!0),ue("");try{const t=[...new Set(o.map(n=>n.category_id).filter(Boolean))],r=o.map(n=>n.id);console.log("Validando cupÃ³n:",{code:oe.trim(),cart_total:b,category_ids:t,product_ids:r});const w=await Qe.validateCoupon({code:oe.trim(),cart_total:b,category_ids:t,product_ids:r});console.log("Respuesta del cupÃ³n:",w);const k=w.data||w;if(k&&k.valid){Fe(k.coupon);const n=Math.round(k.discount*100)/100;qe(n),F&&F(n),U&&U(((s=k.coupon)==null?void 0:s.code)||oe.trim()),D.success("CupÃ³n aplicado",{description:k.message||"CupÃ³n aplicado correctamente",duration:3e3,position:"top-center"})}else{const n=(k==null?void 0:k.message)||"CupÃ³n no vÃ¡lido";ue(n),D.error("CupÃ³n no vÃ¡lido",{description:n,icon:e.jsx(he,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-center"})}}catch(t){console.error("Error al validar cupÃ³n:",t),ue("Error al validar el cupÃ³n"),D.error("Error",{description:t.message||"No se pudo validar el cupÃ³n. Intente nuevamente.",icon:e.jsx(he,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-center"})}finally{Me(!1)}},Ge=()=>{Fe(null),qe(0),Ae(""),ue(""),F&&F(0),U&&U(""),D.success("CupÃ³n removido",{description:"El cupÃ³n ha sido removido de su pedido",duration:2e3,position:"top-center"})},I=s=>{const t=typeof s=="string"?parseFloat(s):s;return parseFloat(t.toFixed(2))},$e=I(b)+I(l)+I(f)-I(G);let pe=0;A&&(A.type==="percentage"||A.type==="percent"?pe=$e*Number(A.value)/100:A.type==="fixed"&&(pe=Number(A.value))),d.useEffect(()=>{qe(I(pe)),F&&F(I(pe))},[A,b,l,f,G]);const je=Math.max(0,I($e-pe));return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 md:gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("form",{className:"space-y-4 md:space-y-6 bg-white p-4 md:p-6 rounded-xl shadow-sm",onSubmit:Ie,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Z,{name:"name",label:"Nombres",value:j.name,error:S.name,onChange:s=>{$(t=>({...t,name:s.target.value})),s.target.value.trim()&&S.name&&z(t=>({...t,name:""}))},required:!0,className:`border-gray-200 ${S.name?"border-red-500 bg-red-50":""}`}),e.jsx(Z,{name:"lastname",label:"Apellidos",value:j.lastname,error:S.lastname,onChange:s=>{$(t=>({...t,lastname:s.target.value})),s.target.value.trim()&&S.lastname&&z(t=>({...t,lastname:""}))},required:!0,className:`border-gray-200 ${S.lastname?"border-red-500 bg-red-50":""}`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(tt,{label:"Tipo de documento",options:me,placeholder:"Selecciona tu documento",labelClass:"block text-sm 2xl:!text-base mb-1 customtext-neutral-dark",value:j.documentType,error:S.documentType,onChange:s=>{$(t=>({...t,documentType:s})),s&&S.documentType&&z(t=>({...t,documentType:""}))},required:!0})}),e.jsx(Z,{name:"document",label:"NÃºmero de documento",value:j.document,error:S.document,onChange:s=>{$(t=>({...t,document:s.target.value})),s.target.value.trim()&&S.document&&z(t=>({...t,document:""}))},placeholder:"Ej: 12345678",required:!0,className:`border-gray-200 ${S.document?"border-red-500 bg-red-50":""}`})]}),e.jsx(Z,{name:"email",label:"Correo electrÃ³nico",type:"email",value:j.email,error:S.email,onChange:s=>{$(t=>({...t,email:s.target.value})),s.target.value.trim()&&S.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.target.value)&&z(r=>({...r,email:""}))},required:!0,className:`border-gray-200 ${S.email?"border-red-500 bg-red-50":""}`}),e.jsx(Z,{name:"phone",label:"TelÃ©fono",type:"tel",value:j.phone,error:S.phone,onChange:s=>{const t=s.target.value.replace(/\D/g,"");$(r=>({...r,phone:t})),t.length===9&&S.phone&&z(r=>({...r,phone:""}))},maxLength:"9",placeholder:"Ej: 987654321",required:!0,className:`border-gray-200 ${S.phone?"border-red-500 bg-red-50":""}`}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"block text-sm 2xl:text-base mb-2 font-medium customtext-neutral-dark",children:["Distrito / Provincia / Departamento (UbicaciÃ³n de entrega)",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(Xe,{name:"ubigeo",cacheOptions:!0,value:X,loadOptions:Ve,onChange:s=>{K(s),Re(s),fe("")},inputValue:_e,onInputChange:(s,{action:t})=>{t==="input-change"&&fe(s)},onFocus:()=>{K(null),fe("")},onMenuOpen:()=>{X&&(K(null),fe(""))},placeholder:"Buscar por Distrito ...",loadingMessage:()=>"Buscando ubicaciones...",noOptionsMessage:({inputValue:s})=>s.length<3?"Buscar por Distrito ...":"No se encontraron resultados",isLoading:h,styles:Be(!!S.ubigeo),formatOptionLabel:({data:s})=>e.jsxs("div",{className:"text-sm py-1",children:[e.jsx("div",{className:"font-medium",children:s.distrito}),e.jsxs("div",{className:"text-gray-500",children:[s.provincia,", ",s.departamento]})]}),className:"w-full rounded-xl transition-all duration-300",menuPortalTarget:document.body,isClearable:!0}),S.ubigeo&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:S.ubigeo})]}),e.jsx(Z,{name:"address",label:"DirecciÃ³n ",value:j.address,error:S.address,onChange:s=>{$(t=>({...t,address:s.target.value})),s.target.value.trim()&&S.address&&z(t=>({...t,address:""}))},required:!0,className:`border-gray-200 ${S.address?"border-red-500 bg-red-50":""}`}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Z,{label:"NÃºmero",value:j.number,onChange:s=>$(t=>({...t,number:s.target.value})),className:"border-gray-200"}),e.jsx(Z,{label:"Referencia",value:j.reference,onChange:s=>$(t=>({...t,reference:s.target.value})),className:"border-gray-200"})]}),B.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"MÃ©todo de envÃ­o"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:B.map(s=>e.jsx(Ke,{title:s.deliveryType,price:s.price,description:s.description,selected:O===s.type,onSelect:()=>{M(s.type),y(s.price),z(t=>({...t,shipping:""})),ye(!1)}},s.type))}),O&&B.length>0&&e.jsx("div",{className:"space-y-3 mt-4",children:(()=>{var w;const s=((w=B.find(k=>k.type===O))==null?void 0:w.characteristics)||[],t=s.length>1,r=t&&!ge?s.slice(0,1):s;return e.jsxs(e.Fragment,{children:[r.map((k,n)=>e.jsxs("div",{className:"flex items-start gap-3 bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"w-5 flex-shrink-0",children:e.jsx(nt,{className:"customtext-primary"})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium customtext-neutral-dark",children:k})})]},`char-${n}`)),t&&e.jsx("div",{className:"flex justify-center mt-3",children:e.jsxs("button",{type:"button",onClick:()=>ye(!ge),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium customtext-primary hover:bg-blue-50 rounded-lg transition-colors duration-200",children:[e.jsx("span",{children:ge?"Ver menos informaciÃ³n":`Ver mÃ¡s informaciÃ³n (${s.length-1} mÃ¡s)`}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${ge?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})})()})]}),!g&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-end gap-3 md:gap-4 mt-6",children:[e.jsx(Oe,{type:"button",onClick:()=>window.history.back(),className:"w-full md:w-auto",children:"Regresar"}),e.jsx(Ne,{type:"submit",loading:h,className:"w-full md:w-auto",children:"Continuar"})]})]})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen"}),e.jsx("div",{className:"space-y-4 border-b-2 pb-6",children:o.map(s=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:`/storage/images/item/${s.image}`,alt:s.name,className:"w-16 h-16 object-cover rounded-lg",onError:t=>t.target.src="/api/cover/thumbnail/null"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Cantidad: ",s.quantity]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["S/ ",E(s.final_price)]})]})]},s.id))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["S/ ",E(I(b))]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"IGV (18%):"}),e.jsxs("span",{children:["S/ ",E(I(l))]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"EnvÃ­o:"}),e.jsxs("span",{children:["S/ ",E(I(f))]})]}),e.jsx("div",{className:"space-y-4 border-t pt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium customtext-neutral-dark",children:"Â¿Tienes un cupÃ³n de descuento?"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",placeholder:"Ingresa tu cÃ³digo de cupÃ³n",value:oe,onChange:s=>Ae(s.target.value.toUpperCase()),className:`w-full px-4 py-3 border customtext-neutral-dark  border-gray-100 rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300 ${Ee?"border-red-300 bg-red-50 text-red-900 focus:border-red-500 focus:ring-red-200":A?"border-gray-200 bg-white customtext-neutral-dark focus:ring-blue-200":" bg-white border-neutral-light focus:ring-0 focus:outline-0"} `,disabled:!!A||be}),be&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"})})]}),A?e.jsx("button",{type:"button",onClick:Ge,className:"px-4 py-3 bg-gray-200 customtext-neutral-dark text-sm rounded-xl hover:bg-gray-300 transition-colors duration-200",title:"Remover cupÃ³n",children:e.jsx(he,{className:"h-4 w-4"})}):e.jsx("button",{type:"button",onClick:Ue,disabled:be||!oe.trim(),className:"px-6 py-3 bg-primary text-white text-sm font-medium rounded-xl hover:opacity-90 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all duration-200 whitespace-nowrap",children:be?"Validando...":"Aplicar"})]}),Ee&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(he,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:Ee})]}),A&&e.jsx("div",{className:"bg-gray-50 border-2  rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 w-8/12",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsxs("p",{className:"customtext-primary font-semibold text-sm",children:["Descto. ",A.type==="percentage"?`${A.value}%`:`S/${E(A.value)}`]}),e.jsx("p",{className:"customtext-primary text-xs mt-1",children:A.code})]})]}),e.jsx("div",{className:"text-right w-4/12",children:e.jsxs("span",{className:"customtext-primary font-bold text-base",children:["-S/ ",E(I(Se))]})})]})})]})}),L&&L.length>0&&e.jsx("div",{className:"space-y-4 border-t pt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-medium customtext-neutral-dark mb-2",children:"ðŸŽ‰ Descuentos automÃ¡ticos aplicados:"}),L.map((s,t)=>e.jsx("div",{className:" border-2  rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 w-8/12",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"customtext-neutral-dark font-semibold text-sm",children:s.name}),s.description&&e.jsx("p",{className:"customtext-neutral-dark text-xs mt-1",children:s.description})]})]}),e.jsx("div",{className:"text-right w-4/12",children:e.jsxs("span",{className:"customtext-neutral-dark font-bold text-base",children:["-S/ ",E(s.amount)]})})]})},t)),G>0&&e.jsx("div",{className:"l p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"customtext-neutral-dark font-semibold",children:"Total descuentos automÃ¡ticos:"}),e.jsxs("span",{className:"customtext-neutral-dark font-bold text-lg",children:["-S/ ",E(G)]})]})})]})}),e.jsx("div",{className:"pt-4 border-t-2",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["S/ ",E(I(je))]})]})}),e.jsx(Ne,{onClick:Ie,className:"w-full mt-6",disabled:_,loading:_,children:_?"Procesando...":`Pagar S/ ${E(I(je))}`}),e.jsxs("p",{className:"text-xs md:text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas losÂ ",e.jsx("a",{href:"#",onClick:()=>P(1),className:"customtext-primary font-bold",children:"TÃ©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestraÂ ",e.jsx("a",{href:"#",onClick:()=>P(0),className:"customtext-primary font-bold",children:"PolÃ­tica de Privacidad"}),"."]})]})]})]})}function ht({cart:o,code:x,delivery:i,couponDiscount:m=0,couponCode:q=null,conversionScripts:C=null,automaticDiscounts:g=[],automaticDiscountTotal:b=0}){const l=o.reduce((c,P)=>{const F=P.final_price;return c+F*P.quantity},0),u=parseFloat((l/1.18).toFixed(2)),a=parseFloat((l-u).toFixed(2)),f=parseFloat(u)+parseFloat(a)+parseFloat(i)-m-b;return d.useEffect(()=>{if(C){console.log("Executing conversion scripts...");try{if(C.head){const c=document.createElement("script");c.innerHTML=C.head,document.head.appendChild(c)}if(C.body){const c=document.createElement("script");c.innerHTML=C.body,document.body.appendChild(c)}console.log("Conversion scripts executed successfully")}catch(c){console.error("Error executing conversion scripts:",c)}}},[C]),e.jsx(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 py-12",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-10",children:e.jsxs(ae.div,{initial:{scale:.9},animate:{scale:1},transition:{delay:.3},className:"text-center space-y-6",children:[e.jsx(ae.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.5},className:"w-20 h-20 bg-secondary rounded-full mx-auto flex items-center justify-center",children:e.jsx("span",{className:"text-4xl",children:"âœ“"})}),e.jsx("h2",{className:"text-2xl md:text-3xl customtext-neutral-light animate-bounce",children:"Â¡Gracias por tu compra! ðŸŽ‰"}),e.jsx("p",{className:"customtext-neutral-dark text-3xl md:text-5xl font-bold",children:"Tu orden ha sido recibida"}),e.jsxs(ae.div,{whileHover:{scale:1.05},className:"py-6 px-4 bg-secondary rounded-xl inline-block",children:[e.jsx("div",{className:"customtext-neutral-light",children:"CÃ³digo de pedido"}),e.jsx("div",{className:"customtext-neutral-dark text-xl font-bold",children:`#${x}`})]}),e.jsxs("div",{className:"space-y-6 bg-[#F7F9FB] p-6 md:p-8 rounded-xl shadow-inner",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:o.map((c,P)=>e.jsx(ae.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:P*.2},className:"bg-white rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow duration-300",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-center sm:items-start",children:[e.jsx("div",{className:"bg-gray-50 p-3 rounded-xl",children:e.jsx("img",{src:`/storage/images/item/${c.image}`,alt:c.name,className:"w-24 h-24 object-cover rounded-lg",onError:F=>F.target.src="/api/cover/thumbnail/null",loading:"lazy"})}),e.jsxs("div",{className:"text-center sm:text-left flex-1",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-xl lg:w-8/12 line-clamp-3",children:c.name}),e.jsx("div",{className:"mt-2 sm:mt-0 text-center lg:text-right lg:w-4/12",children:e.jsxs("div",{className:"font-bold text-lg customtext-primary",children:["S/ ",E(c.final_price*c.quantity)]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark font-medium",children:c.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsx("span",{className:"customtext-neutral-dark font-medium",children:c.quantity})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark font-medium",children:c.sku})]})]})]})]})},P))}),e.jsxs(ae.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"space-y-4 mt-6",children:[[{label:"Subtotal",value:u},{label:"IGV",value:a},{label:"EnvÃ­o",value:i}].map((c,P)=>e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"customtext-neutral-dark",children:c.label}),e.jsxs("span",{className:"font-semibold",children:["S/ ",E(c.value)]})]},P)),m>0&&q&&e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsxs("span",{className:"customtext-neutral-dark text-start",children:["CupÃ³n: ",e.jsx("br",{className:"lg:hidden"}),e.jsxs("span",{className:"font-semibold text-xs lg:text-base",children:["(",q,")"]})]}),e.jsxs("span",{className:"font-semibold",children:["-S/ ",E(m)]})]}),b>0&&g.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xl md:text-2xl font-bold pb-4 md:pb-6 customtext-neutral-dark mb-2",children:"ðŸŽ‰ Descuentos aplicados:"}),g.map((c,P)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"customtext-neutral-dark",children:[c.name,c.description&&e.jsx("span",{className:"text-xs font-semibold block",children:c.description})]}),e.jsxs("span",{className:"customtext-neutral-dark font-semibold",children:["-S/ ",E(c.amount)]})]},P)),e.jsxs("div",{className:"flex justify-between text-sm font-semibold customtext-neutral-dark pt-1",children:[e.jsx("span",{children:"Total descuentos:"}),e.jsxs("span",{children:["-S/ ",E(b)]})]})]}),e.jsx("div",{className:"py-4 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-xl md:text-2xl items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",E(f)]})]})})]}),e.jsx(ae.div,{className:"pt-6",whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsx(Ne,{href:"/catalogo",className:"w-full mx-auto md:w-auto",children:"Seguir Comprando"})})]})]})})})}const ft=()=>{const o=d.useRef({hasTrackedPageView:!1,hasTrackedInitiateCheckout:!1}),x=(l,u={})=>{typeof window>"u"||(typeof window.fbq<"u"&&window.fbq("track","ViewContent",{content_ids:[l],content_type:"product",content_name:u.name||"",value:u.price||0,currency:"PEN"}),typeof window.gtag<"u"&&window.gtag("event","view_item",{currency:"PEN",value:u.price||0,items:[{item_id:l,item_name:u.name||"",category:u.category||"",price:u.price||0}]}),typeof window.ttq<"u"&&window.ttq.track("ViewContent",{content_id:l,content_type:"product",content_name:u.name||"",value:u.price||0,currency:"PEN"}),console.log("âœ… ProductView tracked for product:",l))},i=async(l,u=1,a={})=>{var y;if(!(typeof window>"u"))try{const c=await(await fetch("/api/tracking/add-to-cart",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((y=document.querySelector('meta[name="csrf-token"]'))==null?void 0:y.content)||""},body:JSON.stringify({product_id:l,quantity:u,...a})})).json();c.success&&c.tracking_scripts&&(g(c.tracking_scripts),console.log("âœ… AddToCart tracked successfully"))}catch(f){console.error("âŒ Error tracking AddToCart:",f)}},m=async(l,u)=>{var a;if(!(typeof window>"u"||o.current.hasTrackedInitiateCheckout))try{o.current.hasTrackedInitiateCheckout=!0;const f=await(await fetch("/api/tracking/initiate-checkout",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.content)||""},body:JSON.stringify({cart_items:l.map(c=>({product_id:c.id,name:c.name,price:c.final_price||c.price,quantity:c.quantity,subtotal:(c.final_price||c.price)*c.quantity}))})})).json();f.success&&f.tracking_scripts&&(g(f.tracking_scripts),console.log("âœ… InitiateCheckout tracked successfully"))}catch(y){console.error("âŒ Error tracking InitiateCheckout:",y),o.current.hasTrackedInitiateCheckout=!1}},q=(l,u)=>{typeof window>"u"||(u?g(u):fetch(`/api/tracking/purchase/${l}`).then(a=>a.text()).then(a=>{a&&(g(a),console.log("âœ… Purchase tracked successfully"))}).catch(a=>{console.error("âŒ Error tracking Purchase:",a)}))},C=(l,u=[])=>{if(typeof window>"u"||o.current.hasTrackedPageView)return;o.current.hasTrackedPageView=!0;const a=u.reduce((y,f)=>y+(f.final_price||f.price)*f.quantity,0);typeof window.fbq<"u"&&(window.fbq("track","PageView"),l===1&&u.length>0&&window.fbq("track","AddToCart",{content_ids:u.map(y=>y.id),content_type:"product",value:a,currency:"PEN",num_items:u.length})),typeof window.gtag<"u"&&(window.gtag("event","page_view",{page_title:`Checkout - Paso ${l}`,page_location:window.location.href}),l===1&&u.length>0&&window.gtag("event","view_cart",{currency:"PEN",value:a,items:u.map(y=>{var f;return{item_id:y.id,item_name:y.name,category:((f=y.category)==null?void 0:f.name)||"Sin categorÃ­a",quantity:y.quantity,price:y.final_price||y.price}})})),console.log(`âœ… Checkout PageView tracked - Step ${l}`)},g=l=>{if(typeof window>"u"||!l)return;const u=document.createElement("div");u.innerHTML=l,u.querySelectorAll("script").forEach(y=>{const f=document.createElement("script");f.textContent=y.textContent,document.head.appendChild(f),setTimeout(()=>{f.parentNode&&f.parentNode.removeChild(f)},100)})};return{trackProductView:x,trackAddToCart:i,trackInitiateCheckout:m,trackPurchase:q,trackCheckoutPageView:C,resetTracking:()=>{o.current={hasTrackedPageView:!1,hasTrackedInitiateCheckout:!1}}}};function is({cart:o,setCart:x,user:i,ubigeos:m=[],items:q,generals:C}){const[g,b]=d.useState(1),l=o.reduce((M,Y)=>M+Y.final_price*Y.quantity,0),{trackCheckoutPageView:u,trackInitiateCheckout:a,trackPurchase:y,resetTracking:f}=ft(),c=parseFloat((l/1.18).toFixed(2)),P=parseFloat((l-c).toFixed(2)),[F,U]=d.useState(0),[V,re]=d.useState(0),[ke,ee]=d.useState(null),[Q,H]=d.useState([]),[X,K]=d.useState(0),te=c+P+parseFloat(F),ce=V+X,L=Math.max(0,te-ce),[ne,G]=d.useState([]),[se,de]=d.useState([]),[me,j]=d.useState([]),[$,h]=d.useState(null);d.useEffect(()=>(u(g,o),()=>f()),[]),d.useEffect(()=>{u(g,o),g===2&&a(o,L)},[g]),d.useEffect(()=>{const M=document.createElement("script");return M.src=ie.CULQI_API,M.async=!0,M.onload=()=>{window.culqi=function(){window.Culqi.token||window.Culqi.order}},document.body.appendChild(M),()=>document.body.removeChild(M)},[]);const p=M=>{b(M),window.scrollTo({top:0,behavior:"smooth"})},_={privacy_policy:"PolÃ­ticas de privacidad",terms_conditions:"TÃ©rminos y condiciones",saleback_policy:"PolÃ­ticas de devolucion y cambio"},[T,B]=d.useState(null),W=M=>B(M),O=()=>B(null);return e.jsxs("div",{className:"min-h-screen bg-[#F7F9FB] py-4 md:py-12 px-2 sm:px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-white p-3 md:p-8 rounded-lg md:rounded-xl shadow-sm",children:[e.jsx("div",{className:"mb-4 md:mb-8",children:e.jsxs("div",{className:"flex items-center justify-between gap-1 md:gap-4 max-w-3xl mx-auto",children:[e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 ${g===1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:[e.jsx("span",{className:" bg-primary text-white w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm",children:"1"}),e.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"Carrito"})]}),e.jsx("div",{className:"mb-4 lg:mb-0  flex-1 h-[2px] bg-gray-200 relative",children:e.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:g>1?"100%":"0%"}})}),e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 ${g>1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:[e.jsx("span",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm ${g>1?"bg-primary text-white":"bg-white customtext-primary"}`,children:"2"}),e.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"EnvÃ­o"})]}),e.jsx("div",{className:"mb-4 lg:mb-0  flex-1 h-[2px] bg-gray-200 relative",children:e.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:g>2?"100%":"0%"}})}),e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 ${g===3?"customtext-primary  font-medium":"customtext-neutral-dark"}`,children:[e.jsx("span",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm ${g===3?"bg-primary text-white":"bg-white customtext-primary"}`,children:"3"}),e.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"ConfirmaciÃ³n"})]})]})}),g===1&&e.jsx(mt,{cart:o,setCart:x,onContinue:()=>p(2),subTotal:c,envio:F,igv:P,totalFinal:L,openModal:W,automaticDiscounts:Q,setAutomaticDiscounts:H,automaticDiscountTotal:X,setAutomaticDiscountTotal:K,totalWithoutDiscounts:te}),g===2&&e.jsx(xt,{items:q,setCode:de,setDelivery:j,cart:o,setSale:G,setCart:x,onContinue:()=>p(3),noContinue:()=>p(1),subTotal:c,envio:F,setEnvio:U,igv:P,totalFinal:L,user:i,ubigeos:m,openModal:W,setCouponDiscount:re,setCouponCode:ee,automaticDiscounts:Q,automaticDiscountTotal:X,totalWithoutDiscounts:te}),g===3&&e.jsx(ht,{code:se,delivery:me,cart:ne,subTotal:c,envio:F,igv:P,totalFinal:L,couponDiscount:V,couponCode:ke,automaticDiscounts:Q,automaticDiscountTotal:X,totalWithoutDiscounts:te,conversionScripts:$,setConversionScripts:h,onPurchaseComplete:(M,Y)=>{y(M,Y)}})]}),Object.keys(_).map((M,Y)=>{var z;const Ce=_[M],S=((z=C.find(_e=>_e.correlative==M))==null?void 0:z.description)??"";return e.jsx(at,{isOpen:T===Y,onRequestClose:O,contentLabel:Ce,className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[999]",ariaHideApp:!1,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 pr-4",children:Ce}),e.jsx("button",{onClick:O,className:"flex-shrink-0 text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 hover:bg-gray-100 rounded-full","aria-label":"Cerrar modal",children:e.jsx(ze,{size:24,strokeWidth:2})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"prose prose-gray max-w-none",children:e.jsx(rt,{html:S})})}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:e.jsx("button",{onClick:O,className:"px-6 py-2 bg-primary text-white rounded-lg  transition-colors duration-200 font-medium",children:"Cerrar"})})]})},Y)})]})}export{is as default};

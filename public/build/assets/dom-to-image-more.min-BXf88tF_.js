import{c as ut}from"./createLucideIcon-Cy5Ya80P.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=ut("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);console.log("ðŸ”¥ [FORCE FILTER RENDERER] Sistema radical cargado");function dt(R,p){const z=R.getContext("2d"),c=z.getImageData(0,0,R.width,R.height),H=c.data;console.log("ðŸŽ¨ [PIXEL MANIPULATION] Aplicando filtros directamente a pÃ­xeles:",p),console.log("ðŸ” [DEBUGGING] Valores exactos recibidos:",{brightness:p.brightness,contrast:p.contrast,saturation:p.saturation,hue:p.hue,tint:p.tint,opacity:p.opacity});const U=Math.max(0,Math.min(10,(p.brightness??100)/100)),k=Math.max(0,Math.min(10,(p.contrast??100)/100)),i=Math.max(0,Math.min(10,(p.saturation??100)/100)),F=(p.hue??0)%360*Math.PI/180,v=Math.max(0,Math.min(1,(p.tint??0)/100)),f=Math.max(0,Math.min(1,(p.opacity??100)/100));console.log("âš™ï¸ [NORMALIZED VALUES] Valores normalizados para aplicar:",{brightness:U,contrast:k,saturation:i,hue:F+" rad ("+(p.hue??0)+"Â°)",tint:v,opacity:f});function $(M,w,y){M/=255,w/=255,y/=255;const g=Math.max(M,w,y),O=Math.min(M,w,y);let o,D,P=(g+O)/2;if(g===O)o=D=0;else{const C=g-O;switch(D=P>.5?C/(2-g-O):C/(g+O),g){case M:o=(w-y)/C+(w<y?6:0);break;case w:o=(y-M)/C+2;break;case y:o=(M-w)/C+4;break}o/=6}return[o,D,P]}function W(M,w,y){let g,O,o;if(w===0)g=O=o=y;else{const D=(B,d,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<.16666666666666666?B+(d-B)*6*n:n<.5?d:n<.6666666666666666?B+(d-B)*(.6666666666666666-n)*6:B),P=y<.5?y*(1+w):y+w-y*w,C=2*y-P;g=D(C,P,M+1/3),O=D(C,P,M),o=D(C,P,M-1/3)}return[Math.round(g*255),Math.round(O*255),Math.round(o*255)]}for(let M=0;M<H.length;M+=4){let w=H[M],y=H[M+1],g=H[M+2],O=H[M+3];if(w=Math.min(255,Math.max(0,w*U)),y=Math.min(255,Math.max(0,y*U)),g=Math.min(255,Math.max(0,g*U)),w=Math.min(255,Math.max(0,((w/255-.5)*k+.5)*255)),y=Math.min(255,Math.max(0,((y/255-.5)*k+.5)*255)),g=Math.min(255,Math.max(0,((g/255-.5)*k+.5)*255)),i!==1||F!==0){const[o,D,P]=$(w,y,g);let C=o+F/(2*Math.PI);C>1&&(C-=1),C<0&&(C+=1);const B=Math.min(1,Math.max(0,D*i)),[d,n,s]=W(C,B,P);w=d,y=n,g=s}if(v>0){const o=.299*w+.587*y+.114*g;w=Math.min(255,o+v*100),y=Math.min(255,o+v*50),g=Math.min(255,o)}p.opacity!==void 0&&p.opacity!==100&&(O=Math.min(255,Math.max(0,O*(p.opacity/100)))),H[M]=Math.round(w),H[M+1]=Math.round(y),H[M+2]=Math.round(g),H[M+3]=Math.round(O)}z.putImageData(c,0,0),console.log("âœ… [PIXEL MANIPULATION] Filtros aplicados directamente a pÃ­xeles")}function ht(R,p,z){console.log("ðŸš€ [FORCE RENDERER] Renderizando elemento con filtros forzados:",p.id),console.log("ðŸ” [ELEMENT DEBUG] Datos completos del elemento:",{id:p.id,type:p.type,filters:p.filters,position:p.position,size:p.size});const{x:c,y:H,width:U,height:k}=z;if(p.type!=="image"||!p.content)return console.log("â© [FORCE RENDERER] Elemento no es imagen, saltando"),Promise.resolve(!1);const i=p.filters||{};console.log("ðŸŽ›ï¸ [FILTER ANALYSIS] Analizando filtros del elemento:",i);const F=i.brightness!==void 0&&i.brightness!==100&&i.brightness!==1||i.contrast!==void 0&&i.contrast!==100&&i.contrast!==1||i.saturation!==void 0&&i.saturation!==100&&i.saturation!==1||i.tint!==void 0&&i.tint!==0||i.hue!==void 0&&i.hue!==0||i.opacity!==void 0&&i.opacity!==100&&i.opacity!==1||i.blur!==void 0&&i.blur>0||i.scale!==void 0&&i.scale!==1||i.rotate!==void 0&&i.rotate!==0||i.flipHorizontal||i.flipVertical;if(console.log("ðŸ” [FILTER CHECK] Â¿Tiene filtros reales?",F),console.log("ðŸ” [FILTER DETAILS] Detalles de cada filtro (predefinidos compatible):",{brightness:`${i.brightness} (Â¿â‰ 100&â‰ 1? ${i.brightness!==100&&i.brightness!==1})`,contrast:`${i.contrast} (Â¿â‰ 100&â‰ 1? ${i.contrast!==100&&i.contrast!==1})`,saturation:`${i.saturation} (Â¿â‰ 100&â‰ 1? ${i.saturation!==100&&i.saturation!==1})`,tint:`${i.tint} (Â¿â‰ 0? ${i.tint!==0})`,hue:`${i.hue} (Â¿â‰ 0? ${i.hue!==0})`,opacity:`${i.opacity} (Â¿â‰ 100&â‰ 1? ${i.opacity!==100&&i.opacity!==1})`,detectedFormat:i.brightness>2?"percentage (0-100)":"normalized (0-1)"}),!F)return console.log("â© [FORCE RENDERER] Sin filtros reales que aplicar"),Promise.resolve(!1);console.log("ðŸŽ¯ [FORCE RENDERER] Filtros detectados, aplicando mÃ©todo radical con valores:",i);const v=new Image;return v.crossOrigin="anonymous",new Promise(f=>{v.onload=()=>{try{const $=document.createElement("canvas");$.width=U,$.height=k;const W=$.getContext("2d",{alpha:!0}),M=v.width/v.height,w=U/k;let y=0,g=0,O=v.width,o=v.height;if(M>w?(O=v.height*w,y=(v.width-O)/2):(o=v.width/w,g=(v.height-o)/2),W.drawImage(v,y,g,O,o,0,0,U,k),dt($,i),i.scale!==1||i.rotate!==0||i.flipHorizontal||i.flipVertical){const D=document.createElement("canvas");D.width=U,D.height=k;const P=D.getContext("2d",{alpha:!0});P.save(),P.translate(U/2,k/2);const C=(i.flipHorizontal?-1:1)*(i.scale||1),B=(i.flipVertical?-1:1)*(i.scale||1);P.scale(C,B),i.rotate&&P.rotate(i.rotate*Math.PI/180),P.drawImage($,-U/2,-k/2),P.restore(),R.drawImage(D,c,H)}else R.drawImage($,c,H);console.log("âœ… [FORCE RENDERER] Filtros aplicados exitosamente con manipulaciÃ³n de pÃ­xeles"),f(!0)}catch($){console.error("âŒ [FORCE RENDERER] Error aplicando filtros:",$),f(!1)}},v.onerror=()=>{console.error("âŒ [FORCE RENDERER] Error cargando imagen:",p.content),f(!1)},setTimeout(()=>{console.warn("â° [FORCE RENDERER] Timeout cargando imagen"),f(!1)},5e3),v.src=p.content})}async function ft(R,p){var f,$,W,M,w,y,g,O;console.log("ðŸ”¥ [GUARANTEED FILTERS] Generando thumbnail con filtros garantizados"),console.log("ðŸ“¥ [DATOS RECIBIDOS] Page data completa:",{pageId:R.id,totalElements:((f=R.elements)==null?void 0:f.length)||0,backgroundColor:R.backgroundColor});const z=(($=R.elements)==null?void 0:$.filter(o=>o.filters?o.filters.brightness!==void 0&&o.filters.brightness!==1||o.filters.contrast!==void 0&&o.filters.contrast!==1||o.filters.saturation!==void 0&&o.filters.saturation!==1||o.filters.tint!==void 0&&o.filters.tint!==0||o.filters.hue!==void 0&&o.filters.hue!==0||o.filters.opacity!==void 0&&o.filters.opacity!==1||o.filters.blur!==void 0&&o.filters.blur!==0||o.filters.scale!==void 0&&o.filters.scale!==1||o.filters.rotate!==void 0&&o.filters.rotate!==0||o.filters.flipHorizontal||o.filters.flipVertical:!1))||[];console.log("ðŸŽ¨ [FILTROS ENCONTRADOS] Elementos con filtros reales:",z.map(o=>({id:o.id,type:o.type,exactFilters:{brightness:`${o.filters.brightness} (tipo: ${typeof o.filters.brightness})`,contrast:`${o.filters.contrast} (tipo: ${typeof o.filters.contrast})`,saturation:`${o.filters.saturation} (tipo: ${typeof o.filters.saturation})`,tint:`${o.filters.tint} (tipo: ${typeof o.filters.tint})`,hue:`${o.filters.hue} (tipo: ${typeof o.filters.hue})`,opacity:`${o.filters.opacity} (tipo: ${typeof o.filters.opacity})`,blur:`${o.filters.blur} (tipo: ${typeof o.filters.blur})`,scale:`${o.filters.scale} (tipo: ${typeof o.filters.scale})`,rotate:`${o.filters.rotate} (tipo: ${typeof o.filters.rotate})`,flipHorizontal:o.filters.flipHorizontal,flipVertical:o.filters.flipVertical}})));const H=300/Math.max(p.width,p.height),U=Math.round(p.width*H),k=Math.round(p.height*H),i=document.createElement("canvas");i.width=U,i.height=k;const F=i.getContext("2d",{alpha:!0});if(F.fillStyle=R.backgroundColor||"#ffffff",F.fillRect(0,0,i.width,i.height),R.backgroundImage)try{const o=new Image;o.crossOrigin="anonymous",await new Promise(D=>{o.onload=()=>{F.drawImage(o,0,0,i.width,i.height),D()},o.onerror=D,o.src=R.backgroundImage})}catch(o){console.warn("âš ï¸ Error cargando imagen de fondo:",o)}if(R.cells&&R.cells.length>0){const o=Math.ceil(Math.sqrt(R.cells.length)),D=i.width/o,P=i.height/Math.ceil(R.cells.length/o);for(let C=0;C<Math.min(R.cells.length,9);C++){const B=R.cells[C],d=C%o,n=Math.floor(C/o),s=d*D,E=n*P;if(B.elements){const m=B.elements.filter(t=>t.type==="image"&&t.content),h=B.elements.filter(t=>t.type==="text"&&t.content);for(const t of m.slice(0,2)){const e={x:s+(((W=t.position)==null?void 0:W.x)||0)*D,y:E+(((M=t.position)==null?void 0:M.y)||0)*P,width:(((w=t.size)==null?void 0:w.width)||1)*D,height:(((y=t.size)==null?void 0:y.height)||1)*P};if(!await ht(F,t,e)){console.log("ðŸ”„ [FALLBACK] Usando mÃ©todo estÃ¡ndar para imagen sin filtros especiales");try{const r=new Image;r.crossOrigin="anonymous",await new Promise(l=>{r.onload=()=>{const I=r.width/r.height,N=e.width/e.height;let T=0,S=0,b=r.width,L=r.height;I>N?(b=r.height*N,T=(r.width-b)/2):(L=r.width/N,S=(r.height-L)/2),F.drawImage(r,T,S,b,L,e.x,e.y,e.width,e.height),l()},r.onerror=l,r.src=t.content})}catch(r){console.warn("âš ï¸ Error renderizando imagen fallback:",r)}}}for(const t of h.slice(0,1))try{const e=t.style||{},a=Math.max(8,parseInt(e.fontSize)||14),r=e.color||"#000000";F.save(),F.font=`${a}px Arial, sans-serif`,F.fillStyle=r,F.textBaseline="top";let l=t.content.split(`
`)[0]||"";l.length>30&&(l=l.substring(0,30)+"...");const I=s+(((g=t.position)==null?void 0:g.x)||0)*D+4,N=E+(((O=t.position)==null?void 0:O.y)||0)*P+4;F.fillText(l,I,N),F.restore()}catch(e){console.warn("âš ï¸ Error renderizando texto:",e)}}}}const v=i.toDataURL("image/jpeg",.85);return console.log("âœ… [GUARANTEED FILTERS] Thumbnail generado con filtros garantizados"),v}window.forceRegenerateWithGuaranteedFilters=async function(){console.log("ðŸš€ [GLOBAL FORCE] Regenerando con filtros garantizados");try{const R=window._currentPageData,p=window._workspaceDimensions;if(!R||!p)return console.error("âŒ [GLOBAL FORCE] Datos de pÃ¡gina no disponibles"),!1;const z=await ft(R,p);return window._updateThumbnailInUI&&window._updateThumbnailInUI(R.id,z),console.log("âœ… [GLOBAL FORCE] Thumbnail regenerado con Ã©xito"),!0}catch(R){return console.error("âŒ [GLOBAL FORCE] Error:",R),!1}};console.log("ðŸ”¥ [FORCE FILTER RENDERER] Sistema listo - Usa window.forceRegenerateWithGuaranteedFilters()");var Z={exports:{}};/*! dom-to-image-more 08-05-2025 */var mt=Z.exports,et;function pt(){return et||(et=1,function(R,p){(z=>{let c=(()=>{let d=0;return{escape:function(t){return t.replace(/([.*+?^${}()|[\]/\\])/g,"\\$1")},isDataUrl:function(t){return t.search(/^(data:)/)!==-1},canvasToBlob:function(t){return t.toBlob?new Promise(function(e){t.toBlob(e)}):(e=>new Promise(function(a){var r=M(e.toDataURL().split(",")[1]),l=r.length,I=new Uint8Array(l);for(let N=0;N<l;N++)I[N]=r.charCodeAt(N);a(new Blob([I],{type:"image/png"}))}))(t)},resolveUrl:function(t,e){var a=document.implementation.createHTMLDocument(),r=a.createElement("base"),l=(a.head.appendChild(r),a.createElement("a"));return a.body.appendChild(l),r.href=e,l.href=t,l.href},getAndEncode:function(t){let e=f.impl.urlCache.find(function(a){return a.url===t});return e||(e={url:t,promise:null},f.impl.urlCache.push(e)),e.promise===null&&(f.impl.options.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime()),e.promise=new Promise(function(a){let r=f.impl.options.httpTimeout,l=new XMLHttpRequest;if(l.onreadystatechange=function(){if(l.readyState===4)if(300<=l.status)N?a(N):T(`cannot fetch resource: ${t}, status: `+l.status);else{let S=new FileReader;S.onloadend=function(){a(S.result)},S.readAsDataURL(l.response)}},l.ontimeout=function(){N?a(N):T(`timeout of ${r}ms occured while fetching resource: `+t)},l.responseType="blob",l.timeout=r,0<f.impl.options.useCredentialsFilters.length&&(f.impl.options.useCredentials=0<f.impl.options.useCredentialsFilters.filter(S=>0<=t.search(S)).length),f.impl.options.useCredentials&&(l.withCredentials=!0),f.impl.options.corsImg&&t.indexOf("http")===0&&t.indexOf(window.location.origin)===-1){var I=(f.impl.options.corsImg.method||"GET").toUpperCase()==="POST"?"POST":"GET";l.open(I,(f.impl.options.corsImg.url||"").replace("#{cors}",t),!0);let S=!1,b=f.impl.options.corsImg.headers||{},L=(Object.keys(b).forEach(function(u){b[u].indexOf("application/json")!==-1&&(S=!0),l.setRequestHeader(u,b[u])}),(u=>{try{return JSON.parse(JSON.stringify(u))}catch(G){T("corsImg.data is missing or invalid:"+G.toString())}})(f.impl.options.corsImg.data||""));Object.keys(L).forEach(function(u){typeof L[u]=="string"&&(L[u]=L[u].replace("#{cors}",t))}),l.send(S?JSON.stringify(L):L)}else l.open("GET",t,!0),l.send();let N;function T(S){console.error(S),a("")}f.impl.options.imagePlaceholder&&(I=f.impl.options.imagePlaceholder.split(/,/))&&I[1]&&(N=I[1])})),e.promise},uid:function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+d++},delay:function(t){return function(e){return new Promise(function(a){setTimeout(function(){a(e)},t)})}},asArray:function(t){var e=[],a=t.length;for(let r=0;r<a;r++)e.push(t[r]);return e},escapeXhtml:function(t){return t.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(t){return t!=="data:,"?new Promise(function(e,a){let r=document.createElementNS("http://www.w3.org/2000/svg","svg"),l=new Image;f.impl.options.useCredentials&&(l.crossOrigin="use-credentials"),l.onload=function(){document.body.removeChild(r),window&&window.requestAnimationFrame?window.requestAnimationFrame(function(){e(l)}):e(l)},l.onerror=I=>{document.body.removeChild(r),a(I)},r.appendChild(l),l.src=t,document.body.appendChild(r)}):Promise.resolve()},width:function(t){var e=h(t,"width");if(!isNaN(e))return e;var e=h(t,"border-left-width"),a=h(t,"border-right-width");return t.scrollWidth+e+a},height:function(t){var e=h(t,"height");if(!isNaN(e))return e;var e=h(t,"border-top-width"),a=h(t,"border-bottom-width");return t.scrollHeight+e+a},getWindow:n,isElement:m,isElementHostForOpenShadowRoot:function(t){return m(t)&&t.shadowRoot!==null},isShadowRoot:s,isInShadowRoot:E,isHTMLElement:function(t){return t instanceof n(t).HTMLElement},isHTMLCanvasElement:function(t){return t instanceof n(t).HTMLCanvasElement},isHTMLInputElement:function(t){return t instanceof n(t).HTMLInputElement},isHTMLImageElement:function(t){return t instanceof n(t).HTMLImageElement},isHTMLLinkElement:function(t){return t instanceof n(t).HTMLLinkElement},isHTMLScriptElement:function(t){return t instanceof n(t).HTMLScriptElement},isHTMLStyleElement:function(t){return t instanceof n(t).HTMLStyleElement},isHTMLTextAreaElement:function(t){return t instanceof n(t).HTMLTextAreaElement},isShadowSlotElement:function(t){return E(t)&&t instanceof n(t).HTMLSlotElement},isSVGElement:function(t){return t instanceof n(t).SVGElement},isSVGRectElement:function(t){return t instanceof n(t).SVGRectElement},isDimensionMissing:function(t){return isNaN(t)||t<=0}};function n(t){return t=t?t.ownerDocument:void 0,(t?t.defaultView:void 0)||window||z}function s(t){return t instanceof n(t).ShadowRoot}function E(t){return t!=null&&t.getRootNode!==void 0&&s(t.getRootNode())}function m(t){return t instanceof n(t).Element}function h(t,e){if(t.nodeType===$){let a=W(t).getPropertyValue(e);if(a.slice(-2)==="px")return a=a.slice(0,-2),parseFloat(a)}return NaN}})(),H=(()=>{let d=/url\((["']?)((?:\\?.)*?)\1\)/gm;return{inlineAll:function(h,t,e){return n(h)?Promise.resolve(h).then(s).then(function(a){let r=Promise.resolve(h);return a.forEach(function(l){r=r.then(function(I){return m(I,l,t,e)})}),r}):Promise.resolve(h)},shouldProcess:n,impl:{readUrls:s,inline:m,urlAsRegex:E}};function n(h){return h.search(d)!==-1}function s(h){for(var t,e=[];(t=d.exec(h))!==null;)e.push(t[2]);return e.filter(function(a){return!c.isDataUrl(a)})}function E(h){return new RegExp(`url\\((["']?)(${c.escape(h)})\\1\\)`,"gm")}function m(h,t,e,a){return Promise.resolve(t).then(function(r){return e?c.resolveUrl(r,e):r}).then(a||c.getAndEncode).then(function(r){var l=E(t);return h.replace(l,`url($1${r}$1)`)})}})(),U={resolveAll:function(){return k().then(function(d){return Promise.all(d.map(function(n){return n.resolve()}))}).then(function(d){return d.join(`
`)})},impl:{readAll:k}};function k(){return Promise.resolve(c.asArray(document.styleSheets)).then(function(n){let s=[];return n.forEach(function(E){var m=Object.getPrototypeOf(E);if(Object.prototype.hasOwnProperty.call(m,"cssRules"))try{c.asArray(E.cssRules||[]).forEach(s.push.bind(s))}catch(h){console.error("domtoimage: Error while reading CSS rules from "+E.href,h.toString())}}),s}).then(function(n){return n.filter(function(s){return s.type===CSSRule.FONT_FACE_RULE}).filter(function(s){return H.shouldProcess(s.style.getPropertyValue("src"))})}).then(function(n){return n.map(d)});function d(n){return{resolve:function(){var s=(n.parentStyleSheet||{}).href;return H.inlineAll(n.cssText,s)},src:function(){return n.style.getPropertyValue("src")}}}}let i={inlineAll:function d(n){if(!c.isElement(n))return Promise.resolve(n);return s(n).then(function(){return c.isHTMLImageElement(n)?F(n).inline():Promise.all(c.asArray(n.childNodes).map(function(E){return d(E)}))});function s(E){let m=["background","background-image"],h=m.map(function(t){let e=E.style.getPropertyValue(t),a=E.style.getPropertyPriority(t);return e?H.inlineAll(e).then(function(r){E.style.setProperty(t,r,a)}):Promise.resolve()});return Promise.all(h).then(function(){return E})}},impl:{newImage:F}};function F(d){return{inline:function(n){return c.isDataUrl(d.src)?Promise.resolve():Promise.resolve(d.src).then(n||c.getAndEncode).then(function(s){return new Promise(function(E){d.onload=E,d.onerror=E,d.src=s})})}}}let v={copyDefaultStyles:!0,imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1,useCredentialsFilters:[],httpTimeout:3e4,styleCaching:"strict",corsImg:void 0},f={toSvg:w,toPng:function(d,n){return y(d,n).then(function(s){return s.toDataURL()})},toJpeg:function(d,n){return y(d,n).then(function(s){return s.toDataURL("image/jpeg",(n?n.quality:void 0)||1)})},toBlob:function(d,n){return y(d,n).then(c.canvasToBlob)},toPixelData:function(d,n){return y(d,n).then(function(s){return s.getContext("2d").getImageData(0,0,c.width(d),c.height(d)).data})},toCanvas:y,impl:{fontFaces:U,images:i,util:c,inliner:H,urlCache:[],options:{}}},$=(R.exports=f,(typeof Node<"u"?Node.ELEMENT_NODE:void 0)||1),W=(z!==void 0?z.getComputedStyle:void 0)||(typeof window<"u"?window.getComputedStyle:void 0)||globalThis.getComputedStyle,M=(z!==void 0?z.atob:void 0)||(typeof window<"u"?window.atob:void 0)||globalThis.atob;function w(d,n){f.impl.util.getWindow(d);var s=n=n||{};s.copyDefaultStyles===void 0?f.impl.options.copyDefaultStyles=v.copyDefaultStyles:f.impl.options.copyDefaultStyles=s.copyDefaultStyles,f.impl.options.imagePlaceholder=(s.imagePlaceholder===void 0?v:s).imagePlaceholder,f.impl.options.cacheBust=(s.cacheBust===void 0?v:s).cacheBust,f.impl.options.corsImg=(s.corsImg===void 0?v:s).corsImg,f.impl.options.useCredentials=(s.useCredentials===void 0?v:s).useCredentials,f.impl.options.useCredentialsFilters=(s.useCredentialsFilters===void 0?v:s).useCredentialsFilters,f.impl.options.httpTimeout=(s.httpTimeout===void 0?v:s).httpTimeout,f.impl.options.styleCaching=(s.styleCaching===void 0?v:s).styleCaching;let E=[];return Promise.resolve(d).then(function(m){if(m.nodeType===$)return m;var h=m,t=m.parentNode,e=document.createElement("span");return t.replaceChild(e,h),e.append(m),E.push({parent:t,child:h,wrapper:e}),e}).then(function(m){return function h(t,e,a,r){let l=e.filter;if(t===g||c.isHTMLScriptElement(t)||c.isHTMLStyleElement(t)||c.isHTMLLinkElement(t)||a!==null&&l&&!l(t))return Promise.resolve();return Promise.resolve(t).then(I).then(N).then(function(u){return b(u,S(t))}).then(T).then(function(u){return L(u,t)});function I(u){return c.isHTMLCanvasElement(u)?c.makeImage(u.toDataURL()):u.cloneNode(!1)}function N(u){return e.adjustClonedNode&&e.adjustClonedNode(t,u,!1),Promise.resolve(u)}function T(u){return e.adjustClonedNode&&e.adjustClonedNode(t,u,!0),Promise.resolve(u)}function S(u){return c.isElementHostForOpenShadowRoot(u)?u.shadowRoot:u}function b(u,G){let Y=K(G),_=Promise.resolve();if(Y.length!==0){let V=W(X(G));c.asArray(Y).forEach(function(j){_=_.then(function(){return h(j,e,V).then(function(A){A&&u.appendChild(A)})})})}return _.then(function(){return u});function X(V){return c.isShadowRoot(V)?V.host:V}function K(V){if(c.isShadowSlotElement(V)){let j=V.assignedNodes();if(j&&0<j.length)return j}return V.childNodes}}function L(u,G){return!c.isElement(u)||c.isShadowSlotElement(G)?Promise.resolve(u):Promise.resolve().then(Y).then(_).then(X).then(K).then(function(){return u});function Y(){function V(A,x){x.font=A.font,x.fontFamily=A.fontFamily,x.fontFeatureSettings=A.fontFeatureSettings,x.fontKerning=A.fontKerning,x.fontSize=A.fontSize,x.fontStretch=A.fontStretch,x.fontStyle=A.fontStyle,x.fontVariant=A.fontVariant,x.fontVariantCaps=A.fontVariantCaps,x.fontVariantEastAsian=A.fontVariantEastAsian,x.fontVariantLigatures=A.fontVariantLigatures,x.fontVariantNumeric=A.fontVariantNumeric,x.fontVariationSettings=A.fontVariationSettings,x.fontWeight=A.fontWeight}function j(A,x){let q=W(A);q.cssText?(x.style.cssText=q.cssText,V(q,x.style)):(D(e,A,q,a,x),a===null&&(["inset-block","inset-block-start","inset-block-end"].forEach(J=>x.style.removeProperty(J)),["left","right","top","bottom"].forEach(J=>{x.style.getPropertyValue(J)&&x.style.setProperty(J,"0px")})))}j(G,u)}function _(){let V=c.uid();function j(A){let x=W(G,A),q=x.getPropertyValue("content");if(q!==""&&q!=="none"){let nt=function(){let ot=`.${V}:`+A,it=(x.cssText?rt:at)();return document.createTextNode(ot+`{${it}}`);function rt(){return`${x.cssText} content: ${q};`}function at(){return c.asArray(x).map(st).join("; ")+";";function st(Q){let lt=x.getPropertyValue(Q),ct=x.getPropertyPriority(Q)?" !important":"";return Q+": "+lt+ct}}},J=u.getAttribute("class")||"",tt=(u.setAttribute("class",J+" "+V),document.createElement("style"));tt.appendChild(nt()),u.appendChild(tt)}}[":before",":after"].forEach(function(A){j(A)})}function X(){c.isHTMLTextAreaElement(G)&&(u.innerHTML=G.value),c.isHTMLInputElement(G)&&u.setAttribute("value",G.value)}function K(){c.isSVGElement(u)&&(u.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.isSVGRectElement(u))&&["width","height"].forEach(function(V){let j=u.getAttribute(V);j&&u.style.setProperty(V,j)})}}}(m,n,null)}).then(n.disableEmbedFonts?Promise.resolve(d):O).then(o).then(function(m){n.bgcolor&&(m.style.backgroundColor=n.bgcolor),n.width&&(m.style.width=n.width+"px"),n.height&&(m.style.height=n.height+"px"),n.style&&Object.keys(n.style).forEach(function(t){m.style[t]=n.style[t]});let h=null;return typeof n.onclone=="function"&&(h=n.onclone(m)),Promise.resolve(h).then(function(){return m})}).then(function(m){let h=n.width||c.width(m),t=n.height||c.height(m);return Promise.resolve(m).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(e)}).then(c.escapeXhtml).then(function(e){var a=(c.isDimensionMissing(h)?' width="100%"':` width="${h}"`)+(c.isDimensionMissing(t)?' height="100%"':` height="${t}"`);return`<svg xmlns="http://www.w3.org/2000/svg"${(c.isDimensionMissing(h)?"":` width="${h}"`)+(c.isDimensionMissing(t)?"":` height="${t}"`)}><foreignObject${a}>${e}</foreignObject></svg>`}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})}).then(function(m){for(;0<E.length;){var h=E.pop();h.parent.replaceChild(h.child,h.wrapper)}return m}).then(function(m){return f.impl.urlCache=[],g&&(document.body.removeChild(g),g=null),P&&clearTimeout(P),P=setTimeout(()=>{P=null,C={}},2e4),m})}function y(d,n){return w(d,n=n||{}).then(c.makeImage).then(function(s){var E=typeof n.scale!="number"?1:n.scale,m=((t,e)=>{let a=n.width||c.width(t),r=n.height||c.height(t);return c.isDimensionMissing(a)&&(a=c.isDimensionMissing(r)?300:2*r),c.isDimensionMissing(r)&&(r=a/2),(t=document.createElement("canvas")).width=a*e,t.height=r*e,n.bgcolor&&((e=t.getContext("2d")).fillStyle=n.bgcolor,e.fillRect(0,0,t.width,t.height)),t})(d,E),h=m.getContext("2d");return h.msImageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1,s&&(h.scale(E,E),h.drawImage(s,0,0)),m})}let g=null;function O(d){return U.resolveAll().then(function(n){var s;return n!==""&&(s=document.createElement("style"),d.appendChild(s),s.appendChild(document.createTextNode(n))),d})}function o(d){return i.inlineAll(d).then(function(){return d})}function D(d,n,s,E,m){let h=f.impl.options.copyDefaultStyles?((e,a)=>{var r,l=(T=>(e.styleCaching!=="relaxed"?T:T.filter((S,b,L)=>b===0||b===L.length-1)).join(">"))(a=(T=>{var S=[];do if(T.nodeType===$){var b=T.tagName;if(S.push(b),B.includes(b))break}while(T=T.parentNode);return S})(a));{if(C[l])return C[l];a=((T,S)=>{let b=T.body;do{var L=S.pop(),L=T.createElement(L);b.appendChild(L),b=L}while(0<S.length);return b.textContent="â€‹",b})((r=(()=>{if(g)return g.contentWindow;S=document.characterSet||"UTF-8",T=(T=document.doctype)?(`<!DOCTYPE ${_(T.name)} ${_(T.publicId)} `+_(T.systemId)).trim()+">":"",(g=document.createElement("iframe")).id="domtoimage-sandbox-"+c.uid(),g.style.visibility="hidden",g.style.position="fixed",document.body.appendChild(g);var T,S,b=g,L="domtoimage-sandbox";try{return b.contentWindow.document.write(T+`<html><head><meta charset='${S}'><title>${L}</title></head><body></body></html>`),b.contentWindow}catch{}var u=document.createElement("meta");u.setAttribute("charset",S);try{var G=document.implementation.createHTMLDocument(L),Y=(G.head.appendChild(u),T+G.documentElement.outerHTML);return b.setAttribute("srcdoc",Y),b.contentWindow}catch{}return b.contentDocument.head.appendChild(u),b.contentDocument.title=L,b.contentWindow;function _(X){var K;return X?((K=document.createElement("div")).innerText=X,K.innerHTML):""}})()).document,a),r=((T,S)=>{let b={},L=T.getComputedStyle(S);return c.asArray(L).forEach(function(u){b[u]=u==="width"||u==="height"?"auto":L.getPropertyValue(u)}),b})(r,a);var I=a;do{var N=I.parentElement;N!==null&&N.removeChild(I),I=N}while(I&&I.tagName!=="BODY");return C[l]=r}})(d,n):{},t=m.style;c.asArray(s).forEach(function(e){var a,r,l,I;d.filterStyles&&!d.filterStyles(n,e)||(r=s.getPropertyValue(e),l=h[e],a=E?E.getPropertyValue(e):void 0,t.getPropertyValue(e))||(r!==l||E&&r!==a)&&(l=s.getPropertyPriority(e),a=t,r=r,l=l,I=0<=["background-clip"].indexOf(e=e),l?(a.setProperty(e,r,l),I&&a.setProperty("-webkit-"+e,r,l)):(a.setProperty(e,r),I&&a.setProperty("-webkit-"+e,r)))})}let P=null,C={},B=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","SVG","TABLE","UL","math","svg","BODY","HEAD","HTML"]})(mt)}(Z)),Z.exports}pt();export{Et as B,ft as g};

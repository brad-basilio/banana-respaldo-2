import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r}from"./index-BH53Isel.js";import T from"./MenuSimple-DP7EeDlC.js";import{X as $}from"./x-DBMwyD6F.js";import{S as L}from"./search-TwiiKGP5.js";import{C as U}from"./chevron-left-B2s3ZsB7.js";import{C as v}from"./chevron-right-Ckt5D2ka.js";import{C as B}from"./door-closed-Z4GbcMb-.js";function G({search:i,setSearch:u,pages:d,items:x,onClose:o,startFromCategories:l=!1}){const[a,c]=r.useState(l?"categories":"main"),[f,p]=r.useState(null),[w,h]=r.useState(null),[m,b]=r.useState([]),[j,N]=r.useState("right"),S=r.useRef(null),C=t=>{if(t.preventDefault(),i.trim()){const s=i.trim();window.location.href=`/catalogo?search=${encodeURIComponent(s)}`}return!1},k=t=>{if(t.key==="Enter"&&(t.preventDefault(),i.trim())){const s=i.trim();window.location.href=`/catalogo?search=${encodeURIComponent(s)}`}},g=(t,s="right",n=null)=>{N(s),n&&p(n),setTimeout(()=>{c(t)},50)},I=t=>{t.subcategories&&t.subcategories.length>0?(h(t.name),b([...m,{level:a,name:"Categorías"}]),g("subcategories","right",t.name)):window.location.href=`/catalogo?category=${t.slug}`},M=()=>{if(m.length>0){const t=m[m.length-1];g(t.level,"left"),b(m.slice(0,-1))}else a==="subcategories"?g("categories","left"):a==="categories"&&!l&&g("main","left")},E=t=>{g("categories","right")},D=()=>a==="categories"?"Categorías":a==="subcategories"?f||"Subcategorías":"Menú principal",R=()=>{if(a==="main")return e.jsxs("div",{className:"animate-fade animate-duration-300",children:[e.jsxs("button",{className:"px-4 py-2 mb-3 w-full flex justify-between items-center hover:bg-gray-50 active:bg-primary transition-all  rounded-xl",onClick:()=>E(),children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"font-medium",children:"Categorías"})}),e.jsx(v,{className:"h-5 w-5 customtext-neutral-light"})]}),d&&d.length>0&&e.jsx("div",{className:"space-y-2",children:d.map((t,s)=>t.menuable&&e.jsx("a",{href:t.path,className:"p-4 py-2 flex justify-between items-center w-full hover:bg-gray-50 active:bg-primary transition-all  rounded-xl",children:e.jsx("span",{className:"font-medium",children:t.name})},s))})]});if(a==="categories"){const t=[...x].sort((s,n)=>s.name.localeCompare(n.name,"es",{sensitivity:"base"}));return e.jsx("div",{className:j==="right"?"animate-fade-left animate-duration-300":"animate-fade-right animate-duration-300",children:e.jsx("div",{className:"space-y-2",children:t.map(s=>{const n=s.subcategories&&s.subcategories.length>0;return e.jsxs("div",{className:"px-4 py-2 rounded-xl flex justify-between items-center cursor-pointer hover:bg-gray-50 transition-all",onClick:()=>I(s),children:[e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"font-medium",children:s.name})}),n?e.jsx(v,{className:"h-5 w-5 customtext-neutral-light"}):e.jsx(e.Fragment,{})]},s.id)})})})}else if(a==="subcategories"&&f){const t=x.find(n=>n.name===f),s=t.subcategories?[...t.subcategories].sort((n,y)=>n.name.localeCompare(y.name,"es",{sensitivity:"base"})):[];return e.jsx("div",{className:j==="right"?"animate-fade-left animate-duration-300":"animate-fade-right animate-duration-300",children:e.jsx("div",{className:"space-y-2",children:s.map((n,y)=>e.jsxs("a",{href:`/catalogo?subcategory=${n.slug}`,className:"flex w-full px-4  py-2 rounded-xl justify-between items-center hover:bg-gray-50 active:bg-primary transition-all",children:[e.jsx("span",{className:"font-medium",children:n.name}),e.jsx(v,{className:"h-5 w-5 customtext-neutral-light"})]},y))})})}};return r.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]),r.useEffect(()=>{const t=s=>{s.key==="Escape"&&(i.trim()?u(""):o())};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[i,o,u]),e.jsxs("div",{className:"fixed inset-0 z-[99999] flex flex-col touch-none overscroll-none",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:o}),e.jsx("div",{className:"relative w-full md:w-[400px] md:mx-auto flex flex-col h-[100dvh]  ",children:e.jsxs("div",{className:"mt-auto bg-white  shadow-xl flex flex-col max-h-[80vh] rounded-t-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-white flex justify-between items-center border-b border-gray-200 sticky top-0 z-[9999]",children:[e.jsx("h1",{className:"text-lg font-bold",children:D()}),e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",onClick:o,children:e.jsx($,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-4 overscroll-contain",children:[e.jsx("div",{className:"mb-5",children:e.jsxs("form",{onSubmit:C,role:"search",className:"relative w-full",children:[e.jsx("input",{ref:S,type:"search",name:"search",placeholder:"Buscar productos",value:i,onChange:t=>u(t.target.value),onKeyDown:k,className:"w-full pr-12 py-3 pl-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary/20 focus:outline-none",enterKeyHint:"search",inputMode:"search",autoComplete:"off",role:"searchbox","aria-label":"Buscar productos"}),e.jsx("button",{type:"submit",className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors","aria-label":"Buscar",children:e.jsx(L,{className:"h-4 w-4"})})]})}),a!=="main"&&!l||l&&a==="subcategories"?e.jsxs("button",{onClick:M,className:"flex items-center customtext-primary mb-4 font-medium",children:[e.jsx(U,{className:"h-5 w-5 mr-1"}),e.jsx("span",{children:a==="categories"?"Menú principal":"Categorías"})]}):null,e.jsx("div",{className:"pb-16",children:R()}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0  flex justify-center",children:e.jsx(T,{visible:!0})})]})]})})]})}const J=({uuid:i,name:u,lastname:d,className:x})=>{const[o,l]=r.useState(!1),[a,c]=r.useState(!1),[f,p]=r.useState("");return r.useEffect(()=>{if(!i){l(!0);return}(async()=>{try{const h=`/api/profile/thumbnail/${i}?v=${new Date().getTime()}`;(await fetch(h,{method:"HEAD"})).headers.get("content-type").includes("svg")?c(!1):(p(h),c(!0))}catch{c(!1)}finally{l(!0)}})()},[i]),o?e.jsx(e.Fragment,{children:a?e.jsx("img",{src:f,alt:`${u} ${d}`,className:x,onError:()=>c(!1)}):e.jsx(B,{className:" !w-7 !h-7 customtext-primary border-primary rounded-full ring-secondary transition-all duration-300"})}):e.jsx("div",{className:"!w-7 !h-7  bg-secondary rounded-full animate-pulse flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})})};export{G as M,J as P};

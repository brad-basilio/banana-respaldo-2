import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as l}from"./index-BH53Isel.js";import{u as B,S as J}from"./useStateManager-7e1e8489.esm-dhRwRSin.js";import{_ as L}from"./objectWithoutPropertiesLoose-CoVnHxV7.js";import"./index-rimy3MAc.js";import{I as $}from"./ItemsRest-Cez3tX8T.js";import{F}from"./FilterPagination-DCLrjB48.js";import{A as k}from"./ArrayJoin-2k6ba35P.js";import{P as M}from"./ProductCard-D_FxZn1Y.js";import"./index-yBjzXJbu.js";import"./objectSpread2-8ZRf701l.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-fNjTmf9T.js";import"./main-6DCdASTx.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./BasicRest-DXMDQ7uA.js";import"./index-BZYhE2TF.js";import"./Number2Currency-e57Tgsuk.js";import"./tippy-react.esm-BWiGTO87.js";import"./ProductCard-CRhBSmWZ.js";var z=l.forwardRef(function(s,o){var n=B(s);return l.createElement(J,L({ref:o},n))}),D=z;const G=new $,v=({summary:s,keyName:o,field:n,otherField:p,title:b,onChange:N,filter:a})=>{var u;if((s[o]??[]).length==0)return;const d=a.find(i=>i.field==n);return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-2"}),e.jsxs("div",{children:[e.jsx("b",{className:"mb-1 block",children:b}),e.jsx("div",{className:"flex flex-wrap gap-x-2 gap-y-1",children:(u=s[o])==null?void 0:u.map((i,m)=>{var g;const y=(g=d==null?void 0:d.values)==null?void 0:g.includes(i.id);return e.jsxs("label",{className:"cursor-pointer border rounded-lg py-1 px-2 text-sm",children:[e.jsx("input",{className:"me-1 cursor-pointer",type:"checkbox",name:n,value:i.id,"other-field":p,"other-field-value":i[p],onChange:N,checked:y}),e.jsx("span",{children:i.name})]},m)})})]})]})},ge=({data:s,category:o,subcategory:n,cart:p,setCart:b})=>{const N=["category_id","subcategory_id","brand_id","item_tag.tag_id"],[a,d]=l.useState(N.map(r=>{const t=[];return r=="category_id"&&o&&t.push(o.id),r=="subcategory_id"&&n&&t.push(n.id),{field:r,values:t}})),[u,i]=l.useState([]),[m,y]=l.useState({value:"asc",label:e.jsxs(e.Fragment,{children:["Menor a mayor ",e.jsx("i",{className:"mdi mdi-arrow-up"})]})}),[g,P]=l.useState(0),[w,I]=l.useState(1),[x,S]=l.useState(1),[h,A]=l.useState({}),[E,_]=l.useState(!1);l.useEffect(()=>{R()},[a,m,x]);const f=({target:r})=>{const t=r.name,j=r.value,C=r.checked,T=r.getAttribute("other-field"),O=r.getAttribute("other-field-value");d(V=>V.map(c=>(c.field==t&&(C?c.values.push(j):c.values=c.values.filter(q=>q!=j)),c.field==T&&C&&c.values.push(O),c)))},R=async()=>{_(!0),i([]);const r=await G.paginate({filter:k(a.map(t=>{if(t.values.length!=0)return k(t.values.map(j=>[t.field,"=",j]),"or")}).filter(Boolean),"and"),take:12,skip:12*(x-1),requireTotalCount:!0,sort:[{selector:"final_price",desc:m.value=="desc"},{selector:"discount_percent",desc:m.value!="desc"}]});r.status&&(i(r.data??[]),P(r.totalCount),I(Math.ceil(r.totalCount/12)),A(r.summary),_(!1))};return e.jsx("section",{className:"bg-white",children:e.jsxs("div",{className:"px-[5%] replace-max-w-here w-full mx-auto px-4 py-[5%] md:py-[2.5%]",children:[((s==null?void 0:s.title)||(s==null?void 0:s.description))&&e.jsxs("div",{className:"mb-[2%]",children:[(s==null?void 0:s.title)&&e.jsx("h1",{className:"text-2xl font-bold mb-[2%]",children:s==null?void 0:s.title}),(s==null?void 0:s.description)&&e.jsx("p",{className:"text-sm mb-[3%]",children:s==null?void 0:s.description})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"shadow-lg border h-max sticky top-4 p-4 rounded-3xl",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Filtros de items"}),e.jsx(v,{filter:a,keyName:"categories",title:"Categoria",field:"category_id",summary:h,onChange:f}),e.jsx(v,{filter:a,keyName:"subcategories",title:"Subcategoria",field:"subcategory_id",otherField:"category_id",summary:h,onChange:f}),e.jsx(v,{filter:a,keyName:"brands",title:"Marca",field:"brand_id",summary:h,onChange:f}),e.jsx(v,{filter:a,keyName:"tags",title:"Tags",field:"item_tag.tag_id",summary:h,onChange:f}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{children:[e.jsx("b",{className:"mb-1 block",children:"Ordenar precio"}),e.jsx(D,{className:"text-sm",options:[{value:"asc",label:e.jsxs(e.Fragment,{children:["Menor a mayor"," ",e.jsx("i",{className:"mdi mdi-arrow-up"})]})},{value:"desc",label:e.jsxs(e.Fragment,{children:["Mayor a menor"," ",e.jsx("i",{className:"mdi mdi-arrow-down"})]})}],defaultValue:m,onChange:r=>y(r)})]})]})}),e.jsxs("div",{className:"w-full md:col-span-2 lg:col-span-3",children:[e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5 mb-[2.5%] items-center justify-between",children:[e.jsxs("div",{className:"",children:["Mostrando ",e.jsx("b",{children:u.length})," items de"," ",e.jsx("b",{children:g})]}),e.jsxs("div",{className:"lg:col-span-2 flex justify-between w-full",children:[e.jsx("div",{className:"mx-auto"}),e.jsx(F,{pages:w,current:x,setCurrent:S})]})]}),e.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[u.map((r,t)=>e.jsx(M,{data:s,item:r,cart:p,setCart:b},t)),E&&[null,null,null].map(r=>e.jsx(M,{}))]}),e.jsx("div",{className:"mt-[5%] w-max max-w-full mx-auto",children:e.jsx(F,{pages:w,current:x,setCurrent:S})})]})]})]})})};export{ge as default};

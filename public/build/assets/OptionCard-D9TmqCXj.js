var pe=Object.defineProperty;var fe=(a,t,e)=>t in a?pe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var I=(a,t,e)=>fe(a,typeof t!="symbol"?t+"":t,e);import{c as me}from"./createLucideIcon-Cy5Ya80P.js";import{j as l}from"./AboutSimple-Cf8x2fCZ.js";import{r as s}from"./index-BH53Isel.js";import{L as ye}from"./loader-circle-CrvBvIt1.js";import{a as he}from"./index-NIGUFBhG.js";import{a as ge,b as c,h as ve,c as S,u as _e,S as Se,_ as xe}from"./useStateManager-7e1e8489.esm-CxwdjZvi.js";import{_ as Oe}from"./defineProperty-DRmM3rRU.js";import"./index-fRpqIG3j.js";import{m as x}from"./main-Byrjfx4U.js";import"./index-BJa4kPFi.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),qe=({children:a,className:t="",loading:e=!1,disabled:r=!1,...u})=>l.jsxs("button",{type:"button",disabled:r||e,className:`w-full bg-primary font-bold text-white py-3 px-4 hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl flex items-center justify-center gap-2 ${t}`,...u,children:[e&&l.jsx(ye,{className:"w-4 h-4 animate-spin"}),a]}),Be=({children:a,className:t="",...e})=>l.jsx("a",{className:`w-full block border-primary cursor-pointer border-2 text-center font-bold customtext-primary py-3 px-4  hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl ${t}`,...e,children:a}),be="/api";class Me{static async applyToCart(t,e,r=null){var u;try{if(console.log("🛒 Applying discount rules to cart:",{cartItems:t,totalAmount:e,customerEmail:r}),!Array.isArray(t)||t.length===0)return{success:!1,error:"Carrito vacío o inválido",data:null};const n={cart_items:t.map(i=>{const f={item_id:String(i.item_id||i.id||""),quantity:parseInt(i.quantity)||1,price:parseFloat(i.price||i.final_price||0),name:String(i.name||i.description||"Producto sin nombre"),category_id:i.category_id?String(i.category_id):null};return console.log("📦 Processing cart item:",f),f}),total_amount:parseFloat(e)||0,customer_email:r||null};console.log("📤 Sending payload to API:",n);const d=await he.post(`${be}/discount-rules/apply-to-cart`,n);return d.data.status===200?{success:!0,data:d.data.data,message:d.data.message}:{success:!1,error:d.data.message||"Error al aplicar descuentos",data:null}}catch(n){return console.error("Error applying discount rules:",n),(u=n.response)!=null&&u.data?{success:!1,error:n.response.data.message||"Error del servidor",data:n.response.data.data||null}:{success:!1,error:"Error de conexión",data:null}}}static formatDiscounts(t){return!t||!Array.isArray(t)?[]:t.map(e=>({id:e.rule_id,name:e.rule_name||"Descuento automático",description:e.description||"",amount:parseFloat(e.discount_amount||0),type:e.discount_type||"fixed",promotion_type:e.promotion_type||null,free_items:e.free_items||[],formatted_amount:e.discount_type==="percentage"?`${e.discount_amount}%`:`S/ ${parseFloat(e.discount_amount||0).toFixed(2)}`}))}static getFreeItems(t){if(!t||!Array.isArray(t))return[];const e=[];return t.forEach(r=>{r.free_items&&Array.isArray(r.free_items)&&e.push(...r.free_items)}),e}static calculateTotalDiscount(t){return!t||!Array.isArray(t)?0:t.reduce((e,r)=>e+parseFloat(r.discount_amount||0),0)}}var we=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function Ce(a){var t=a.defaultOptions,e=t===void 0?!1:t,r=a.cacheOptions,u=r===void 0?!1:r,n=a.loadOptions;a.options;var d=a.isLoading,i=d===void 0?!1:d,f=a.onInputChange,j=a.filterOption,U=j===void 0?null:j,P=ge(a,we),L=P.inputValue,m=s.useRef(void 0),v=s.useRef(!1),W=s.useState(Array.isArray(e)?e:void 0),F=c(W,2),z=F[0],N=F[1],H=s.useState(typeof L<"u"?L:""),$=c(H,2),R=$[0],O=$[1],K=s.useState(e===!0),T=c(K,2),Q=T[0],y=T[1],X=s.useState(void 0),V=c(X,2),b=V[0],w=V[1],Y=s.useState([]),k=c(Y,2),Z=k[0],C=k[1],ee=s.useState(!1),q=c(ee,2),te=q[0],_=q[1],re=s.useState({}),B=c(re,2),h=B[0],M=B[1],ae=s.useState(void 0),D=c(ae,2),se=D[0],oe=D[1],ne=s.useState(void 0),J=c(ne,2),ie=J[0],ue=J[1];u!==ie&&(M({}),ue(u)),e!==se&&(N(Array.isArray(e)?e:void 0),oe(e)),s.useEffect(function(){return v.current=!0,function(){v.current=!1}},[]);var A=s.useCallback(function(g,p){if(!n)return p();var o=n(g,p);o&&typeof o.then=="function"&&o.then(p,function(){return p()})},[n]);s.useEffect(function(){e===!0&&A(R,function(g){v.current&&(N(g||[]),y(!!m.current))})},[]);var ce=s.useCallback(function(g,p){var o=ve(g,p,f);if(!o){m.current=void 0,O(""),w(""),C([]),y(!1),_(!1);return}if(u&&h[o])O(o),w(o),C(h[o]),y(!1),_(!1);else{var de=m.current={};O(o),y(!0),_(!b),A(o,function(E){v&&de===m.current&&(m.current=void 0,y(!1),w(o),C(E||[]),_(!1),M(E?S(S({},h),{},Oe({},o,E)):h))})}},[u,A,b,h,f]),le=te?[]:R&&b?Z:z||[];return S(S({},P),{},{options:le,isLoading:Q||i,onInputChange:ce,filterOption:U})}var Ae=s.forwardRef(function(a,t){var e=Ce(a),r=_e(e);return s.createElement(Se,xe({ref:t},r))}),De=Ae;class G{}I(G,"getShippingCost",async t=>{try{const{status:e,result:r}=await x.Fetch("./api/delivery-prices",{method:"POST",body:JSON.stringify(t)});if(!e)throw new Error((r==null?void 0:r.message)||"Error al obtener datos");return r}catch{return!1}}),I(G,"getCosts",async t=>{try{const{status:e,result:r}=await x.Fetch("./api/prices-type",{method:"POST"});if(!e)throw new Error((r==null?void 0:r.message)||"Error al obtener datos");return r}catch{return!1}});class Je{static async validateCoupon(t){try{const{status:e,result:r}=await x.Fetch("./api/coupons/validate",{method:"POST",body:JSON.stringify(t)});if(!e)throw new Error((r==null?void 0:r.message)||"Error al validar cupón");return r}catch(e){throw e}}static async generateCode(){try{const{status:t,result:e}=await x.Fetch("./api/coupons/generate-code",{method:"GET"});if(!t)throw new Error((e==null?void 0:e.message)||"Error al generar código");return e}catch(t){throw t}}}const Ge=({title:a,description:t,selected:e,onSelect:r,disabled:u})=>l.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:r,children:[l.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${e?"border-primary":""}`,children:e&&l.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),l.jsxs("div",{className:"customtext-neutral-light",children:[l.jsx("h4",{className:"text-sm ",children:a}),l.jsx("p",{className:"text-xs",children:t})]})]});export{De as A,qe as B,Je as C,G as D,ke as I,Ge as O,Be as a,Me as b};

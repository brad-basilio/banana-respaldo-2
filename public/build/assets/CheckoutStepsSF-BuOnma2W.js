import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as c}from"./index-BH53Isel.js";import{N}from"./Number2Currency-e57Tgsuk.js";import{B as te,a as Ce,D as ze,A as Ue,O as Ve,C as Ge}from"./OptionCard-B_4dOZ-t.js";import{T as je}from"./trash-2-DK1wnsDn.js";import{M as ye}from"./CartItemRow-CLVGv7Ee.js";import{P as Ne}from"./plus-Bot15Khs.js";import{m as F}from"./main-6DCdASTx.js";import{t as H}from"./index-BZYhE2TF.js";import{I as T}from"./InputForm-ZnsQvLid.js";import{s as He}from"./server.browser-Bf4gQIc7.js";import{l as Ye}from"./ShippingStep-C2YEwCQ_.js";import{R as Je}from"./PaymentModal-BB1JXzaZ.js";import{G as I}from"./General-BmbBKdsB.js";import{U as Ke,a as Qe}from"./ShippingStepSF-KdwzZ0MB.js";import{i as ve}from"./tippy-react.esm-BWiGTO87.js";import{C as Y}from"./circle-x-p-TkKhsF.js";import{G as se}from"./Global-ErywZRdd.js";import"./ProductNavigation-BvCahFZS.js";import"./ProductCard-CRhBSmWZ.js";/* empty css              */import"./BlogCarousel-BcMdR14t.js";/* empty css               */import"./BlogCarrusel-B3SD0Iql.js";import"./index-yBjzXJbu.js";import"./loader-circle-CrvBvIt1.js";import"./createLucideIcon-Cy5Ya80P.js";import"./useStateManager-7e1e8489.esm-CqlJ4XxI.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./floating-ui.dom-BPWAutIm.js";import"./proxy-F8AlgMSF.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-Chjiymov.js";import"./VoucherUpload-Rnyqcewr.js";import"./filepond-plugin-image-preview-B-c8xYdh.js";import"./SalesRest-BddGx03q.js";import"./BasicRest-C4m6wu80.js";import"./chevron-up-D78jyEhP.js";import"./chevron-down-DS-mdh9v.js";import"./ItemsRest-BSMuMwsF.js";import"./HeaderSearch-BZ6sxqwg.js";import"./index-CmxRu895.js";import"./eye-CKCH9ORv.js";const we=({setCart:m,...l})=>{const g=()=>{m(f=>f.filter(u=>u.id!==l.id))},h=()=>{m(f=>f.map(u=>u.id===l.id?{...u,quantity:(u.quantity||1)+1}:u))},r=()=>{m(f=>f.map(u=>{if(u.id===l.id){const d=(u.quantity||1)-1;return d<=0?(g(l.id),null):{...u,quantity:d}}return u}).filter(Boolean))};return console.log(l),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"hidden md:table-row border-b bg-gray-50 font-font-general",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:`/storage/images/item/${l.image}`,alt:l.name,className:"w-16 h-16 object-cover rounded mr-4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:l.name}),e.jsxs("div",{className:"text-[12px] 2xl:text-sm customtext-neutral-dark space-y-1 mt-1",children:[e.jsxs("p",{children:["Color: ",l.color]}),e.jsx("button",{onClick:g,className:" text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx(je,{size:18})})]})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[e.jsx("button",{type:"button",onClick:r,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors","aria-label":"Decrease quantity",children:e.jsx(ye,{size:16})}),e.jsx("div",{className:"w-8 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:l.quantity||1})}),e.jsx("button",{type:"button",onClick:h,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors","aria-label":"Increase quantity",children:e.jsx(Ne,{size:16})})]})})}),e.jsxs("td",{className:"px-4 py-4 text-right min-w-32",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(l.price).toFixed(2)]}),e.jsxs("div",{className:"font-bold",children:["S/ ",Number(l.final_price).toFixed(2)]})]}),e.jsxs("td",{className:"px-4 py-4 text-right font-bold",children:["S/ ",Number(l.final_price*l.quantity).toFixed(2)]})]},l.id),e.jsx("div",{className:"md:hidden bg-gray-50  rounded-lg shadow p-4 mb-4 w-full font-font-general",children:e.jsxs("div",{className:"flex items-start gap-4 relative",children:[e.jsx("img",{src:`/storage/images/item/${l.image}`,alt:l.name,className:"w-20 h-20 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1 leading-tight customtext-neutral-dark",children:l.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Color: ",l.color]}),e.jsxs("div",{className:"mt-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm w-20",children:[e.jsx("button",{onClick:r,className:"p-2 text-gray-600 hover:bg-gray-100",children:e.jsx(ye,{size:16})}),e.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:l.quantity||1})}),e.jsx("button",{onClick:h,className:"p-2 text-gray-600 hover:bg-gray-100",children:e.jsx(Ne,{size:16})})]}),e.jsxs("div",{className:"text-right mt-2",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(l.price).toFixed(2)]}),e.jsxs("div",{className:"font-bold",children:["S/ ",Number(l.final_price).toFixed(2)]}),e.jsxs("div",{className:"text-sm font-bold mt-1",children:["Subtotal: S/ ",Number(l.final_price*l.quantity).toFixed(2)]})]})]})]}),e.jsx("button",{onClick:g,className:"absolute -top-2 -right-2 text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx(je,{size:18})})]})})]})};function We({cart:m,setCart:l,onContinue:g,subTotal:h,envio:r,igv:f,totalFinal:u}){return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-y-8 md:gap-8",children:[e.jsxs("div",{className:"lg:col-span-3 flex flex-row w-full",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg w-full",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{className:"!font-font-general",children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Producto"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Cantidad"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Precio"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Subtotal"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((d,b)=>e.jsx(we,{...d,setCart:l},b))})]})}),e.jsx("div",{className:"md:hidden space-y-4 w-full",children:m.map((d,b)=>e.jsx(we,{...d,setCart:l},b))})]}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max font-font-general",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6 customtext-neutral-dark",children:"Resumen de compra"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(h)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(f)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(r)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",N(u)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsx(te,{className:"rounded-2xl xl:rounded-3xl",onClick:g,children:"  Continuar"}),e.jsx(Ce,{className:"rounded-2xl xl:rounded-3xl",href:"/",children:" Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los ",e.jsx("a",{className:"customtext-primary font-bold",children:"Términos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra ",e.jsx("a",{className:"customtext-primary font-bold",children:"Política de Privacidad"}),"."]})})]})]})]})}const Xe=m=>new Promise(async(l,g)=>{try{console.log("Datos para MercadoPago:",m);const{status:h,result:r}=await F.Fetch("./api/mercadopago/preference",{method:"POST",body:JSON.stringify(m)});if(!h||!r.preference_id){F.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:(r==null?void 0:r.message)||"Error al crear la preferencia de pago",type:"danger"}),g((r==null?void 0:r.message)||"Error al crear la preferencia de pago");return}console.log("✅ Preferencia creada:",r);const f=new window.MercadoPago(r.public_key,{locale:"es-PE"});setTimeout(()=>{window.location.href=r.redirect_url},500),l(r)}catch(h){console.error("Error en processMercadoPagoPayment:",h),F.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:h.message||"Error en la integración con MercadoPago",type:"danger"}),g(h.message||"Error en la integración con MercadoPago")}});function Ze({isOpen:m,onClose:l,onPaymentComplete:g,contacts:h}){const[r,f]=c.useState(null),[u,d]=c.useState(!1);c.useEffect(()=>{m||(d(!1),f(null))},[m]);const b=()=>{r&&(d(!0),g(r))},v=u||!r,a=h.find(w=>w.correlative==="checkout_mercadopago");return e.jsx(Je,{isOpen:m,onRequestClose:l,className:"absolute left-1/2 -translate-x-1/2 bg-white rounded-2xl shadow-lg w-[95%] max-w-4xl top-1/2 -translate-y-1/2 overflow-hidden",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",ariaHideApp:!1,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[e.jsx("div",{className:"hidden md:block bg-[#f8f5f2] h-full",children:e.jsx("img",{src:"/assets/img/salafabulosa/portadapagos.png",alt:"Métodos de pago",className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"p-6 max-h-[90vh] md:max-h-[100vh] flex flex-col justify-center ",children:[e.jsxs("div",{className:"mb-0 md:mb-4",children:[e.jsx("h2",{className:"text-xl md:text-2xl 2xl:text-3xl font-bold customtext-primary",children:"¿Cómo deseas pagar tu pedido?"}),e.jsx("p",{className:"mt-2 text-sm 2xl:text-base",children:"Elige una de las opciones disponibles para completar tu pago de forma segura."})]}),(a==null?void 0:a.description)!=="true"&&I.get("checkout_dwallet")!=="true"&&I.get("checkout_transfer")!=="true"?e.jsx("div",{className:"text-gray-500 text-center py-4",children:"Sin opciones de pago"}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-3 space-y-3",children:[(a==null?void 0:a.description)=="true"&&e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-colors ${r==="tarjeta"?"border-primary bg-[#f8f5f2]":"border-gray-200 hover:border-2 hover:border-[#3a2723]"}`,onClick:()=>f("tarjeta"),children:e.jsxs("div",{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-start justify-center space-x-2",children:[e.jsx("input",{type:"radio",id:"tarjeta",name:"paymentMethod",checked:r==="tarjeta",onChange:()=>f("tarjeta"),className:"h-5 w-5 text-primary focus:ring-primary hidden"}),e.jsx("label",{htmlFor:"tarjeta",className:"font-medium text-base 2xl:text-lg",children:"Pago con Tarjeta"}),e.jsx("p",{className:"text-[#5c504c] text-sm 2xl:text-base ml-7 mt-1",children:"Renueva tus espacios con estilo: Fundas exclusivas para cada temporada."})]}),e.jsx("div",{className:"min-w-5 flex items-center justify-center",children:e.jsx("div",{className:`h-5 w-5 rounded-full flex items-center justify-center ${r==="tarjeta"?"bg-[#3a2723]":"border-2 border-[#d0ccca]"}`,children:e.jsx("div",{className:`h-2 w-2 rounded-full ${r==="tarjeta"?"bg-white":""}`})})})]})}),I.get("checkout_dwallet")=="true"&&e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-colors ${r==="yape"?"border-primary bg-[#f8f5f2]":"border-gray-200 hover:border-2 hover:border-[#3a2723]"}`,onClick:()=>f("yape"),children:e.jsxs("div",{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-start justify-center space-x-2",children:[e.jsx("input",{type:"radio",id:"yape",name:"paymentMethod",checked:r==="yape",onChange:()=>f("yape"),className:"h-5 w-5 text-primary focus:ring-[#3a2723] hidden"}),e.jsx("label",{htmlFor:"yape",className:"font-medium text-base 2xl:text-lg",children:"Yape / Plin"}),e.jsx("p",{className:"text-[#5c504c] text-sm 2xl:text-base ml-7 mt-1",children:"Realiza el pago desde tu celular sin comisiones."})]}),e.jsx("div",{className:"min-w-5 flex items-center justify-center",children:e.jsx("div",{className:`h-5 w-5 rounded-full flex items-center justify-center ${r==="yape"?"bg-[#3a2723]":"border-2 border-[#d0ccca]"}`,children:e.jsx("div",{className:`h-2 w-2 rounded-full ${r==="yape"?"bg-white":""}`})})})]})}),I.get("checkout_transfer")=="true"&&e.jsx("div",{className:`border-2 rounded-lg p-3 cursor-pointer transition-colors ${r==="transferencia"?"border-primary bg-[#f8f5f2]":"border-gray-200 hover:border-2 hover:border-[#3a2723]"}`,onClick:()=>f("transferencia"),children:e.jsxs("div",{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col items-start justify-center space-x-2",children:[e.jsx("input",{type:"radio",id:"transferencia",name:"paymentMethod",checked:r==="transferencia",onChange:()=>f("transferencia"),className:"h-5 w-5 text-primary focus:ring-[#3a2723] hidden"}),e.jsx("label",{htmlFor:"transferencia",className:"font-medium text-base 2xl:text-lg",children:"Pago por Transferencia"}),e.jsx("p",{className:"text-[#5c504c] text-sm 2xl:text-base ml-7 mt-1",children:"Haz una transferencia bancaria desde tu app o banca por internet."})]}),e.jsx("div",{className:"min-w-5 flex items-center justify-center",children:e.jsx("div",{className:`h-5 w-5 rounded-full flex items-center justify-center ${r==="transferencia"?"bg-[#3a2723]":"border-2 border-[#d0ccca]"}`,children:e.jsx("div",{className:`h-2 w-2 rounded-full ${r==="transferencia"?"bg-white":""}`})})})]})})]})}),e.jsxs("div",{className:"mt-4 space-y-3",children:[((a==null?void 0:a.description)==="true"||I.get("checkout_dwallet")==="true"||I.get("checkout_transfer")==="true")&&e.jsx("button",{className:`w-full bg-[#3a2723] hover:bg-[#2a1d1a] text-white py-3 rounded-3xl text-base 2xl:text-lg leading-normal font-medium transition-colors 
                            ${v?"opacity-70 cursor-not-allowed":""}`,onClick:b,disabled:u,children:u?"Procesando...":"Confirmar pago"}),e.jsx("button",{className:"w-full border border-[#3a2723] text-[#3a2723] hover:bg-[#f8f5f2] py-3 text-base 2xl:text-lg leading-normal rounded-3xl font-medium transition-colors",onClick:l,disabled:u,children:"Volver"})]})]})]})})}const De=new Ge;function es({cart:m,setSale:l,setCode:g,setDelivery:h,setCart:r,onContinue:f,noContinue:u,subTotal:d,igv:b,totalFinal:v,user:a,setEnvio:w,envio:C,prefixes:L,ubigeos:_=[],contacts:j,totalPrice:y,descuentofinal:S,setDescuentoFinal:q}){var pe,xe;const M=c.useRef(null),[p,B]=c.useState(null),[A,R]=c.useState(null),[E,J]=c.useState(null),[s,K]=c.useState({name:(a==null?void 0:a.name)||"",lastname:(a==null?void 0:a.lastname)||"",email:(a==null?void 0:a.email)||"",phone_prefix:(a==null?void 0:a.phone_prefix)||"51",phone:(a==null?void 0:a.phone)||"",department:(a==null?void 0:a.department)||"",province:(a==null?void 0:a.province)||"",district:(a==null?void 0:a.district)||"",address:(a==null?void 0:a.address)||"",number:(a==null?void 0:a.number)||"",comment:(a==null?void 0:a.comment)||"",shippingOption:"delivery",ubigeo:(a==null?void 0:a.ubigeo)||null,invoiceType:(a==null?void 0:a.invoiceType)||"boleta",documentType:(a==null?void 0:a.documentType)||"dni",document:(a==null?void 0:a.dni)||"",businessName:(a==null?void 0:a.businessName)||""});c.useEffect(()=>{if(a!=null&&a.ubigeo&&(a!=null&&a.district)&&(a!=null&&a.province)&&(a!=null&&a.department)){const t={value:a.ubigeo,label:`${a.district}, ${a.province}, ${a.department}`,data:{reniec:a.ubigeo,departamento:a.department,provincia:a.province,distrito:a.district}};J(t),R(t),Z(t)}},[a]);const Se=t=>{var n;return((n=j.find(i=>i.correlative===t))==null?void 0:n.description)||""},k=t=>{const{name:n,value:i}=t.target;K(o=>({...o,[n]:i})),n==="invoiceType"&&K(o=>({...o,documentType:i==="factura"?"ruc":"dni",document:"",businessName:i==="factura"?o.businessName:""}))},[as,ns]=c.useState(0),[Q,ae]=c.useState(!1),[z,ne]=c.useState([]),[U,W]=c.useState(null),[rs,os]=c.useState(null),[P,X]=c.useState({}),ke=typeof d=="number"?d:parseFloat(d)||0,Ee=typeof b=="number"?b:parseFloat(b)||0,V=parseFloat(Se("shipping_free")),re=ke+Ee-S,Z=async t=>{var i;if(!t)return;X(o=>({...o,ubigeo:""}));const{data:n}=t;console.log("data",n),K(o=>({...o,department:n.departamento,province:n.provincia,district:n.distrito,ubigeo:n.reniec||n.inei})),ae(!0);try{const o=await ze.getShippingCost({ubigeo:n.reniec||n.inei}),x=[],G=re>=V;if(G?x.push({type:"free",price:0,description:`Compra mayor a S/ ${V}`,deliveryType:"Envío gratuito"}):o.data.is_free?x.push({type:"free",price:0,description:o.data.standard.description,deliveryType:o.data.standard.type,characteristics:o.data.standard.characteristics}):o.data.is_agency?x.push({type:"agency",price:0,description:o.data.agency.description,deliveryType:o.data.agency.type,characteristics:o.data.agency.characteristics}):x.push({type:"standard",price:o.data.standard.price,description:o.data.standard.description,deliveryType:o.data.standard.type,characteristics:o.data.standard.characteristics}),((i=o.data.express)==null?void 0:i.price)>0&&o.data.is_free&&!G&&x.push({type:"express",price:o.data.express.price,description:o.data.express.description,deliveryType:o.data.express.type,characteristics:o.data.express.characteristics}),x.length===0)throw new Error("No hay opciones de envío disponibles");ne(x),W(x[0].type),w(x[0].price)}catch(o){console.error("Error al obtener precios de envío:",o),H.success("Sin cobertura",{description:"No realizamos envíos a esta ubicación",icon:e.jsx(Y,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"}),ne([]),W(null),w(0)}ae(!1)};c.useEffect(()=>{A&&Z(A)},[m,d,S]);const Pe=c.useCallback(Ye.debounce((t,n)=>{if(t.length<3){n([]);return}fetch(`/api/ubigeo/search?q=${encodeURIComponent(t)}`).then(i=>{if(!i.ok)throw new Error("Error en la respuesta");return i.json()}).then(i=>{const o=i.map(x=>({value:x.reniec,label:`${x.distrito}, ${x.provincia}, ${x.departamento}`,data:{inei:x.inei,reniec:x.reniec,departamento:x.departamento,provincia:x.provincia,distrito:x.distrito}}));n(o)}).catch(i=>{console.error("Error:",i),n([])})},300),[]);c.useEffect(()=>{const t=n=>{const i=n.element.dataset.code,o=n.element.dataset.flag;return He.renderToString(e.jsxs("span",{children:[e.jsx("span",{className:"inline-block w-8 font-emoji text-center",children:o}),e.jsx("b",{className:"me-1",children:n.text}),e.jsx("span",{className:"text-sm text-opacity-20",children:i})]}))};$(".select2-prefix-selector").select2({dropdownCssClass:"py-1",containerCssClass:"!border !border-gray-300 !rounded p-2 !h-[42px]",arrowCssClass:'!text-primary top-1/2 -translate-y-1/2"',templateResult:function(n){if(!n.id)return n.text;var i=$(t(n));return i},templateSelection:function(n){if(!n.id)return n.text;var i=$(t(n));return i},matcher:function(n,i){if(!n.term||!i.element)return i;const o=i.element.dataset.country||"",x=i.text||"";return o.toLowerCase().includes(n.term.toLowerCase())||x.toLowerCase().includes(n.term.toLowerCase())?i:null}})},[s.phone_prefix]);const[_e,D]=c.useState(!1),[Te,oe]=c.useState(!1),[$e,ie]=c.useState(!1),[le,Fe]=c.useState(null),[ce,de]=c.useState(null),qe=t=>{if(t.preventDefault(),t&&t.preventDefault&&t.preventDefault(),!!Me()){if(!U){H.success("Seleccione envío",{description:"Debe elegir un método de envío",icon:e.jsx(Y,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"});return}D(!0)}},Me=()=>{const t={};s.name||(t.name="Nombre es requerido"),s.lastname||(t.lastname="Apellido es requerido"),s.email||(t.email="Email es requerido"),s.phone||(t.phone="Teléfono es requerido"),s.ubigeo||(t.ubigeo="Ubigeo es requerido"),s.address||(t.address="Dirección es requerida"),s.document||(t.document="Documento es requerido"),s.number||(t.number="Numero es requerido"),X(t);const n=(i,o=800)=>{const x=i.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/2+i.offsetHeight/2,G=window.pageYOffset;let ee=null;const ue=he=>{ee===null&&(ee=he);const ge=he-ee,Be=((O,fe,be,Ae)=>(O/=Ae/2,O<1?be/2*O*O+fe:(O--,-be/2*(O*(O-2)-1)+fe)))(ge,G,x-G,o);window.scrollTo(0,Be),ge<o?requestAnimationFrame(ue):["INPUT","SELECT","TEXTAREA"].includes(i.tagName)&&i.focus()};requestAnimationFrame(ue)};if(Object.keys(t).length>0){const i=Object.keys(t)[0];setTimeout(()=>{var x;let o=null;i==="ubigeo"?o=document.getElementById("ubigeo-select-container"):i==="phone_prefix"?o=(x=document.querySelector(".select2-prefix-selector"))==null?void 0:x.parentElement:o=document.querySelector(`[name="${i}"]`),o&&(o.classList.add("highlight-error"),setTimeout(()=>o.classList.remove("highlight-error"),2e3),n(o,600))},100)}return Object.keys(t).length===0},Oe=async t=>{try{if(D(!1),Fe(t),t==="tarjeta"){if(!window.MercadoPago){console.error("❌ MercadoPago aún no se ha cargado.");return}const n={user_id:(a==null?void 0:a.id)||"",name:(s==null?void 0:s.name)||"",lastname:(s==null?void 0:s.lastname)||"",fullname:`${s==null?void 0:s.name} ${s==null?void 0:s.lastname}`,phone_prefix:(s==null?void 0:s.phone_prefix)||"51",email:(s==null?void 0:s.email)||"",phone:`${s.phone_prefix}${s.phone}`,country:"Perú",department:(s==null?void 0:s.department)||"",province:(s==null?void 0:s.province)||"",district:(s==null?void 0:s.district)||"",ubigeo:(s==null?void 0:s.ubigeo)||"",address:(s==null?void 0:s.address)||"",number:(s==null?void 0:s.number)||"",comment:(s==null?void 0:s.comment)||"",amount:y||0,delivery:C,cart:m,invoiceType:s.invoiceType||"",documentType:s.documentType||"",document:s.document||"",businessName:s.businessName||"",payment_method:t||null,coupon_id:p?p.id:null,coupon_discount:S||0,total_amount:v||0};console.log(n);try{const o=await Xe(n);o.status?(l(o.sale),h(o.delivery),g(o.code)):H.success("Error en el Pago",{description:"El pago ha sido rechazado",icon:e.jsx(Y,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}catch(i){console.log(i),H.success("Error en el Pago",{description:"No se llegó a procesar el pago",icon:e.jsx(Y,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}}else if(t==="yape"){const n={user_id:(a==null?void 0:a.id)||"",name:(s==null?void 0:s.name)||"",lastname:(s==null?void 0:s.lastname)||"",fullname:`${s==null?void 0:s.name} ${s==null?void 0:s.lastname}`,phone_prefix:(s==null?void 0:s.phone_prefix)||"51",email:(s==null?void 0:s.email)||"",phone:`${s.phone_prefix}${s.phone}`,country:"Perú",department:(s==null?void 0:s.department)||"",province:(s==null?void 0:s.province)||"",district:(s==null?void 0:s.district)||"",ubigeo:(s==null?void 0:s.ubigeo)||"",address:(s==null?void 0:s.address)||"",number:(s==null?void 0:s.number)||"",comment:(s==null?void 0:s.comment)||"",amount:y||0,delivery:C,cart:m,invoiceType:s.invoiceType||"",documentType:s.documentType||"",document:s.document||"",businessName:s.businessName||"",payment_method:t||null,payment_proof:null,coupon_id:p?p.id:null,coupon_discount:S||0,total_amount:v||0};de(n),oe(!0)}else if(t==="transferencia"){const n={user_id:(a==null?void 0:a.id)||"",name:(s==null?void 0:s.name)||"",lastname:(s==null?void 0:s.lastname)||"",fullname:`${s==null?void 0:s.name} ${s==null?void 0:s.lastname}`,phone_prefix:(s==null?void 0:s.phone_prefix)||"51",email:(s==null?void 0:s.email)||"",phone:`${s.phone_prefix}${s.phone}`,country:"Perú",department:(s==null?void 0:s.department)||"",province:(s==null?void 0:s.province)||"",district:(s==null?void 0:s.district)||"",ubigeo:(s==null?void 0:s.ubigeo)||"",address:(s==null?void 0:s.address)||"",number:(s==null?void 0:s.number)||"",comment:(s==null?void 0:s.comment)||"",amount:y||0,delivery:C,cart:m,invoiceType:s.invoiceType||"",documentType:s.documentType||"",document:s.document||"",businessName:s.businessName||"",payment_method:t||null,payment_proof:null,coupon_id:p?p.id:null,coupon_discount:S||0,total_amount:v||0};de(n),ie(!0)}}catch(n){console.error("Error en el pago:",n),H.success("Error en el Pago",{description:"No se llegó a procesar el pago",icon:e.jsx(Y,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}};c.useEffect(()=>{X(t=>{const n={...t};return Object.keys(s).forEach(i=>{s[i]&&delete n[i]}),n})},[s]);const Re=t=>({control:n=>({...n,border:`1px solid ${t?"#ef4444":"#e5e7eb"}`,boxShadow:"none",minHeight:"50px","&:hover":{borderColor:t?"#ef4444":"#6b7280"},borderRadius:"0.75rem",padding:"2px 8px"}),menu:n=>({...n,zIndex:9999,marginTop:"4px",borderRadius:"8px"}),option:n=>({...n,color:"#1f2937",backgroundColor:"white","&:hover":{backgroundColor:"#f3f4f6"},padding:"12px 16px"})}),Ie={control:(t,n)=>({...t,padding:"0.5rem",borderColor:(n.isFocused,"#d1d5db"),borderRadius:"0.75rem",boxShadow:"none","&:hover":{borderColor:"#9ca3af"}}),input:t=>({...t,color:"#374151"}),option:(t,n)=>({...t,backgroundColor:n.isSelected?"#3b82f6":"white",color:n.isSelected?"white":"#374151","&:hover":{backgroundColor:"#e5e7eb"}}),singleValue:t=>({...t,color:"#374151"})};c.useEffect(()=>{if(p){let t=0;p.type==="percentage"?t=y*(p.amount/100):t=p.amount,q(t)}else q(0)},[y,p]);const me=t=>{t.preventDefault();const n=(M.current.value||"").trim().toUpperCase();n&&De.save({coupon:n,amount:y,email:"basiliohinostroza2003bradneve@gmail.com"}).then(i=>{i&&i.id?B(i):(B(null),q(0))})},Le=t=>{t.key=="Enter"&&me(t)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-y-8 lg:gap-8 ",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("form",{className:"space-y-6 bg-[#f9f9f9] py-6 px-4 sm:px-6 rounded-2xl font-font-general",onSubmit:t=>t.preventDefault(),children:[e.jsxs("div",{className:"sectionInformation space-y-3.5",children:[e.jsx("h3",{className:"block text-xl 2xl:text-2xl font-bold mb-4 customtext-neutral-dark ",children:"Información del contacto"}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsx(T,{type:"text",label:"Nombres",name:"name",value:s.name,error:P.name,onChange:k,placeholder:"Nombres",required:!0}),e.jsx(T,{label:"Apellidos",type:"text",name:"lastname",value:s.lastname,error:P.lastname,onChange:k,placeholder:"Apellidos",required:!0})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4 ",children:[e.jsx(T,{label:"Correo electrónico",type:"email",name:"email",value:s.email,error:P.email,onChange:k,placeholder:"Ej. hola@gmail.com",required:!0}),e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm mb-1",children:["Celular ",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsxs("select",{className:"select2-prefix-selector max-w-[120px] p-2 border border-gray-300 rounded",onChange:t=>setSelectedPrefix(t.target.value),name:"phone_prefix",value:s.phone_prefix,styles:Ie,classnameprefix:"select",children:[e.jsx("option",{value:"",children:"Selecciona un país"}),L.sort((t,n)=>t.country.localeCompare(n.country)).map((t,n)=>e.jsx("option",{value:t.realCode,"data-code":t.beautyCode,"data-flag":t.flag,"data-country":t.country},n))]}),e.jsx(T,{type:"text",id:"phone",name:"phone",value:s.phone,error:P.phone,onChange:k,placeholder:"000 000 000"})]})]})]})]}),e.jsx("div",{className:"bg-[#66483966] py-[0.6px]"}),e.jsxs("div",{className:"sectionDelivery space-y-3.5",children:[e.jsx("h3",{className:"block text-xl 2xl:text-2xl font-bold mb-4 customtext-neutral-dark",children:"Dirección de envío"}),e.jsxs("div",{id:"ubigeo-select-container",className:"form-group",children:[e.jsx("label",{className:"block text-sm 2xl:text-base mb-1 customtext-neutral-dark ",children:"Ubicación de entrega (Distrito)"}),e.jsx(Ue,{name:"ubigeo",cacheOptions:!0,value:A,loadOptions:Pe,onChange:t=>{R(t),Z(t)},placeholder:"Buscar por distrito | provincia | departamento ...",loadingMessage:()=>"Buscando ubicaciones...",noOptionsMessage:({inputValue:t})=>t.length<3?"Ingrese al menos 3 caracteres...":"No se encontraron resultados",isLoading:Q,styles:Re(!!P.ubigeo),formatOptionLabel:({data:t})=>e.jsxs("div",{className:"text-sm py-1",children:[e.jsx("div",{className:"font-medium",children:t.distrito}),e.jsxs("div",{className:"text-gray-500",children:[t.provincia,", ",t.departamento]})]}),className:"w-full rounded-xl transition-all duration-300",menuPortalTarget:document.body,isClearable:!0,components:{ClearIndicator:t=>e.jsx("div",{...t.innerProps,className:"p-1 cursor-pointer",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-400 hover:text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}}),P.ubigeo&&e.jsx("div",{className:"text-red-500 text-sm mt-1",children:P.ubigeo})]}),e.jsx(T,{label:"Avenida / Calle / Jirón",type:"text",name:"address",value:s.address,error:P.address,onChange:k,placeholder:"Ingresa el nombre de la calle",required:!0}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4",children:[e.jsx(T,{label:"Número",type:"text",name:"number",value:s.number,error:P.number,onChange:k,placeholder:"Ingresa el número de la calle",required:!0}),e.jsx(T,{label:"Dpto./ Interior/ Piso/ Lote/ Bloque (opcional)",type:"text",name:"comment",value:s.comment,onChange:k,placeholder:"Ej. Casa 3, Dpto 101"})]}),z.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"block text-xl 2xl:text-2xl font-bold mb-4 customtext-neutral-dark",children:"Método de envío"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:z.map(t=>e.jsx(Ve,{title:(t.type==="free"||t.type==="express"||t.type==="agency",t.deliveryType),price:t.price,description:t.description,selected:U===t.type,onSelect:()=>{W(t.type),w(t.price)}},t.type))}),console.log(z.find(t=>t.type===U)),U&&z.length>0&&e.jsx("div",{className:"space-y-4 mt-4",children:(xe=(pe=z.find(t=>t.type===U))==null?void 0:pe.characteristics)==null?void 0:xe.map((t,n)=>e.jsxs("div",{className:"flex items-start gap-4 bg-[#F7F9FB] p-4 rounded-xl",children:[e.jsx("div",{className:"w-5 flex-shrink-0",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-info customtext-primary",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4"}),e.jsx("path",{d:"M12 8h.01"})]})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium customtext-neutral-dark",children:t})})]},`char-${n}`))})]})]}),e.jsx("div",{className:"bg-[#66483966] py-[0.6px]"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium customtext-neutral-dark",children:"Tipo de comprobante"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio",name:"invoiceType",value:"boleta",checked:s.invoiceType==="boleta",onChange:k}),e.jsx("span",{className:"ml-2",children:"Boleta"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio",name:"invoiceType",value:"factura",checked:s.invoiceType==="factura",onChange:k}),e.jsx("span",{className:"ml-2",children:"Factura"})]})]})]}),e.jsx(T,{label:s.documentType==="dni"?"DNI":"RUC",type:"text",name:"document",value:s.document,error:P.document,onChange:k,placeholder:`Ingrese su ${s.documentType==="dni"?"DNI":"RUC"}`,maxLength:s.documentType==="dni"?"8":"11",required:!0}),s.invoiceType==="factura"&&e.jsx(T,{label:"Razón Social",type:"text",name:"businessName",value:s.businessName,onChange:k,placeholder:"Ingrese la razón social"})]})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max font-font-general",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6 customtext-neutral-dark",children:"Resumen de compra"}),e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:m.map((t,n)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white p-0 rounded-xl",children:e.jsx("img",{src:`/storage/images/item/${t.image}`,alt:t.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold customtext-neutral-dark text-base 2xl:text-lg mb-2",children:t.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Color:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:t.color})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad:"," ",e.jsxs("span",{className:"customtext-neutral-dark",children:[t.quantity," "]})]})]})]})},t.id))}),!p&&e.jsxs("div",{className:"mt-6 flex",children:[e.jsx("input",{ref:M,type:"text",placeholder:"Código de cupón",className:"w-full rounded-l-md border border-gray-300 p-2 px-4 text-sm outline-none uppercase focus:border-[#C5B8D4]",value:p==null?void 0:p.name,onKeyDown:Le,disabled:Q}),e.jsx("button",{className:"rounded-r-md bg-[#5339B1] px-4 py-2 text-sm text-white",type:"button",onClick:me,disabled:Q,children:"Aplicar"})]}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(d)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(b)]})]}),p&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado"," ",e.jsx(ve,{content:"Eliminar",children:e.jsx("i",{className:"mdi mdi-close text-red-500 cursor-pointer",onClick:()=>{B(null),M.current.value=""}})}),e.jsxs("small",{className:"block text-xs font-light",children:[p.name," ",e.jsx(ve,{content:p.description,children:e.jsx("i",{className:"mdi mdi-information-outline ms-1"})})," ","(",p.type==="percentage"?`-${Math.round(p.amount*100)/100}%`:`S/ -${N(p.amount)}`,")"]})]}),e.jsxs("span",{children:["S/ -",N(S)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsx("span",{className:"font-semibold",children:V!=null&&re>=V?e.jsxs("span",{className:"customtext-neutral-dark",children:["Gratis (Compra mayor a S/",V,")"]}):`S/ ${N(C)}`})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",N(v)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsxs(te,{className:"payment-button",onClick:qe,children:[" ","Continuar"]}),e.jsx("div",{id:"mercadopago-button-container"}),e.jsxs(Ce,{onClick:u,children:[" ","Cancelar"]})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los",e.jsx("a",{className:"customtext-primary font-bold",children:"Términos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra",e.jsx("a",{className:"customtext-primary font-bold",children:"Política de Privacidad"}),"."]})})]})]})]}),e.jsx(Ze,{isOpen:_e,contacts:j,onClose:()=>D(!1),onPaymentComplete:Oe}),e.jsx(Ke,{isOpen:Te,cart:m,subTotal:d,igv:b,totalFinal:v,envio:C,request:ce,onClose:()=>oe(!1),paymentMethod:le,coupon:p,descuentofinal:S}),e.jsx(Qe,{isOpen:$e,cart:m,subTotal:d,igv:b,totalFinal:v,envio:C,contacts:j,request:ce,onClose:()=>ie(!1),paymentMethod:le,coupon:p,descuentofinal:S})]})}const ss=({code:m})=>new Promise(async(l,g)=>{try{console.log("Codigo de venta:",m);const{status:h,result:r}=await F.Fetch("./api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:m})});if(!h||!r.order){F.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:(r==null?void 0:r.message)||"Error no se pudo cargar la orden",type:"danger"}),g((r==null?void 0:r.message)||"Error no se pudo cargar la orde");return}l(r)}catch(h){console.error("Error en processMercadoPagoPayment:",h),F.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:h.message||"Error en la integración con MercadoPago",type:"danger"}),g(h.message||"Error en la integración con MercadoPago")}});function ts({setCart:m,cart:l,code:g,delivery:h}){var _;const[r,f]=c.useState(null),[u,d]=c.useState(!0),[b,v]=c.useState(null);if(c.useEffect(()=>{g&&((async()=>{try{const y=await ss({code:g});f(y.order)}catch(y){v(y.message)}finally{d(!1)}})(),F.Local.delete(`${se.APP_CORRELATIVE}_cart`),F.Local.set(`${se.APP_CORRELATIVE}_cart`,[]))},[g]),u)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center",children:e.jsx("p",{children:"Cargando detalles de la orden..."})})});if(b)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center text-red-500",children:e.jsxs("p",{children:["Error al cargar la orden: ",b]})})});if(!r)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center",children:e.jsx("p",{children:"No se encontraron datos de la orden"})})});const w=((((_=r==null?void 0:r.items)==null?void 0:_.reduce((j,y)=>{const S=y.price||0,q=y.quantity||0;return j+S*q},0))||0)/1.18).toFixed(2),C=(w*.18).toFixed(2),L=parseFloat(w)+parseFloat(C)+parseFloat(r.delivery)-parseFloat(r.coupon_discount||0);return console.log(r.delivery,"order.coupon_discount"),e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-base xl:text-xl customtext-neutral-light",children:"Gracias por tu compra 🎉"}),e.jsx("p",{className:"customtext-neutral-dark text-2xl xl:text-5xl font-semibold",children:"Tu orden ha sido recibida"}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:" customtext-neutral-light",children:"Código de pedido"}),e.jsxs("div",{className:"customtext-neutral-dark text-lg font-semibold",children:["#",r.code]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg bg-[#F7F9FB] mx-auto p-8 rounded-xl",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:r.items.map((j,y)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl w-max",children:e.jsx("img",{src:j.image?`/storage/images/item/${j.image}`:"/assets/img/noimage/no_img.jpg",alt:j.name,className:"w-20 h-20 object-cover rounded",onError:S=>S.target.src="/assets/img/noimage/no_img.jpg"})}),e.jsxs("div",{className:"text-start",children:[e.jsx("h3",{className:"font-medium text-lg",children:j.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Color: ",e.jsx("span",{className:"customtext-neutral-dark",children:j.color})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsx("span",{className:"customtext-neutral-dark",children:parseInt(j.quantity)})," - Precio: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[" S/ ",N(j.price)]})]})]})]})},y))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(w)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(C)]})]}),r.coupon_id&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado"," "]}),e.jsxs("span",{children:["S/ -",N(r.coupon_discount)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",N(r.delivery)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",N(L)]})]})})]}),e.jsx("div",{className:"pt-3",children:e.jsx(te,{href:"/catalogo",children:"  Seguir Comprando"})})]})]})})})}function st({cart:m,setCart:l,user:g,prefixes:h,ubigeos:r,items:f,contacts:u}){const[d,b]=c.useState(1),[v,a]=c.useState(null),w=m.reduce((R,E)=>{const J=E.final_price;return R+J*E.quantity},0),[C,L]=c.useState(0),_=w/1.18,j=(_*.18).toFixed(2),y=(parseFloat(_)+parseFloat(j)+parseFloat(C)-v).toFixed(2),[S,q]=c.useState([]),[M,p]=c.useState([]),[B,A]=c.useState([]);return c.useEffect(()=>{const E=new URLSearchParams(window.location.search).get("code");E&&(p(E),b(3))},[window.location.search]),c.useEffect(()=>{M&&F.Local.delete(`${se.APP_CORRELATIVE}_cart`)},[M]),c.useEffect(()=>{(()=>{const E=document.createElement("script");E.src="https://sdk.mercadopago.com/js/v2",E.async=!0,document.body.appendChild(E)})()},[]),e.jsx("div",{className:"min-h-screen bg-white pt-6 px-primary lg:-mb-10",children:e.jsxs("div",{className:"bg-white pt-8 sm:p-8 rounded-xl",children:[e.jsxs("div",{className:`mb-4 xl:mb-8 grid lg:grid-cols-5 !font-font-general ${d===3?"mx-auto max-w-3xl":""} `,children:[e.jsxs("div",{className:`flex items-center justify-between  mx-1 gap-2 lg:mx-5 ${d===3?"lg:col-span-5":"lg:col-span-3"}  text-center`,children:[e.jsx("div",{className:`text-sm sm:text-base 2xl:text-lg tracking-tight ${d===1?"customtext-primary font-semibold":"customtext-neutral-dark"}`,children:"Carrito de compra"}),e.jsx("div",{className:`text-sm sm:text-base 2xl:text-lg tracking-tight ${d===2?"customtext-primary font-semibold":"customtext-neutral-dark"}`,children:"Detalles de envío"}),e.jsx("div",{className:`text-sm sm:text-base 2xl:text-lg tracking-tight ${d===3?"customtext-primary font-semibold":"customtext-neutral-dark"}`,children:"Orden confirmada"})]}),e.jsx("div",{className:`mt-4 h-1 max-w-3xl bg-gray-200 ${d===3?"lg:col-span-5":"lg:col-span-3"} `,children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-500",style:{width:`${(d-1)/2*100}%`}})})]}),d===1&&e.jsx(We,{cart:m,setCart:l,onContinue:()=>b(2),subTotal:_,totalPrice:w,envio:C,igv:j,totalFinal:y}),d===2&&e.jsx(es,{setCode:p,setDelivery:A,cart:m,setSale:q,setCart:l,onContinue:()=>b(3),noContinue:()=>b(1),subTotal:_,totalPrice:w,envio:C,setEnvio:L,igv:j,totalFinal:y,user:g,prefixes:h,contacts:u,ubigeos:r,items:f,descuentofinal:v,setDescuentoFinal:a}),d===3&&e.jsx(ts,{code:M,setCart:l,delivery:B,cart:S,subTotal:_,totalPrice:w,envio:C,igv:j,totalFinal:y,descuentofinal:v,setDescuentoFinal:a})]})})}export{st as default};

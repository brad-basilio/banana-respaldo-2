import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{B as G}from"./Base-Dl9oddLU.js";import{r as a}from"./index-BH53Isel.js";import{T as V}from"./TextareaFormGroup-DVzYJtLM.js";import{c as z}from"./ReactAppend-DTVVXReZ.js";import{S as n}from"./ProductCard-CRhBSmWZ.js";import{C as O}from"./CanvasPresetsRest-CiIj_si8.js";import{M as L}from"./Modal-DYPPCNUR.js";import{T as M}from"./Table-DitbKwtZ.js";import{I as T}from"./InputFormGroup-D5I6zpZc.js";import{S as W}from"./SelectFormGroup-BmhC2uob.js";import{C as H}from"./CreateReactScript-NWc2tE6o.js";import"./index-yBjzXJbu.js";import"./Global-ErywZRdd.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";/* empty css              */import"./Logout-TGKOqZqZ.js";import"./main-6DCdASTx.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./MenuItemContainer-CY0sLPNq.js";import"./index.esm-POOiSFi2.js";import"./index-Dq7h7Pqt.js";import"./BasicRest-C4m6wu80.js";import"./index-BZYhE2TF.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";const y=({col:l,label:i,eRef:w,placeholder:d,required:u=!1,disabled:R=!1,readOnly:m=!1,value:g,min:E,max:c,step:N,onChange:o=()=>{},className:f=""})=>e.jsxs("div",{className:`form-group ${l} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1 form-label",children:[i," ",u&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("input",{ref:w,type:"number",className:`form-control ${f}`,placeholder:d,required:u,disabled:R,readOnly:m,defaultValue:g,min:E,max:c,step:N||"any",onChange:o})]}),b=new O,J=()=>{const[l,i]=a.useState([]),[w,d]=a.useState(!0),[u,R]=a.useState([]),[m,g]=a.useState(!1),E=a.useRef(),c=a.useRef(),N=a.useRef(),o=a.useRef(),f=a.useRef(),F=a.useRef(),C=a.useRef(),P=a.useRef(),p=a.useRef(),h=a.useRef(),x=a.useRef(),v=a.useRef(),j=a.useRef();a.useEffect(()=>{k(),_()},[]);const k=async()=>{try{d(!0);const r=await b.paginate();i(r.data),d(!1)}catch(r){console.error("Error al cargar los presets:",r),d(!1),n.fire("Error","No se pudieron cargar los presets","error")}},_=async()=>{try{const r=await b.getTypes();if(r.success){const t=Object.entries(r.data).map(([s,S])=>({id:s,name:S}));R(t)}}catch(r){console.error("Error al cargar los tipos de preset:",r)}},D=()=>{var r;g(!1),(r=N.current)==null||r.reset(),p.current&&(p.current.value=300),h.current&&(h.current.value=1),x.current&&(x.current.value="#FFFFFF"),v.current&&(v.current.checked=!0),j.current&&$(j.current).val("other").trigger("change"),$(c.current).modal("show")},A=r=>{g(!0),o.current.value=r.id,f.current.value=r.name,F.current.value=r.description||"",C.current.value=r.width,P.current.value=r.height,p.current.value=r.dpi||300,h.current.value=r.pages||1,x.current.value=r.background_color||"#FFFFFF",v.current.checked=r.is_active!==!1,$(j.current).val(r.type||"other").trigger("change"),$(c.current).modal("show")},I=async r=>{r.preventDefault();const t={name:f.current.value,description:F.current.value,width:parseFloat(C.current.value),height:parseFloat(P.current.value),dpi:parseInt(p.current.value,10),pages:parseInt(h.current.value,10),background_color:x.current.value,is_active:v.current.checked,type:j.current.value};try{let s;if(m&&o.current.value?s=await b.update(o.current.value,t):s=await b.create(t),s.success)n.fire("¡Éxito!",s.message||"Operación realizada correctamente","success"),k(),$(c.current).modal("hide");else throw new Error(s.message||"Error al guardar el preset")}catch(s){console.error("Error al guardar el preset:",s),n.fire("Error",s.message||"Ocurrió un error al guardar el preset","error")}},B=r=>{n.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(async t=>{if(t.isConfirmed)try{const s=await b.delete(r);if(s.success)n.fire("¡Eliminado!",s.message||"El preset ha sido eliminado.","success"),k();else throw new Error(s.message||"Error al eliminar el preset")}catch(s){console.error("Error al eliminar el preset:",s),n.fire("Error",s.message||"No se pudo eliminar el preset.","error")}})},q=[{field:"id",title:"ID",width:70},{field:"name",title:"Nombre",minWidth:200},{field:"dimensions",title:"Dimensiones",render:(r,t)=>`${t.width} x ${t.height} cm`,width:150},{field:"type",title:"Tipo",render:(r,t)=>{const s=u.find(S=>S.id===t.type);return s?s.name:t.type},width:120},{field:"pages",title:"Páginas",width:100,align:"center"},{field:"dpi",title:"DPI",width:80,align:"center"},{field:"is_active",title:"Activo",render:(r,t)=>e.jsx("span",{className:`badge ${t.is_active?"bg-success":"bg-secondary"}`,children:t.is_active?"Sí":"No"}),width:80,align:"center"},{field:"actions",title:"Acciones",render:(r,t)=>e.jsxs("div",{className:"btn-group",children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>A(t),children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>B(t.id),children:e.jsx("i",{className:"fas fa-trash"})})]}),width:120,align:"center",sortable:!1}];return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[e.jsx("h3",{className:"card-title",children:"Presets de Canvas"}),e.jsxs("button",{className:"btn btn-primary",onClick:D,children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Nuevo Preset"]})]}),e.jsx("div",{className:"card-body",children:e.jsx(M,{ref:E,columns:q,data:l,loading:w,searchable:!0,pagination:!0,pageSize:10,emptyText:"No hay presets disponibles"})})]})})}),e.jsx(L,{ref:c,title:m?"Editar Preset":"Nuevo Preset",size:"lg",onClose:()=>$(c.current).modal("hide"),children:e.jsxs("form",{ref:N,onSubmit:I,children:[e.jsx("input",{type:"hidden",ref:o}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(T,{ref:f,label:"Nombre del Preset",placeholder:"Ej: Photobook Estándar 20x30cm",required:!0})}),e.jsx("div",{className:"col-md-6",children:e.jsx(W,{ref:j,label:"Tipo de Producto",options:u,optionValue:"id",optionLabel:"name",required:!0})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-12",children:e.jsx(V,{ref:F,label:"Descripción",placeholder:"Descripción del preset (opcional)",rows:"2"})})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-3",children:e.jsx(y,{ref:C,label:"Ancho (cm)",min:"0.1",step:"0.1",required:!0})}),e.jsx("div",{className:"col-md-3",children:e.jsx(y,{ref:P,label:"Alto (cm)",min:"0.1",step:"0.1",required:!0})}),e.jsx("div",{className:"col-md-3",children:e.jsx(y,{ref:p,label:"DPI",min:"72",max:"1200",defaultValue:"300",required:!0})}),e.jsx("div",{className:"col-md-3",children:e.jsx(y,{ref:h,label:"N° de Páginas",min:"1",defaultValue:"1",required:!0})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(T,{type:"color",ref:x,label:"Color de Fondo",defaultValue:"#FFFFFF"})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Estado"}),e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",ref:v,defaultChecked:!0}),e.jsx("label",{className:"form-check-label",children:"Activo"})]})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>$(c.current).modal("hide"),children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[m?"Actualizar":"Crear"," Preset"]})]})]})})]})};H((l,i)=>{z.createRoot(l).render(e.jsx(G,{...i,title:"Gestión de Presets de Canvas",children:e.jsx(J,{...i})}))});

import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{R as v,r as a}from"./index-BH53Isel.js";import"./thumbnailGenerator-9y6dq3Go.js";import{B as S}from"./book-BuHIVa2d.js";import"./index-yBjzXJbu.js";import"./thumbnailGenerator-B4goYG9Y.js";import"./createLucideIcon-Cy5Ya80P.js";const j=v.memo(({pageId:t,thumbnail:r,altText:p,type:n="content",className:f="",onLoad:o,onError:l,showPlaceholder:h=!0,placeholderIcon:x})=>{const[s,i]=a.useState(!1),[c,b]=a.useState(!1),[y,N]=a.useState(!1),g=a.useRef(null),u=a.useRef(null);a.useEffect(()=>{if(g.current)return u.current=new IntersectionObserver(([d])=>{var m;d.isIntersecting&&(N(!0),(m=u.current)==null||m.disconnect())},{rootMargin:"50px"}),u.current.observe(g.current),()=>{var d;(d=u.current)==null||d.disconnect()}},[]);const w=()=>{i(!0),b(!1),o==null||o()},I=()=>{b(!0),i(!1),l==null||l()},C=r&&y&&!c,P=!r||c||!s,R=x||(()=>n==="cover"||n==="final"?e.jsx(S,{className:"w-8 h-8"}):e.jsx("div",{className:"grid grid-cols-2 gap-0.5 w-8 h-8",children:Array.from({length:4}).map((d,m)=>e.jsx("div",{className:"bg-gray-300 rounded-sm"},m))})),$={cover:"text-purple-300 bg-purple-50",content:"text-blue-300 bg-blue-50",final:"text-green-300 bg-green-50"}[n]||"text-gray-300 bg-gray-50";return e.jsxs("div",{ref:g,className:`relative w-full h-full overflow-hidden ${f}`,children:[C&&e.jsx("img",{src:r,alt:p,className:`absolute inset-0 w-full h-full object-contain transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,onLoad:w,onError:I,loading:"lazy",decoding:"async",style:{imageRendering:"optimizeQuality"}}),P&&h&&e.jsx("div",{className:`absolute inset-0 flex items-center justify-center ${$} transition-opacity duration-300 ${s&&!c?"opacity-0":"opacity-100"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(R,{}),!r&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-xs opacity-75",children:"Generando..."}),e.jsx("div",{className:"w-8 h-1 bg-current opacity-30 rounded-full mx-auto mt-1",children:e.jsx("div",{className:"h-full bg-current rounded-full animate-pulse"})})]}),c&&e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"Error"})]})}),r&&y&&!s&&!c&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"})})]})});j.displayName="OptimizedThumbnail";const k=v.memo(({page:t,pageIndex:r,currentPage:p,thumbnail:n,isGenerating:f,error:o,onSelect:l,onContentChange:h})=>{const x=p===r,s=()=>{l(r)},i=()=>{switch(t.type){case"cover":return"Portada";case"final":return"Contraportada";case"content":return`Página ${t.pageNumber}`;default:return`Página ${r+1}`}};return e.jsx("div",{className:`relative group flex flex-col cursor-pointer transition-all duration-200 transform mb-2 ${x?"ring-2 ring-purple-400 scale-[1.02] shadow-md":"hover:bg-gray-50 border border-transparent hover:border-gray-200"}`,onClick:s,children:e.jsxs("div",{className:"relative overflow-hidden border aspect-[4/3] bg-white",children:[e.jsx(j,{pageId:t.id,thumbnail:n,altText:i(),type:t.type,className:"w-full h-full"}),f&&e.jsx("div",{className:"absolute top-1 right-1 bg-blue-500 text-white text-[9px] px-1.5 py-0.5 rounded-full",children:"Generando..."}),o&&e.jsx("div",{className:"absolute top-1 right-1 bg-red-500 text-white text-[9px] px-1.5 py-0.5 rounded-full",children:"Error"}),t.type==="content"&&e.jsx("div",{className:"absolute top-1 left-1 bg-white/90 rounded-full h-5 w-5 flex items-center justify-center text-[10px] font-bold shadow-sm",children:t.pageNumber}),(t.type==="cover"||t.type==="final")&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2 pt-6 group-hover:opacity-100 opacity-80 transition-opacity",children:e.jsx("span",{className:"text-[10px] text-white font-medium block",children:i()})})]})})});k.displayName="PageThumbnailItem";
